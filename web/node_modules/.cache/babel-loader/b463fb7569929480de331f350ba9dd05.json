{"ast":null,"code":"var _jsxFileName = \"/home/appinventiv/Documents/Project/tickt/web/src/pages/builderJobDasboard/components/editMilestones/addEditMile.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport moment from \"moment\";\nimport Button from \"@material-ui/core/Button\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport Modal from \"@material-ui/core/Modal\";\nimport { renderTimeWithCustomFormat } from \"../../../../utils/common\";\nimport { setShowToast } from \"../../../../redux/common/actions\"; // @ts-ignore\n\nimport { DateRangePicker } from \"../../../../plugins/react-date-range/dist/index\";\nimport \"../../../../plugins/react-date-range/dist/styles.css\";\nimport \"../../../../plugins/react-date-range/dist/theme/default.css\"; // for error messages\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst label = {\n  name: \"Milestone Name\",\n  duration: \"From Date\",\n  recommended: \"Recommended Hours\"\n};\nconst pattern = \"^([0-9][0-9]?[0-9]?[0-9]?[0-9]):[0-5][0-9]$\";\nconst STRING_ERROR = \"Selected data is fully engage\";\n\nconst AddEditMile = props => {\n  _s();\n\n  var _errors$recommended, _props$milestones2, _props$milestones3;\n\n  const {\n    resetItems,\n    item\n  } = props;\n  const [stateData, setStateData] = useState({\n    name: \"\",\n    isPhoto: false,\n    duration: \"\",\n    recommended: \"\",\n    status: -1,\n    order: -1\n  });\n  const [errors, setErrors] = useState({\n    name: \"\",\n    duration: \"\",\n    hours: \"\",\n    pattern_error: \"\"\n  });\n  const [toggleCalender, setToggleCalender] = useState(false);\n  const [changesFor, setChangesFor] = useState({\n    name: false,\n    isPhoto: false,\n    duration: false,\n    recommended: false\n  });\n  const [toggleItem, setToggleItem] = useState(false);\n  const [calenderItems, setCalender] = useState({\n    startDate: \"\",\n    //new Date(),\n    endDate: \"\",\n    //new Date(),\n    key: \"selection\"\n  });\n\n  const toggleCal = () => {\n    setToggleCalender(prev => !prev);\n  };\n\n  const checkHoursVal = (value, lable, name) => {\n    if (value === null || value === void 0 ? void 0 : value.length) {\n      if (value.match(pattern) !== null) {\n        if (!(+value.split(\":\")[1] % 15 === 0)) {\n          return \"Time should be in mutiples of 15 like 10:15, 10:30\";\n        }\n\n        return \"\";\n      } else {\n        return \"Please enter a valid pattern like : 10:15\";\n      }\n    }\n\n    return \"\";\n  };\n\n  const isInvalid = (name, value) => {\n    switch (name) {\n      case \"name\":\n        return !value.length ? `${label[name]} is required.` : value.length > 50 ? \"Maximum 50 characters are allowed.\" : \"\";\n\n      case \"duration\":\n        return \"\";\n\n      case \"recommended\":\n        return checkHoursVal(value, label, name);\n    }\n  };\n\n  const handleChange = (name, value) => {\n    let error_clone = {};\n\n    if (name === \"name\") {\n      value = value.trimLeft().replace(/[^a-zA-Z|0-9 ]/g, \"\");\n    }\n\n    if (name === \"recommended\") {\n      value = value.trimLeft();\n    }\n\n    if ([\"name\", \"recommended\"].includes(name)) {\n      if (isInvalid(name, value)) {\n        error_clone[name] = isInvalid(name, value);\n      }\n    }\n\n    setStateData(prev => ({ ...prev,\n      [name]: value\n    }));\n    setErrors(error_clone);\n  };\n\n  const onMountCallable = () => {\n    let count_times = {};\n    let milestones = props.milestones;\n    let filteredItems = milestones.filter(item => {\n      let toDate = item === null || item === void 0 ? void 0 : item.toDate;\n      let fromDate = item === null || item === void 0 ? void 0 : item.fromDate;\n\n      if (fromDate) {\n        let from_format = moment(fromDate).format(\"MM-DD-YYYY\");\n        item[\"from_date\"] = from_format;\n        count_times[from_format] = 0;\n      }\n\n      if (toDate) {\n        let to_format = moment(toDate).format(\"MM-DD-YYYY\");\n        item[\"to_date\"] = to_format;\n        count_times[to_format] = 0;\n      }\n\n      if (Object.keys(item).length) {\n        return item;\n      }\n    });\n    console.log({\n      filteredItems,\n      count_times\n    });\n\n    if (filteredItems === null || filteredItems === void 0 ? void 0 : filteredItems.length) {\n      filteredItems.forEach((item, index) => {\n        let to_date = item === null || item === void 0 ? void 0 : item.to_date;\n        let from_date = item === null || item === void 0 ? void 0 : item.from_date;\n        let color_index = index;\n\n        if (index > 500) {\n          color_index = Math.floor(Math.random() * 500 + 1);\n        }\n\n        if (!to_date && from_date) {\n          if (count_times[from_date] > -1) {\n            count_times[from_date]++;\n          }\n\n          let from_element = document.getElementsByClassName(`color_${count_times[from_date]}_${from_date}`);\n\n          if (from_element) {\n            let element_from = from_element[0];\n\n            if ((from_element === null || from_element === void 0 ? void 0 : from_element.length) > 1) {\n              element_from = from_element[1];\n            }\n\n            if (element_from) {\n              element_from.classList.add(`color_${color_index}`);\n            }\n          }\n        }\n\n        if (to_date && from_date) {\n          if (count_times[from_date] > -1) {\n            count_times[from_date]++;\n          }\n\n          if (count_times[to_date] > -1) {\n            count_times[to_date]++;\n          } // let colorbyIndex = randomColors[index];\n\n\n          let from_element = document.getElementsByClassName(`color_${count_times[from_date]}_${from_date}`);\n\n          if (from_element) {\n            let element_from = null;\n\n            if ((from_element === null || from_element === void 0 ? void 0 : from_element.length) > 1) {\n              if (!from_element[0].parentElement.parentElement.classList.contains(\"rdrDayPassive\")) {\n                element_from = from_element[0];\n              } else {\n                element_from = from_element[1];\n              }\n            } else {\n              element_from = from_element[0];\n            }\n\n            if (element_from) {\n              element_from.classList.add(`color_${color_index}`);\n            }\n          }\n\n          let to_element = document.getElementsByClassName(`color_${count_times[to_date]}_${to_date}`);\n\n          if (to_element) {\n            let element_to = null;\n\n            if ((to_element === null || to_element === void 0 ? void 0 : to_element.length) > 1) {\n              if (!to_element[0].parentElement.parentElement.classList.contains(\"rdrDayPassive\")) {\n                element_to = to_element[0];\n              } else {\n                element_to = to_element[1];\n              }\n            } else {\n              element_to = to_element[0];\n            }\n\n            if (element_to) {\n              element_to.classList.add(`color_${color_index}`);\n            }\n          }\n        }\n      });\n    }\n  };\n\n  useEffect(() => {\n    const {\n      milestones,\n      editMile\n    } = props;\n\n    if (editMile > -1) {\n      let editItem = milestones[editMile];\n\n      if (editItem) {\n        setStateData(prev => ({\n          order: (editItem === null || editItem === void 0 ? void 0 : editItem.order) ? editItem === null || editItem === void 0 ? void 0 : editItem.order : -1,\n          name: editItem.milestoneName,\n          isPhoto: editItem.isPhotoevidence,\n          duration: renderTimeWithCustomFormat(editItem.fromDate, editItem.toDate, \"\", [\"DD MMM\", \"DD MMM YY\"]),\n          recommended: editItem === null || editItem === void 0 ? void 0 : editItem.recommendedHours,\n          status: editItem === null || editItem === void 0 ? void 0 : editItem.status\n        }));\n        setCalender({\n          startDate: moment(editItem === null || editItem === void 0 ? void 0 : editItem.fromDate).isValid() ? moment(editItem === null || editItem === void 0 ? void 0 : editItem.fromDate).toDate() : \"\",\n          endDate: moment(editItem === null || editItem === void 0 ? void 0 : editItem.toDate).isValid() ? moment(editItem === null || editItem === void 0 ? void 0 : editItem.toDate).toDate() : \"\",\n          key: \"selection\"\n        });\n      }\n    }\n\n    const interval = setInterval(() => {\n      onMountCallable();\n    }, 2000);\n    return () => {\n      console.log(`clearing interval`);\n      clearInterval(interval);\n    };\n  }, []);\n\n  const checkIfChange = () => {\n    var _stateData$name, _stateData$recommende;\n\n    let renderDuration = renderTimeWithCustomFormat(calenderItems.startDate, calenderItems.endDate, \"\", [\"DD MMM\", \"DD MMM YY\"], \"Choose\");\n\n    if (!(stateData === null || stateData === void 0 ? void 0 : (_stateData$name = stateData.name) === null || _stateData$name === void 0 ? void 0 : _stateData$name.length) && !(stateData === null || stateData === void 0 ? void 0 : stateData.isPhoto) && renderDuration === \"Choose\" && !(stateData === null || stateData === void 0 ? void 0 : (_stateData$recommende = stateData.recommended) === null || _stateData$recommende === void 0 ? void 0 : _stateData$recommende.length)) {\n      return false;\n    }\n\n    return true;\n  };\n\n  const checkBeforeExist = (time, milestones_) => {\n    let count_times = {};\n    let catch_boolean = true;\n    let milestoneItems = props === null || props === void 0 ? void 0 : props.milestones;\n    milestoneItems.forEach(mile => {\n      let mile_start = mile.from_date;\n      let mile_end = mile.to_date;\n      let time_start = moment(time.fromDate).isValid() ? moment(time.fromDate).format(\"MM-DD-YYYY\") : \"\";\n      let time_end = moment(time.toDate).isValid() ? moment(time.toDate).format(\"MM-DD-YYYY\") : \"\";\n\n      if (count_times[mile_start] == undefined) {\n        count_times[mile_start] = 1;\n      } else {\n        count_times[mile_start] = count_times[mile_start] + 1;\n      }\n\n      if (count_times[mile_end] == undefined) {\n        count_times[mile_end] = 1;\n      } else {\n        count_times[mile_end] = count_times[mile_end] + 1;\n      }\n\n      if (count_times[mile_start] === 4) {\n        if (mile_start == time_start || mile_start == time_end) {\n          setShowToast(true, STRING_ERROR);\n          catch_boolean = false;\n        }\n      } else {\n        if (count_times[time_start] === 4) {\n          setShowToast(true, STRING_ERROR);\n          catch_boolean = false;\n        }\n      }\n\n      if (count_times[mile_end] === 4) {\n        if (mile_end == time_start || mile_end == time_end) {\n          setShowToast(true, STRING_ERROR);\n          catch_boolean = false;\n        }\n      } else {\n        if (count_times[time_end] === 4) {\n          setShowToast(true, STRING_ERROR);\n          catch_boolean = false;\n        }\n      }\n    });\n    return catch_boolean;\n  };\n\n  const handleCalender = date => {\n    var _props$milestones;\n\n    let time = {\n      fromDate: date.selection.startDate,\n      toDate: date.selection.endDate\n    };\n    console.log({\n      selection: date.selection\n    });\n    let index = props === null || props === void 0 ? void 0 : (_props$milestones = props.milestones) === null || _props$milestones === void 0 ? void 0 : _props$milestones.length;\n    let isChecked = checkBeforeExist(time);\n\n    if (isChecked) {\n      addTimeToMileStone(time, index);\n    } // setCalender(date.selection);\n\n  };\n\n  const addTimeToMileStone = (time, index, skip) => {\n    let milestone_clone = props === null || props === void 0 ? void 0 : props.milestones;\n    let checkIsValid = true;\n    console.log({\n      checkIsValid\n    });\n\n    if (!checkIsValid) {\n      setShowToast(true, \"Please add unique date\");\n      return;\n    }\n\n    setCalender({\n      startDate: moment(time.fromDate).toDate(),\n      endDate: moment(time.toDate).toDate(),\n      key: \"selection\"\n    });\n  }; // before render check\n\n\n  const {\n    name,\n    isPhoto,\n    recommended\n  } = stateData;\n  let check_errors = false;\n  let renderDuration = renderTimeWithCustomFormat(calenderItems.startDate, calenderItems.endDate, \"\", [\"DD MMM\", \"DD MMM YYYY\", true], \"Choose\");\n\n  if (!(name === null || name === void 0 ? void 0 : name.length) || (recommended === null || recommended === void 0 ? void 0 : recommended.length) > 0 && ((_errors$recommended = errors.recommended) === null || _errors$recommended === void 0 ? void 0 : _errors$recommended.length)) {\n    check_errors = true;\n  }\n\n  let ItemCal = calenderItems;\n\n  if (!moment(calenderItems === null || calenderItems === void 0 ? void 0 : calenderItems.startDate).isValid()) {\n    ItemCal = {\n      startDate: new Date(),\n      endDate: \"\",\n      key: \"selection\"\n    };\n  }\n\n  let min_date = moment(item === null || item === void 0 ? void 0 : item.fromDate).isValid() ? moment(item === null || item === void 0 ? void 0 : item.fromDate).toDate() : new Date(); // let max_date: any = moment(item?.toDate).isValid() && !moment(item?.fromDate).isSame(item?.toDate) ? moment(item?.toDate).toDate() : moment().add(2, 'years').toDate();\n\n  let max_date = moment().add(2, \"years\").toDate();\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex_row\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex_col_sm_12\",\n      children: [/*#__PURE__*/_jsxDEV(Dialog, {\n        open: toggleItem // onClose={handleClose}\n        ,\n        \"aria-labelledby\": \"alert-dialog-title\",\n        \"aria-describedby\": \"alert-dialog-description\",\n        children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n          id: \"alert-dialog-title\",\n          className: \"xs_alert_dialog_title\",\n          children: \"Heads Up\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 420,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n          children: /*#__PURE__*/_jsxDEV(DialogContentText, {\n            children: \"If you go back, you will lose all your changes.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 427,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 426,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            onClick: () => {\n              setToggleItem(prev => !prev);\n            },\n            color: \"primary\",\n            children: \"Yes\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 432,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            onClick: () => {\n              setToggleItem(prev => !prev);\n              resetItems();\n            },\n            color: \"primary\",\n            autoFocus: true,\n            children: \"No\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 440,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 431,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 414,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Modal, {\n        className: \"custom_modal \",\n        open: toggleCalender,\n        onClose: () => {\n          toggleCal();\n        },\n        \"aria-labelledby\": \"calender-active-modal-title\",\n        \"aria-describedby\": \"calender-active-modal-title\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: \"12px 20px 0px\"\n          },\n          className: \"item-modal-ctm custom_wh portfolio_preview \",\n          children: [console.log({\n            jobDetail: props.jobDetail\n          }), /*#__PURE__*/_jsxDEV(DateRangePicker, {\n            ranges: [ItemCal],\n            onChange: date => {\n              handleCalender(date);\n              setChangesFor(prev => ({ ...prev,\n                duration: true\n              }));\n            },\n            months: 2,\n            direction: \"horizontal\",\n            moveRangeOnFirstSelection: false,\n            rangeColors: [\"#fee600\", \"#b5b5b5\"],\n            showDateDisplay: false,\n            showSelectionPreview: true,\n            showPreview: true,\n            minDate: min_date,\n            maxDate: max_date,\n            fixedHeight: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 469,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 462,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 453,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form_field\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex_row\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex_col_sm_7\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"relate\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  if (checkIfChange()) {\n                    setToggleItem(prev => !prev);\n                    return;\n                  }\n\n                  resetItems();\n                },\n                className: \"back\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 493,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"title\",\n                children: (item === null || item === void 0 ? void 0 : item.jobName) || \"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 503,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 492,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"sub_title\",\n              children: [`${props.editMile === \"\" ? \"\" : \"Edit \"}`, `${props.editMile === \"\" && (props === null || props === void 0 ? void 0 : props.isSame) ? `Milestones ${(props === null || props === void 0 ? void 0 : (_props$milestones2 = props.milestones) === null || _props$milestones2 === void 0 ? void 0 : _props$milestones2.length) + 1}` : props.editMile !== \"\" && props.editMile > -1 && (props === null || props === void 0 ? void 0 : props.isSame) ? `Milestones ${props.editMile + 1}` : props.editMile !== \"\" && props.editMile > -1 && !(props === null || props === void 0 ? void 0 : props.isSame) ? `Milestone ${props.editMile + 1}` : props.editMile === \"\" && !(props === null || props === void 0 ? void 0 : props.isSame) ? `Milestone ${(props === null || props === void 0 ? void 0 : (_props$milestones3 = props.milestones) === null || _props$milestones3 === void 0 ? void 0 : _props$milestones3.length) + 1}` : null}`]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 505,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 491,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 490,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 489,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex_row\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex_col_sm_7\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form_field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form_label\",\n              children: \"Milestone Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 532,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text_field\",\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                placeholder: \"Enter Milestone Name\",\n                onChange: e => {\n                  handleChange(\"name\", e.target.value);\n                  setChangesFor(prev => ({ ...prev,\n                    name: true\n                  }));\n                },\n                value: name,\n                name: \"milestone_name\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 534,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 533,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"error_msg\",\n              children: errors === null || errors === void 0 ? void 0 : errors.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 545,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 531,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form_field\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"checkbox_wrap agree_check\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                onChange: () => {\n                  setStateData(prev => ({ ...prev,\n                    isPhoto: !prev.isPhoto\n                  }));\n                  setChangesFor(prev => ({ ...prev,\n                    isPhoto: true\n                  }));\n                },\n                checked: isPhoto,\n                className: \"filter-type filled-in\",\n                type: \"checkbox\",\n                id: \"milestone1\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 549,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                htmlFor: \"milestone1\",\n                children: /*#__PURE__*/_jsxDEV(\"b\", {\n                  children: \"Photo evidence required\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 563,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 562,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 548,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 547,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form_field\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"f_spacebw\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"form_label\",\n                children: \"Duration of milestone (optional)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 569,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  toggleCal();\n                },\n                className: \"fill_btn fill_grey_btn choose_btn\",\n                children: renderDuration\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 572,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 568,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 567,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form_field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form_label\",\n              children: \"Estimated Hours (optional)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 583,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text_field\",\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                onChange: e => {\n                  handleChange(\"recommended\", e.target.value);\n                  setChangesFor(prev => ({ ...prev,\n                    recommended: true\n                  }));\n                },\n                autoComplete: \"off\",\n                value: recommended,\n                type: \"text\",\n                placeholder: \"Enter Estimated Hours\",\n                name: \"recommended_hours\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 587,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 586,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"error_msg\",\n              children: errors.recommended\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 602,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 582,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form_field\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                let description = \"\";\n\n                if (Object.values(changesFor).includes(true)) {\n                  // description = `This job has Milestones change request with changes in ${changesFor?.name ? 'Milestone Name, ' : ''}${changesFor?.isPhoto ? 'Photo evidence required, ' : ''}${changesFor?.duration ? 'Duration of Milestone, ' : ''}${changesFor?.recommended ? 'Recommended Hours ' : ''}.`;\n                  description = `${stateData.name} details are updated.`;\n                }\n\n                if (props.editMile !== \"\") {\n                  // edit\n                  if (props === null || props === void 0 ? void 0 : props.addNewMile) {\n                    props === null || props === void 0 ? void 0 : props.addNewMile({\n                      milestoneName: stateData.name,\n                      isPhotoevidence: stateData.isPhoto,\n                      order: stateData.order,\n                      index: props.editMile,\n                      status: stateData.status,\n                      recommendedHours: stateData.recommended,\n                      fromDate: calenderItems.startDate,\n                      toDate: calenderItems.endDate,\n                      description: description\n                    });\n                  }\n                } else {\n                  // add\n                  if (props === null || props === void 0 ? void 0 : props.addNewMile) {\n                    var _props$milestones4;\n\n                    props === null || props === void 0 ? void 0 : props.addNewMile({\n                      milestoneName: stateData.name,\n                      isPhotoevidence: stateData.isPhoto,\n                      status: -1,\n                      order: (props === null || props === void 0 ? void 0 : (_props$milestones4 = props.milestones) === null || _props$milestones4 === void 0 ? void 0 : _props$milestones4.length) + 1,\n                      recommendedHours: stateData.recommended,\n                      fromDate: calenderItems.startDate,\n                      toDate: calenderItems.endDate,\n                      description: description\n                    });\n                  }\n                }\n\n                props.resetItems();\n              },\n              className: `fill_btn full_btn btn-effect ${check_errors ? \"disable_btn\" : \"\"}`,\n              children: \"Continue\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 607,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 606,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 530,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 529,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 413,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 412,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AddEditMile, \"4pxvI2wH7DwIOYjgBAaLyoXFd/Q=\");\n\n_c = AddEditMile;\nexport default AddEditMile;\n\nvar _c;\n\n$RefreshReg$(_c, \"AddEditMile\");","map":{"version":3,"sources":["/home/appinventiv/Documents/Project/tickt/web/src/pages/builderJobDasboard/components/editMilestones/addEditMile.tsx"],"names":["React","useEffect","useState","moment","Button","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","Modal","renderTimeWithCustomFormat","setShowToast","DateRangePicker","label","name","duration","recommended","pattern","STRING_ERROR","AddEditMile","props","resetItems","item","stateData","setStateData","isPhoto","status","order","errors","setErrors","hours","pattern_error","toggleCalender","setToggleCalender","changesFor","setChangesFor","toggleItem","setToggleItem","calenderItems","setCalender","startDate","endDate","key","toggleCal","prev","checkHoursVal","value","lable","length","match","split","isInvalid","handleChange","error_clone","trimLeft","replace","includes","onMountCallable","count_times","milestones","filteredItems","filter","toDate","fromDate","from_format","format","to_format","Object","keys","console","log","forEach","index","to_date","from_date","color_index","Math","floor","random","from_element","document","getElementsByClassName","element_from","classList","add","parentElement","contains","to_element","element_to","editMile","editItem","milestoneName","isPhotoevidence","recommendedHours","isValid","interval","setInterval","clearInterval","checkIfChange","renderDuration","checkBeforeExist","time","milestones_","catch_boolean","milestoneItems","mile","mile_start","mile_end","time_start","time_end","undefined","handleCalender","date","selection","isChecked","addTimeToMileStone","skip","milestone_clone","checkIsValid","check_errors","ItemCal","Date","min_date","max_date","padding","jobDetail","jobName","isSame","e","target","description","values","addNewMile"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport moment from \"moment\";\nimport Button from \"@material-ui/core/Button\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport Modal from \"@material-ui/core/Modal\";\nimport { renderTimeWithCustomFormat } from \"../../../../utils/common\";\nimport { setShowToast } from \"../../../../redux/common/actions\";\n\n// @ts-ignore\nimport { DateRangePicker } from \"../../../../plugins/react-date-range/dist/index\";\nimport \"../../../../plugins/react-date-range/dist/styles.css\";\nimport \"../../../../plugins/react-date-range/dist/theme/default.css\";\n\n// for error messages\nconst label: { [index: string]: string } = {\n  name: \"Milestone Name\",\n  duration: \"From Date\",\n  recommended: \"Recommended Hours\",\n};\n\nconst pattern = \"^([0-9][0-9]?[0-9]?[0-9]?[0-9]):[0-5][0-9]$\";\nconst STRING_ERROR = \"Selected data is fully engage\";\nconst AddEditMile = (props: any) => {\n  const { resetItems, item } = props;\n  const [stateData, setStateData] = useState({\n    name: \"\",\n    isPhoto: false,\n    duration: \"\",\n    recommended: \"\",\n    status: -1,\n    order: -1,\n  });\n  const [errors, setErrors] = useState<any>({\n    name: \"\",\n    duration: \"\",\n    hours: \"\",\n    pattern_error: \"\",\n  });\n  const [toggleCalender, setToggleCalender] = useState(false);\n\n  const [changesFor, setChangesFor] = useState({\n    name: false,\n    isPhoto: false,\n    duration: false,\n    recommended: false,\n  });\n\n  const [toggleItem, setToggleItem] = useState(false);\n\n  const [calenderItems, setCalender] = useState<any>({\n    startDate: \"\", //new Date(),\n    endDate: \"\", //new Date(),\n    key: \"selection\",\n  });\n\n  const toggleCal = () => {\n    setToggleCalender((prev: any) => !prev);\n  };\n\n  const checkHoursVal = (value: any, lable: any, name: any) => {\n    if (value?.length) {\n      if (value.match(pattern) !== null) {\n        if (!(+value.split(\":\")[1] % 15 === 0)) {\n          return \"Time should be in mutiples of 15 like 10:15, 10:30\";\n        }\n        return \"\";\n      } else {\n        return \"Please enter a valid pattern like : 10:15\";\n      }\n    }\n    return \"\";\n  };\n\n  const isInvalid = (name: string, value: string) => {\n    switch (name) {\n      case \"name\":\n        return !value.length\n          ? `${label[name]} is required.`\n          : value.length > 50\n          ? \"Maximum 50 characters are allowed.\"\n          : \"\";\n      case \"duration\":\n        return \"\";\n      case \"recommended\":\n        return checkHoursVal(value, label, name);\n    }\n  };\n\n  const handleChange = (name: any, value: any) => {\n    let error_clone: any = {};\n\n    if (name === \"name\") {\n      value = value.trimLeft().replace(/[^a-zA-Z|0-9 ]/g, \"\");\n    }\n\n    if (name === \"recommended\") {\n      value = value.trimLeft();\n    }\n\n    if ([\"name\", \"recommended\"].includes(name)) {\n      if (isInvalid(name, value)) {\n        error_clone[name] = isInvalid(name, value);\n      }\n    }\n\n    setStateData((prev: any) => ({\n      ...prev,\n      [name]: value,\n    }));\n    setErrors(error_clone);\n  };\n\n  const onMountCallable = () => {\n    let count_times: any = {};\n    let milestones = props.milestones;\n    let filteredItems = milestones.filter((item: any) => {\n      let toDate = item?.toDate;\n      let fromDate = item?.fromDate;\n\n      if (fromDate) {\n        let from_format = moment(fromDate).format(\"MM-DD-YYYY\");\n        item[\"from_date\"] = from_format;\n        count_times[from_format] = 0;\n      }\n\n      if (toDate) {\n        let to_format = moment(toDate).format(\"MM-DD-YYYY\");\n        item[\"to_date\"] = to_format;\n        count_times[to_format] = 0;\n      }\n\n      if (Object.keys(item).length) {\n        return item;\n      }\n    });\n\n    console.log({ filteredItems, count_times });\n\n    if (filteredItems?.length) {\n      filteredItems.forEach((item: any, index: any) => {\n        let to_date = item?.to_date;\n        let from_date = item?.from_date;\n        let color_index = index;\n        if (index > 500) {\n          color_index = Math.floor(Math.random() * 500 + 1);\n        }\n\n        if (!to_date && from_date) {\n          if (count_times[from_date] > -1) {\n            count_times[from_date]++;\n          }\n\n          let from_element: any = document.getElementsByClassName(\n            `color_${count_times[from_date]}_${from_date}`\n          );\n          if (from_element) {\n            let element_from = from_element[0];\n            if (from_element?.length > 1) {\n              element_from = from_element[1];\n            }\n\n            if (element_from) {\n              element_from.classList.add(`color_${color_index}`);\n            }\n          }\n        }\n\n        if (to_date && from_date) {\n          if (count_times[from_date] > -1) {\n            count_times[from_date]++;\n          }\n\n          if (count_times[to_date] > -1) {\n            count_times[to_date]++;\n          }\n\n          // let colorbyIndex = randomColors[index];\n          let from_element: any = document.getElementsByClassName(\n            `color_${count_times[from_date]}_${from_date}`\n          );\n          if (from_element) {\n            let element_from = null;\n\n            if (from_element?.length > 1) {\n              if (\n                !from_element[0].parentElement.parentElement.classList.contains(\n                  \"rdrDayPassive\"\n                )\n              ) {\n                element_from = from_element[0];\n              } else {\n                element_from = from_element[1];\n              }\n            } else {\n              element_from = from_element[0];\n            }\n\n            if (element_from) {\n              element_from.classList.add(`color_${color_index}`);\n            }\n          }\n\n          let to_element: any = document.getElementsByClassName(\n            `color_${count_times[to_date]}_${to_date}`\n          );\n          if (to_element) {\n            let element_to = null;\n            if (to_element?.length > 1) {\n              if (\n                !to_element[0].parentElement.parentElement.classList.contains(\n                  \"rdrDayPassive\"\n                )\n              ) {\n                element_to = to_element[0];\n              } else {\n                element_to = to_element[1];\n              }\n            } else {\n              element_to = to_element[0];\n            }\n            if (element_to) {\n              element_to.classList.add(`color_${color_index}`);\n            }\n          }\n        }\n      });\n    }\n  };\n\n  useEffect(() => {\n    const { milestones, editMile } = props;\n    if (editMile > -1) {\n      let editItem: any = milestones[editMile];\n      if (editItem) {\n        setStateData((prev: any) => ({\n          order: editItem?.order ? editItem?.order : -1,\n          name: editItem.milestoneName,\n          isPhoto: editItem.isPhotoevidence,\n          duration: renderTimeWithCustomFormat(\n            editItem.fromDate,\n            editItem.toDate,\n            \"\",\n            [\"DD MMM\", \"DD MMM YY\"]\n          ),\n          recommended: editItem?.recommendedHours,\n          status: editItem?.status,\n        }));\n\n        setCalender({\n          startDate: moment(editItem?.fromDate).isValid()\n            ? moment(editItem?.fromDate).toDate()\n            : \"\",\n          endDate: moment(editItem?.toDate).isValid()\n            ? moment(editItem?.toDate).toDate()\n            : \"\",\n          key: \"selection\",\n        });\n      }\n    }\n\n    const interval = setInterval(() => {\n      onMountCallable();\n    }, 2000);\n\n    return () => {\n      console.log(`clearing interval`);\n      clearInterval(interval);\n    };\n  }, []);\n\n  const checkIfChange = () => {\n    let renderDuration: any = renderTimeWithCustomFormat(\n      calenderItems.startDate,\n      calenderItems.endDate,\n      \"\",\n      [\"DD MMM\", \"DD MMM YY\"],\n      \"Choose\"\n    );\n\n    if (\n      !stateData?.name?.length &&\n      !stateData?.isPhoto &&\n      renderDuration === \"Choose\" &&\n      !stateData?.recommended?.length\n    ) {\n      return false;\n    }\n    return true;\n  };\n\n  const checkBeforeExist = (time: any, milestones_?: any) => {\n    let count_times: any = {};\n    let catch_boolean: boolean = true;\n    let milestoneItems: any = props?.milestones;\n\n    milestoneItems.forEach((mile: any) => {\n      let mile_start = mile.from_date;\n      let mile_end = mile.to_date;\n\n      let time_start = moment(time.fromDate).isValid()\n        ? moment(time.fromDate).format(\"MM-DD-YYYY\")\n        : \"\";\n      let time_end = moment(time.toDate).isValid()\n        ? moment(time.toDate).format(\"MM-DD-YYYY\")\n        : \"\";\n\n      if (count_times[mile_start] == undefined) {\n        count_times[mile_start] = 1;\n      } else {\n        count_times[mile_start] = count_times[mile_start] + 1;\n      }\n\n      if (count_times[mile_end] == undefined) {\n        count_times[mile_end] = 1;\n      } else {\n        count_times[mile_end] = count_times[mile_end] + 1;\n      }\n\n      if (count_times[mile_start] === 4) {\n        if (mile_start == time_start || mile_start == time_end) {\n          setShowToast(true, STRING_ERROR);\n          catch_boolean = false;\n        }\n      } else {\n        if (count_times[time_start] === 4) {\n          setShowToast(true, STRING_ERROR);\n          catch_boolean = false;\n        }\n      }\n\n      if (count_times[mile_end] === 4) {\n        if (mile_end == time_start || mile_end == time_end) {\n          setShowToast(true, STRING_ERROR);\n          catch_boolean = false;\n        }\n      } else {\n        if (count_times[time_end] === 4) {\n          setShowToast(true, STRING_ERROR);\n          catch_boolean = false;\n        }\n      }\n    });\n\n    return catch_boolean;\n  };\n\n  const handleCalender = (date: any) => {\n    let time = {\n      fromDate: date.selection.startDate,\n      toDate: date.selection.endDate,\n    };\n    console.log({ selection: date.selection });\n    let index = props?.milestones?.length;\n\n    let isChecked = checkBeforeExist(time);\n    if (isChecked) {\n      addTimeToMileStone(time, index);\n    }\n    // setCalender(date.selection);\n  };\n\n  const addTimeToMileStone = (time: any, index: any, skip?: any) => {\n    let milestone_clone: any = props?.milestones;\n    let checkIsValid: any = true;\n\n    console.log({ checkIsValid });\n    if (!checkIsValid) {\n      setShowToast(true, \"Please add unique date\");\n      return;\n    }\n\n    setCalender({\n      startDate: moment(time.fromDate).toDate(),\n      endDate: moment(time.toDate).toDate(),\n      key: \"selection\",\n    });\n  };\n\n  // before render check\n  const { name, isPhoto, recommended } = stateData;\n  let check_errors = false;\n  let renderDuration: any = renderTimeWithCustomFormat(\n    calenderItems.startDate,\n    calenderItems.endDate,\n    \"\",\n    [\"DD MMM\", \"DD MMM YYYY\", true],\n    \"Choose\"\n  );\n\n  if (\n    !name?.length ||\n    (recommended?.length > 0 && errors.recommended?.length)\n  ) {\n    check_errors = true;\n  }\n\n  let ItemCal: any = calenderItems;\n  if (!moment(calenderItems?.startDate).isValid()) {\n    ItemCal = { startDate: new Date(), endDate: \"\", key: \"selection\" };\n  }\n\n  let min_date: any = moment(item?.fromDate).isValid()\n    ? moment(item?.fromDate).toDate()\n    : new Date();\n  // let max_date: any = moment(item?.toDate).isValid() && !moment(item?.fromDate).isSame(item?.toDate) ? moment(item?.toDate).toDate() : moment().add(2, 'years').toDate();\n  let max_date: any = moment().add(2, \"years\").toDate();\n  return (\n    <div className=\"flex_row\">\n      <div className=\"flex_col_sm_12\">\n        <Dialog\n          open={toggleItem}\n          // onClose={handleClose}\n          aria-labelledby=\"alert-dialog-title\"\n          aria-describedby=\"alert-dialog-description\"\n        >\n          <DialogTitle\n            id=\"alert-dialog-title\"\n            className=\"xs_alert_dialog_title\"\n          >\n            {\"Heads Up\"}\n          </DialogTitle>\n          <DialogContent>\n            <DialogContentText>\n              {\"If you go back, you will lose all your changes.\"}\n            </DialogContentText>\n          </DialogContent>\n          <DialogActions>\n            <Button\n              onClick={() => {\n                setToggleItem((prev: any) => !prev);\n              }}\n              color=\"primary\"\n            >\n              {\"Yes\"}\n            </Button>\n            <Button\n              onClick={() => {\n                setToggleItem((prev: any) => !prev);\n                resetItems();\n              }}\n              color=\"primary\"\n              autoFocus\n            >\n              {\"No\"}\n            </Button>\n          </DialogActions>\n        </Dialog>\n\n        <Modal\n          className=\"custom_modal \"\n          open={toggleCalender}\n          onClose={() => {\n            toggleCal();\n          }}\n          aria-labelledby=\"calender-active-modal-title\"\n          aria-describedby=\"calender-active-modal-title\"\n        >\n          <div\n            style={{\n              padding: \"12px 20px 0px\",\n            }}\n            className=\"item-modal-ctm custom_wh portfolio_preview \"\n          >\n            {console.log({ jobDetail: props.jobDetail })}\n            <DateRangePicker\n              ranges={[ItemCal]}\n              onChange={(date: any) => {\n                handleCalender(date);\n                setChangesFor((prev: any) => ({ ...prev, duration: true }));\n              }}\n              months={2}\n              direction=\"horizontal\"\n              moveRangeOnFirstSelection={false}\n              rangeColors={[\"#fee600\", \"#b5b5b5\"]}\n              showDateDisplay={false}\n              showSelectionPreview={true}\n              showPreview={true}\n              minDate={min_date}\n              maxDate={max_date}\n              fixedHeight={true}\n            />\n          </div>\n        </Modal>\n\n        <div className=\"form_field\">\n          <div className=\"flex_row\">\n            <div className=\"flex_col_sm_7\">\n              <div className=\"relate\">\n                <button\n                  onClick={() => {\n                    if (checkIfChange()) {\n                      setToggleItem((prev: any) => !prev);\n                      return;\n                    }\n                    resetItems();\n                  }}\n                  className=\"back\"\n                ></button>\n                <span className=\"title\">{item?.jobName || \"\"}</span>\n              </div>\n              <p className=\"sub_title\">\n                {`${props.editMile === \"\" ? \"\" : \"Edit \"}`}\n                {`${\n                  props.editMile === \"\" && props?.isSame\n                    ? `Milestones ${props?.milestones?.length + 1}`\n                    : props.editMile !== \"\" &&\n                      props.editMile > -1 &&\n                      props?.isSame\n                    ? `Milestones ${props.editMile + 1}`\n                    : props.editMile !== \"\" &&\n                      props.editMile > -1 &&\n                      !props?.isSame\n                    ? `Milestone ${props.editMile + 1}`\n                    : props.editMile === \"\" && !props?.isSame\n                    ? `Milestone ${props?.milestones?.length + 1}`\n                    : null\n                }`}\n                {/* {`${!props?.isSame && props.editMile ? ' Mileston-e ' + props.editMile : props?.isSame && props.editMile > -1 ? ' Milesto-ne ' + (props.editMile + 1) : props?.milestones?.length + 1}`}\n                                {console.log({ props })} */}\n                {/* {console.log({ props })} */}\n              </p>\n            </div>\n          </div>\n        </div>\n        <div className=\"flex_row\">\n          <div className=\"flex_col_sm_7\">\n            <div className=\"form_field\">\n              <label className=\"form_label\">{\"Milestone Name\"}</label>\n              <div className=\"text_field\">\n                <input\n                  type=\"text\"\n                  placeholder=\"Enter Milestone Name\"\n                  onChange={(e: any) => {\n                    handleChange(\"name\", e.target.value);\n                    setChangesFor((prev: any) => ({ ...prev, name: true }));\n                  }}\n                  value={name}\n                  name=\"milestone_name\"\n                />\n              </div>\n              <span className=\"error_msg\">{errors?.name}</span>\n            </div>\n            <div className=\"form_field\">\n              <div className=\"checkbox_wrap agree_check\">\n                <input\n                  onChange={() => {\n                    setStateData((prev: any) => ({\n                      ...prev,\n                      isPhoto: !prev.isPhoto,\n                    }));\n                    setChangesFor((prev: any) => ({ ...prev, isPhoto: true }));\n                  }}\n                  checked={isPhoto}\n                  className=\"filter-type filled-in\"\n                  type=\"checkbox\"\n                  id=\"milestone1\"\n                />\n                <label htmlFor=\"milestone1\">\n                  <b>{\"Photo evidence required\"}</b>\n                </label>\n              </div>\n            </div>\n            <div className=\"form_field\">\n              <div className=\"f_spacebw\">\n                <label className=\"form_label\">\n                  {\"Duration of milestone (optional)\"}\n                </label>\n                <button\n                  onClick={() => {\n                    toggleCal();\n                  }}\n                  className=\"fill_btn fill_grey_btn choose_btn\"\n                >\n                  {renderDuration}\n                </button>\n              </div>\n            </div>\n            <div className=\"form_field\">\n              <label className=\"form_label\">\n                {\"Estimated Hours (optional)\"}\n              </label>\n              <div className=\"text_field\">\n                <input\n                  onChange={(e) => {\n                    handleChange(\"recommended\", e.target.value);\n                    setChangesFor((prev: any) => ({\n                      ...prev,\n                      recommended: true,\n                    }));\n                  }}\n                  autoComplete=\"off\"\n                  value={recommended}\n                  type=\"text\"\n                  placeholder=\"Enter Estimated Hours\"\n                  name=\"recommended_hours\"\n                />\n              </div>\n              <span className=\"error_msg\">{errors.recommended}</span>\n              {/* <span className=\"error_msg\">{errors.pattern_error}</span> */}\n            </div>\n\n            <div className=\"form_field\">\n              <button\n                onClick={() => {\n                  let description: any = \"\";\n                  if (Object.values(changesFor).includes(true)) {\n                    // description = `This job has Milestones change request with changes in ${changesFor?.name ? 'Milestone Name, ' : ''}${changesFor?.isPhoto ? 'Photo evidence required, ' : ''}${changesFor?.duration ? 'Duration of Milestone, ' : ''}${changesFor?.recommended ? 'Recommended Hours ' : ''}.`;\n                    description = `${stateData.name} details are updated.`;\n                  }\n\n                  if (props.editMile !== \"\") {\n                    // edit\n                    if (props?.addNewMile) {\n                      props?.addNewMile({\n                        milestoneName: stateData.name,\n                        isPhotoevidence: stateData.isPhoto,\n                        order: stateData.order,\n                        index: props.editMile,\n                        status: stateData.status,\n                        recommendedHours: stateData.recommended,\n                        fromDate: calenderItems.startDate,\n                        toDate: calenderItems.endDate,\n                        description: description,\n                      });\n                    }\n                  } else {\n                    // add\n                    if (props?.addNewMile) {\n                      props?.addNewMile({\n                        milestoneName: stateData.name,\n                        isPhotoevidence: stateData.isPhoto,\n                        status: -1,\n                        order: props?.milestones?.length + 1,\n                        recommendedHours: stateData.recommended,\n                        fromDate: calenderItems.startDate,\n                        toDate: calenderItems.endDate,\n                        description: description,\n                      });\n                    }\n                  }\n                  props.resetItems();\n                }}\n                className={`fill_btn full_btn btn-effect ${\n                  check_errors ? \"disable_btn\" : \"\"\n                }`}\n              >\n                {\"Continue\"}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AddEditMile;\n"]},"metadata":{},"sourceType":"module"}