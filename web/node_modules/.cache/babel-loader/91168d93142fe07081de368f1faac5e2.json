{"ast":null,"code":"import _regeneratorRuntime from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from'react';import{connect}from'react-redux';import InfiniteScroll from'react-infinite-scroll-component';import{getPopularBuilder}from'../../redux/homeSearch/actions';import dummy from'../../assets/images/u_placeholder.jpg';import noData from'../../assets/images/no-search-data.png';import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PopularBuilders=function PopularBuilders(props){var _props$history,_props$history$locati,_props$history$locati2,_props$history2,_props$history2$locat,_props$history2$locat2,_props$history3,_props$history3$locat,_props$history3$locat2,_props$history4,_props$history4$locat,_props$history4$locat2;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),buildersList=_useState2[0],setBuildersList=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),totalCount=_useState4[0],setTotalCount=_useState4[1];var _useState5=useState(1),_useState6=_slicedToArray(_useState5,2),pageNo=_useState6[0],setPageNo=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),hasMoreItems=_useState8[0],setHasMoreItems=_useState8[1];var lat=((_props$history=props.history)===null||_props$history===void 0?void 0:(_props$history$locati=_props$history.location)===null||_props$history$locati===void 0?void 0:(_props$history$locati2=_props$history$locati.state)===null||_props$history$locati2===void 0?void 0:_props$history$locati2.coordinates[1])?(_props$history2=props.history)===null||_props$history2===void 0?void 0:(_props$history2$locat=_props$history2.location)===null||_props$history2$locat===void 0?void 0:(_props$history2$locat2=_props$history2$locat.state)===null||_props$history2$locat2===void 0?void 0:_props$history2$locat2.coordinates[1]:-37.8136;var long=((_props$history3=props.history)===null||_props$history3===void 0?void 0:(_props$history3$locat=_props$history3.location)===null||_props$history3$locat===void 0?void 0:(_props$history3$locat2=_props$history3$locat.state)===null||_props$history3$locat2===void 0?void 0:_props$history3$locat2.coordinates[0])?(_props$history4=props.history)===null||_props$history4===void 0?void 0:(_props$history4$locat=_props$history4.location)===null||_props$history4$locat===void 0?void 0:(_props$history4$locat2=_props$history4$locat.state)===null||_props$history4$locat2===void 0?void 0:_props$history4$locat2.coordinates[0]:144.9631;useEffect(function(){callJobList();},[]);var callJobList=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var data,res,_res$result,_res$result2,_res$result2$data,_res$result3,allBuilders,_res$result4;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(buildersList.length>=totalCount)){_context.next=3;break;}setHasMoreItems(false);return _context.abrupt(\"return\");case 3:data={long:long,lat:lat,page:pageNo,perPage:10};_context.next=6;return getPopularBuilder(data);case 6:res=_context.sent;if(res.success){allBuilders=[].concat(_toConsumableArray(buildersList),_toConsumableArray((_res$result=res.result)===null||_res$result===void 0?void 0:_res$result.data));if(((_res$result2=res.result)===null||_res$result2===void 0?void 0:(_res$result2$data=_res$result2.data)===null||_res$result2$data===void 0?void 0:_res$result2$data.length)<10){setHasMoreItems(false);}setBuildersList(allBuilders);setPageNo(pageNo+1);if(((_res$result3=res.result)===null||_res$result3===void 0?void 0:_res$result3.totalCount)!==totalCount){setTotalCount((_res$result4=res.result)===null||_res$result4===void 0?void 0:_res$result4.totalCount);}}case 8:case\"end\":return _context.stop();}}},_callee);}));return function callJobList(){return _ref.apply(this,arguments);};}();var backButtonClicked=function backButtonClicked(){var _props$history5;(_props$history5=props.history)===null||_props$history5===void 0?void 0:_props$history5.goBack();};console.log('props: ',props,buildersList.length,\"zzz\",totalCount);return/*#__PURE__*/_jsx(InfiniteScroll,{dataLength:buildersList.length,next:callJobList,style:{overflowX:'hidden'},hasMore:hasMoreItems,loader:/*#__PURE__*/_jsx(_Fragment,{}),children:/*#__PURE__*/_jsx(\"div\",{className:\"app_wrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"section_wrapper bg_gray\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"custom_container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relate\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back\",onClick:backButtonClicked}),/*#__PURE__*/_jsx(\"span\",{className:\"title\",children:\"Popular builders\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex_row tradies_row\",children:(buildersList===null||buildersList===void 0?void 0:buildersList.length)>0||props.isLoading?buildersList.map(function(item){var _item$trade,_item$trade$,_item$rating;return/*#__PURE__*/_jsx(\"div\",{className:\"flex_col_sm_4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"tradie_card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"f_spacebw tag_review\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"form_label\",children:item===null||item===void 0?void 0:(_item$trade=item.trade)===null||_item$trade===void 0?void 0:(_item$trade$=_item$trade[0])===null||_item$trade$===void 0?void 0:_item$trade$.trade_name}),/*#__PURE__*/_jsx(\"span\",{className:\"rating\",children:\"\".concat(item.reviewCount?\"\".concat(item.rating%1===0?item.rating:(_item$rating=item.rating)===null||_item$rating===void 0?void 0:_item$rating.toFixed(2),\" | \").concat(item.review,\" reviews\"):\"0 | 0 reviews\")})]}),/*#__PURE__*/_jsx(\"span\",{className:\"more_detail new_top circle\",onClick:function onClick(e){props.history.push(\"/builder-info?builderId=\".concat(item._id));}}),/*#__PURE__*/_jsxs(\"div\",{className:\"user_wrap\",children:[/*#__PURE__*/_jsx(\"figure\",{className:\"u_img\",children:/*#__PURE__*/_jsx(\"img\",{src:item.user_image||dummy,onError:function onError(e){var e_=e;e_.target.src=dummy;},alt:\"img\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"details\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"name\",children:item.firstName}),/*#__PURE__*/_jsx(\"span\",{className:\"job\",children:item===null||item===void 0?void 0:item.company_name})]})]})]})});}):/*#__PURE__*/_jsxs(\"div\",{className:\"no_record\",children:[/*#__PURE__*/_jsx(\"figure\",{className:\"no_img\",children:/*#__PURE__*/_jsx(\"img\",{src:noData,alt:\"data not found\"})}),/*#__PURE__*/_jsx(\"span\",{children:\"No Data Found\"})]})})]})})})});};var mapStateToProps=function mapStateToProps(state){return{isLoading:state.common.isLoading};};export default connect(mapStateToProps,null)(PopularBuilders);","map":{"version":3,"sources":["/home/appinventiv/Documents/Project/tickt/web/src/pages/popularBuilders/popularBuilders.tsx"],"names":["useState","useEffect","connect","InfiniteScroll","getPopularBuilder","dummy","noData","PopularBuilders","props","buildersList","setBuildersList","totalCount","setTotalCount","pageNo","setPageNo","hasMoreItems","setHasMoreItems","lat","history","location","state","coordinates","long","callJobList","length","data","page","perPage","res","success","allBuilders","result","backButtonClicked","goBack","console","log","overflowX","isLoading","map","item","trade","trade_name","reviewCount","rating","toFixed","review","e","push","_id","user_image","e_","target","src","firstName","company_name","mapStateToProps","common"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport InfiniteScroll from 'react-infinite-scroll-component';\nimport { getPopularBuilder } from '../../redux/homeSearch/actions';\n\nimport dummy from '../../assets/images/u_placeholder.jpg';\nimport menu from '../../assets/images/menu-line-blue.png';\n\nimport noData from '../../assets/images/no-search-data.png';\n\nconst PopularBuilders = (props: any) => {\n    const [buildersList, setBuildersList] = useState<Array<any>>([]);\n    const [totalCount, setTotalCount] = useState<number>(1);\n    const [pageNo, setPageNo] = useState<number>(1);\n    const [hasMoreItems, setHasMoreItems] = useState<boolean>(true);\n    const lat: string = props.history?.location?.state?.coordinates[1] ? props.history?.location?.state?.coordinates[1] : -37.8136;\n    const long: string = props.history?.location?.state?.coordinates[0] ? props.history?.location?.state?.coordinates[0] : 144.9631;\n\n    useEffect(() => {\n        callJobList();\n    }, []);\n\n    const callJobList = async () => {\n        if (buildersList.length >= totalCount) {\n            setHasMoreItems(false);\n            return;\n        }\n        const data = {\n            long: long,\n            lat: lat,\n            page: pageNo,\n            perPage: 10\n        }\n        const res = await getPopularBuilder(data);\n        if (res.success) {\n            const allBuilders = [...buildersList, ...res.result?.data];\n            if (res.result?.data?.length < 10) {\n                setHasMoreItems(false);\n            }\n            setBuildersList(allBuilders);\n            setPageNo(pageNo + 1);\n            if (res.result?.totalCount !== totalCount) {\n                setTotalCount(res.result?.totalCount);\n            }\n        }\n    }\n    const backButtonClicked = () => {\n        props.history?.goBack();\n    }\n\n    console.log('props: ', props, buildersList.length, \"zzz\", totalCount);\n\n    return (\n        <InfiniteScroll\n            dataLength={buildersList.length}\n            next={callJobList}\n            style={{ overflowX: 'hidden' }}\n            hasMore={hasMoreItems}\n            loader={<></>}\n        >\n            <div className=\"app_wrapper\">\n                <div className=\"section_wrapper bg_gray\">\n                    <div className=\"custom_container\">\n                        <div className=\"relate\">\n                            <button className=\"back\" onClick={backButtonClicked}></button>\n                            <span className=\"title\">Popular builders</span>\n                        </div>\n                        <div className=\"flex_row tradies_row\">\n                            {(buildersList?.length > 0 || props.isLoading) ? buildersList.map((item: any) => {\n                                return (\n                                    <div className=\"flex_col_sm_4\">\n                                        <div className=\"tradie_card\">\n                                            <div className=\"f_spacebw tag_review\">\n                                                <span className=\"form_label\">{(item?.trade?.[0]?.trade_name)}</span>\n                                                <span className=\"rating\">\n                                                    {`${item.reviewCount ? `${item.rating % 1 === 0 ? item.rating : item.rating?.toFixed(2)} | ${item.review} reviews` : `0 | 0 reviews`}`}</span>\n                                            </div>\n                                            <span className=\"more_detail new_top circle\"\n                                                onClick={(e: any) => {\n                                                    props.history.push(`/builder-info?builderId=${item._id}`)\n                                                }}></span>\n                                            <div className=\"user_wrap\">\n                                                <figure className=\"u_img\">\n                                                    <img\n                                                        src={item.user_image || dummy}\n                                                        onError={(e: any) => {\n                                                            let e_: any = e;\n                                                            e_.target.src = dummy;\n                                                        }}\n                                                        alt=\"img\" />\n                                                </figure>\n                                                <div className=\"details\">\n                                                    <span className=\"name\">{item.firstName}</span>\n                                                    <span className=\"job\">{item?.company_name}</span>\n                                                    {/* <span className=\"rating\">{`${item.reviewCount ? `${item.rating % 1 === 0 ? item.rating : item.rating?.toFixed(2)} | ${item.review} reviews` : `0, 0 reviews`}`}</span> */}\n                                                </div>\n                                            </div>\n                                            {/* <div className=\"tags_wrap\">\n                                                <ul>\n                                                    {item.trade?.length ? item.trade.map(({ _id, selected_url, trade_name }: { _id: string, selected_url: string, trade_name: string }) => (\n                                                        <li key={_id} className=\"main\">\n                                                            <img src={selected_url || menu} alt=\"\" />\n                                                            {trade_name || ''}\n                                                        </li>)) : <i style={{ color: '#929292' }}>\n                                                        {'No Trade Found'}\n                                                    </i>}\n                                                    {item.trade?.length > 0 && item.specializations.slice(0, 5 - item.trade?.length).map((item: any) => <li key={item._id}>{item.name}</li>)}\n                                                    {item.trade?.length > 0 && (item.trade?.length + item.specializations?.length > 5) && <li>More</li>}\n                                                </ul>\n                                            </div> */}\n                                        </div>\n                                    </div>)\n                            }) : <div className=\"no_record\">\n                                <figure className=\"no_img\">\n                                    <img src={noData} alt=\"data not found\" />\n                                </figure>\n                                <span>No Data Found</span>\n                            </div>}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </InfiniteScroll>\n    )\n}\n\nconst mapStateToProps = (state: any) => {\n    return {\n        isLoading: state.common.isLoading,\n    }\n}\n\nexport default connect(mapStateToProps, null)(PopularBuilders);\n"]},"metadata":{},"sourceType":"module"}