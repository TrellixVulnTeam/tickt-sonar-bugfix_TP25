{"ast":null,"code":"var _jsxFileName = \"/home/appinventiv/Documents/Project/tickt/web/src/pages/builderJobDasboard/components/editMilestones/index.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react'; // @ts-ignore\n\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd';\nimport { renderTimeWithCustomFormat } from '../../../../utils/common';\nimport milestonesPlaceholder from '../../../../assets/images/Job milestones-preview.png';\nimport moment from 'moment';\nimport { setShowToast } from '../../../../redux/common/actions';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport { moengage, mixPanel } from '../../../../services/analyticsTools';\nimport { MoEConstants } from '../../../../utils/constants';\nimport { changeRequest } from '../../../../redux/jobs/actions';\nimport AddEditMile from './addEditMile';\nimport { withRouter } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst EditMilestone = props => {\n  _s();\n\n  const {\n    item,\n    item: {\n      jobName\n    },\n    details: {\n      milestones\n    }\n  } = props;\n  const jobDetail = Object.freeze(props === null || props === void 0 ? void 0 : props.details);\n  const [stateData, setStateData] = useState([]);\n  const [stateItems, setItems] = useState([]);\n  const [editItem, setEditItems] = useState({});\n  const [deleteItem, setDeleteItem] = React.useState(null);\n  const [itemData, setItemData] = useState({\n    add: false,\n    edit: false,\n    editId: '',\n    deleteId: ''\n  });\n  const [sortedItems, setSortedItems] = React.useState([]);\n  const [toggleItem, setToggleItem] = useState(false);\n  const [description, setDescription] = useState([]);\n  useEffect(() => {\n    if (!(stateData === null || stateData === void 0 ? void 0 : stateData.length)) {\n      let filtered = milestones.map((item, index) => {\n        item['count'] = index + 1;\n        return item;\n      });\n      setStateData(filtered);\n      setItems(filtered);\n    }\n  }, []);\n\n  const reorder = (list, source, destination) => {\n    let startIndex = source.index;\n    let endIndex = destination.index;\n    let findItem = list.find((lt, index) => index === endIndex);\n    console.log({\n      findItem,\n      list,\n      destination,\n      endIndex\n    });\n\n    if (findItem) {\n      if ([1, 2].includes(findItem.status)) {\n        return list;\n      }\n    }\n\n    const result = Array.from(list);\n    const [removed] = result.splice(startIndex, 1);\n    result.splice(endIndex, 0, removed);\n    console.log({\n      result\n    });\n    setDescription(prev => [...prev, ...['Milestones are rearranged.']]);\n    return result;\n  };\n\n  const onDragEnd = result => {\n    const {\n      source,\n      destination\n    } = result; // dropped outside the list\n\n    if (!destination) {\n      return;\n    } // if (source.droppableId === destination.droppableId) {\n\n\n    const reOrderItems = reorder(stateItems, source, destination);\n    setItems(prev => reOrderItems);\n  };\n\n  const checkIfValidDates = item => {\n    let isfilter = stateItems.filter(item_ => {\n      if (item_.hasOwnProperty('fromDate')) {\n        if (moment(item_ === null || item_ === void 0 ? void 0 : item_.fromDate).isValid()) {\n          item_['fromDate'] = moment(item_.fromDate).startOf('day').toDate();\n          item_['toDate'] = item_.toDate === '' ? moment(item_.fromDate).startOf('day').toDate() : moment(item_.toDate).startOf('day').toDate();\n          return item_;\n        }\n      }\n    });\n\n    if (!(isfilter === null || isfilter === void 0 ? void 0 : isfilter.length)) {\n      return true;\n    } else {\n      const newarr = isfilter.sort((a, b) => {\n        let start_a = a.fromDate;\n        let end_a = a.toDate;\n        let start_b = b.fromDate;\n        let end_b = b.toDate;\n\n        if (start_a === start_b) {\n          return end_a - end_b;\n        }\n\n        return start_a - start_b;\n      });\n      let filteredItem = item.filter(item_reorder => {\n        if (item_reorder.hasOwnProperty('fromDate')) {\n          if (moment(item_reorder === null || item_reorder === void 0 ? void 0 : item_reorder.fromDate).isValid()) {\n            return item_reorder;\n          }\n        }\n      });\n      setSortedItems(newarr);\n      console.log({\n        newarr,\n        filteredItem\n      });\n      return JSON.stringify(newarr) === JSON.stringify(filteredItem);\n    }\n  };\n\n  const checkIfDatesValid = () => {\n    let data = item;\n    let start_selection = data === null || data === void 0 ? void 0 : data.fromDate;\n    let end_selection = null;\n\n    if (moment(data === null || data === void 0 ? void 0 : data.toDate).isValid()) {\n      if (!moment(data === null || data === void 0 ? void 0 : data.toDate).isSame(moment(data === null || data === void 0 ? void 0 : data.fromDate))) {\n        end_selection = data === null || data === void 0 ? void 0 : data.toDate;\n      }\n    }\n\n    let item_find = false;\n    let filteredItem = stateItems;\n\n    if (filteredItem === null || filteredItem === void 0 ? void 0 : filteredItem.length) {\n      filteredItem.forEach(item_date => {\n        if (item_date.fromDate) {\n          let start = moment(item_date.fromDate).isValid() ? item_date.fromDate : null;\n          let end = moment(item_date.toDate).isValid() ? item_date.toDate : null;\n\n          if (start && !end) {\n            if (moment(start_selection).isAfter(moment(start))) {\n              item_find = true; // true;\n            }\n          }\n\n          if (start_selection && end_selection && !end) {\n            if (moment(start).isSameOrAfter(moment(start_selection)) && moment(start).isSameOrBefore(moment(end_selection))) {\n              item_find = false;\n            } else {\n              item_find = true;\n            }\n          }\n        }\n      });\n    }\n\n    if (item_find) {\n      setShowToast(true, 'Please check the milestone dates');\n      return item_find;\n    }\n\n    return item_find;\n  };\n\n  const checkOnClick = (e, index) => {\n    let edit_item_clone = editItem;\n    edit_item_clone[index] = e.target.checked;\n    setEditItems(prev => ({ ...prev,\n      ...edit_item_clone\n    }));\n  };\n\n  const resetItems = () => {\n    setItemData(prev => ({ ...prev,\n      add: false,\n      edit: false,\n      editId: '',\n      deleteId: ''\n    }));\n    setEditItems({});\n  };\n\n  const addNewMile = item => {\n    let state_data = stateItems;\n\n    if (itemData === null || itemData === void 0 ? void 0 : itemData.edit) {\n      // edit\n      let index = parseInt(itemData.editId);\n      let prev_count = null;\n\n      if ((state_data === null || state_data === void 0 ? void 0 : state_data.length) > 1 && index > 0) {\n        prev_count = state_data[index - 1].count + 1;\n      } else {\n        prev_count = state_data[index].count;\n      }\n\n      console.log({\n        item,\n        prev_count\n      }, '---->');\n      state_data[itemData.editId]['isPhotoevidence'] = item.isPhotoevidence;\n      state_data[itemData.editId]['milestoneName'] = item.milestoneName;\n      state_data[itemData.editId]['recommendedHours'] = item.recommendedHours;\n      state_data[itemData.editId]['description'] = item.description;\n      state_data[itemData.editId]['status'] = item.status;\n      state_data[itemData.editId]['order'] = item.order;\n      state_data[index]['count'] = prev_count;\n      state_data[index]['fromDate'] = moment(item.fromDate).isValid() ? moment(item.fromDate).toISOString() : '';\n      state_data[index]['toDate'] = moment(item.toDate).isValid() ? moment(item.toDate).toISOString() : ''; // setStateData(state_data);\n\n      setItems(state_data);\n    } else {\n      item['count'] = (state_data === null || state_data === void 0 ? void 0 : state_data.length) + 1;\n      setItems(prev => [...prev, item]); // setStateData((prev: any) => ([...prev, item]));\n    }\n  };\n\n  if ((itemData === null || itemData === void 0 ? void 0 : itemData.add) || (itemData === null || itemData === void 0 ? void 0 : itemData.edit)) {\n    let filtered = stateData.filter(item => {\n      if (!(item === null || item === void 0 ? void 0 : item.isDeleteRequest)) {\n        return item;\n      }\n    });\n    return /*#__PURE__*/_jsxDEV(AddEditMile, {\n      item: item,\n      milestones: stateItems // filtered={filtered}\n      ,\n      jobDetail: jobDetail,\n      isSame: JSON.stringify(filtered) === JSON.stringify(stateData),\n      editMile: itemData.editId,\n      addNewMile: addNewMile,\n      resetItems: resetItems\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 13\n    }, this);\n  }\n\n  const removeMilestoneByIndex = index => {\n    let state_data = stateItems;\n    state_data[index]['isDeleteRequest'] = true;\n    let count = 0;\n\n    if (state_data === null || state_data === void 0 ? void 0 : state_data.length) {\n      let filtered = state_data.map(item => {\n        if (!(item === null || item === void 0 ? void 0 : item.isDeleteRequest)) {\n          count++;\n          item['count'] = count;\n        }\n\n        return item;\n      });\n      setStateData(filtered.concat(stateItems));\n      let Items = filtered.filter(item => {\n        if (!(item === null || item === void 0 ? void 0 : item.isDeleteRequest)) {\n          return item;\n        }\n      });\n      resetItems(); // removed length check to update the items.\n      // if (Items?.length) {\n\n      setItems(Items); // }\n    }\n  };\n\n  const checkIfChange = () => {\n    let isTrue = true;\n\n    if (!(stateItems === null || stateItems === void 0 ? void 0 : stateItems.length)) {\n      isTrue = false;\n    } else {\n      stateItems === null || stateItems === void 0 ? void 0 : stateItems.forEach(dt => {\n        var _dt$description;\n\n        if (dt === null || dt === void 0 ? void 0 : (_dt$description = dt.description) === null || _dt$description === void 0 ? void 0 : _dt$description.length) {\n          isTrue = false;\n        }\n      });\n      stateData === null || stateData === void 0 ? void 0 : stateData.forEach(dt => {\n        if (dt === null || dt === void 0 ? void 0 : dt.isDeleteRequest) {\n          isTrue = false;\n        }\n      });\n    }\n\n    return isTrue;\n  };\n\n  const submitData = async () => {\n    var _props$details;\n\n    let description_string = description;\n    let deletedItems = [];\n    let uniqueValues = {};\n    stateData.forEach(item => {\n      if (item === null || item === void 0 ? void 0 : item.isDeleteRequest) {\n        if (item === null || item === void 0 ? void 0 : item.milestoneId) {\n          if (uniqueValues[item === null || item === void 0 ? void 0 : item.milestoneId] == undefined) {\n            uniqueValues[item === null || item === void 0 ? void 0 : item.milestoneId] = 1;\n            deletedItems.push(item);\n          }\n        } //  else {\n        //     deletedItems.push(item);\n        // }\n\n      }\n    });\n    let filteredItems = deletedItems.concat(stateItems);\n    console.log({\n      deletedItems,\n      filteredItems\n    });\n    let filtered = filteredItems.map((item, index) => {\n      var _item$description, _data$to_date;\n\n      let data = {\n        \"milestoneId\": (item === null || item === void 0 ? void 0 : item.milestoneId) || '',\n        \"milestone_name\": item === null || item === void 0 ? void 0 : item.milestoneName,\n        \"isPhotoevidence\": item === null || item === void 0 ? void 0 : item.isPhotoevidence,\n        \"from_date\": moment(item === null || item === void 0 ? void 0 : item.fromDate).isValid() ? moment(item === null || item === void 0 ? void 0 : item.fromDate).format(\"YYYY-MM-DD\") : '',\n        \"to_date\": moment(item === null || item === void 0 ? void 0 : item.toDate).isValid() ? moment(item === null || item === void 0 ? void 0 : item.toDate).format(\"YYYY-MM-DD\") : '',\n        \"recommended_hours\": item === null || item === void 0 ? void 0 : item.recommendedHours,\n        \"description\": item === null || item === void 0 ? void 0 : item.description,\n        \"status\": item === null || item === void 0 ? void 0 : item.status\n      };\n\n      if ((_item$description = item.description) === null || _item$description === void 0 ? void 0 : _item$description.length) {\n        description_string.push(item.description);\n      }\n\n      if (!(data === null || data === void 0 ? void 0 : (_data$to_date = data.to_date) === null || _data$to_date === void 0 ? void 0 : _data$to_date.length)) {\n        delete data.to_date;\n      }\n\n      if ((item === null || item === void 0 ? void 0 : item.isDeleteRequest) && (item === null || item === void 0 ? void 0 : item.status) > -1) {\n        data['isDeleteRequest'] = true;\n        data['description'] = `${item === null || item === void 0 ? void 0 : item.milestoneName} was deleted.`;\n        description_string.push(`${item === null || item === void 0 ? void 0 : item.milestoneName} was deleted.`);\n      }\n\n      if (!(item === null || item === void 0 ? void 0 : item.milestoneId)) {\n        delete data.milestoneId;\n      }\n\n      data['order'] = index + 1;\n      return data;\n    }).filter(item => {\n      if (![1, 2, 3].includes(item === null || item === void 0 ? void 0 : item.status)) {\n        var _item$description2;\n\n        delete item.status;\n\n        if (item === null || item === void 0 ? void 0 : (_item$description2 = item.description) === null || _item$description2 === void 0 ? void 0 : _item$description2.length) {\n          delete item.description;\n        }\n\n        return item;\n      }\n    });\n    let data = {\n      \"jobId\": item.jobId,\n      \"tradieId\": props === null || props === void 0 ? void 0 : (_props$details = props.details) === null || _props$details === void 0 ? void 0 : _props$details.tradieId,\n      \"milestones\": filtered,\n      \"description\": Array.from(new Set(description_string))\n    };\n    console.log({\n      data\n    });\n    let response = await changeRequest(data);\n\n    if (response === null || response === void 0 ? void 0 : response.success) {\n      moengage.moE_SendEvent(MoEConstants.EDIT_MILESTONES, {\n        timeStamp: moengage.getCurrentTimeStamp()\n      });\n      mixPanel.mixP_SendEvent(MoEConstants.EDIT_MILESTONES, {\n        timeStamp: moengage.getCurrentTimeStamp()\n      });\n      props.history.push('/milestone-request-sent-success');\n    }\n  };\n\n  const renderTimeIfExist = (fromDate, toDate) => {\n    const time = renderTimeWithCustomFormat(fromDate, moment(fromDate).isSame(moment(toDate)) ? '' : toDate, '', ['DD MMM', 'DD MMM YY']);\n    return time === 'Choose' ? '' : time;\n  };\n\n  const customRenderElements = ({\n    milestoneName,\n    isPhotoevidence,\n    recommendedHours,\n    isDeleteRequest,\n    fromDate,\n    toDate,\n    status,\n    index,\n    custom_index\n  }) => {\n    console.log({\n      index,\n      custom_index\n    });\n    return /*#__PURE__*/_jsxDEV(Draggable, {\n      draggableId: `${milestoneName}-${index}`,\n      index: index,\n      isDragDisabled: ![0, 4, 5, -1].includes(status) ? true : false,\n      children: (provided, snapshot) => /*#__PURE__*/_jsxDEV(\"li\", {\n        className: ![0, 4, 5, -1].includes(status) ? 'disable_milstone' : '',\n        ref: provided.innerRef,\n        ...provided.draggableProps,\n        ...provided.dragHandleProps,\n        style: { ...provided.draggableProps.style\n        },\n        children: [editItem[index] ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"edit_delete\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            onClick: e => {\n              e.preventDefault();\n              console.log({\n                index\n              });\n              setItemData(prev => ({ ...prev,\n                edit: true,\n                editId: index,\n                deleteId: ''\n              }));\n            },\n            className: \"edit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 423,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            onClick: e => {\n              e.preventDefault();\n              setItemData(prev => ({ ...prev,\n                editId: '',\n                deleteId: index\n              }));\n            },\n            className: \"delete\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 436,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 422,\n          columnNumber: 29\n        }, this) : '', /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"checkbox_wrap agree_check\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            checked: editItem[index],\n            onClick: e => {\n              if ([0, 4, 5, -1].includes(status)) {\n                checkOnClick(e, index);\n              } else {\n                e.preventDefault();\n              }\n            },\n            className: \"filter-type filled-in\",\n            type: \"checkbox\",\n            id: `milestone${index}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 449,\n            columnNumber: 29\n          }, this), console.log({\n            custom_index,\n            index\n          }), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: `milestone${index}`,\n            children: `${custom_index}. ${milestoneName}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 465,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"info\",\n            children: [isPhotoevidence ? /*#__PURE__*/_jsxDEV(\"span\", {\n              children: 'Photo evidence required'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 468,\n              columnNumber: 37\n            }, this) : /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 469,\n              columnNumber: 39\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: renderTimeIfExist(fromDate, toDate)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 470,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: recommendedHours\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 473,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 466,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 448,\n          columnNumber: 25\n        }, this)]\n      }, index, true, {\n        fileName: _jsxFileName,\n        lineNumber: 412,\n        columnNumber: 21\n      }, this)\n    }, `${index}-${milestoneName}`, false, {\n      fileName: _jsxFileName,\n      lineNumber: 405,\n      columnNumber: 13\n    }, this);\n  };\n\n  console.log({\n    stateItems\n  }, '------>><<-----');\n  const stateItemsEdit = stateItems.filter(item => (item === null || item === void 0 ? void 0 : item.isDeleteRequest) == false);\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Dialog, {\n      open: toggleItem // onClose={handleClose}\n      ,\n      \"aria-labelledby\": \"alert-dialog-title\",\n      \"aria-describedby\": \"alert-dialog-description\",\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        id: \"alert-dialog-title\",\n        className: \"xs_alert_dialog_title\",\n        children: 'Heads Up'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 497,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n        children: /*#__PURE__*/_jsxDEV(DialogContentText, {\n          children: 'If you go back, you will lose all your changes.'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 501,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 500,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => {\n            setToggleItem(prev => !prev);\n          },\n          color: \"primary\",\n          children: 'Yes'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 506,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => {\n            setToggleItem(prev => !prev);\n            props.backTab('edit');\n          },\n          color: \"primary\",\n          autoFocus: true,\n          children: 'No'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 513,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 505,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 491,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: (itemData === null || itemData === void 0 ? void 0 : itemData.deleteId) !== '' ? true : false,\n      onClose: resetItems,\n      \"aria-labelledby\": \"alert-dialog-title\",\n      \"aria-describedby\": \"alert-dialog-description\",\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        id: \"alert-dialog-title\",\n        children: \"Are you sure you want to delete the milestone ?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 530,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => {\n            removeMilestoneByIndex(itemData === null || itemData === void 0 ? void 0 : itemData.deleteId);\n          },\n          color: \"primary\",\n          autoFocus: true,\n          children: 'Yes'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 534,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => {\n            resetItems();\n          },\n          color: \"primary\",\n          children: 'No'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 541,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 533,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 524,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex_row\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex_col_sm_8\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relate\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => {\n              if (checkIfChange()) {\n                setToggleItem(prev => !prev);\n                return;\n              }\n\n              props.backTab('edit');\n            },\n            className: \"back\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 554,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"xs_sub_title\",\n            children: jobName || ''\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 563,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 553,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"sub_title\",\n          children: 'Change Request'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 567,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"commn_para\",\n          children: 'You can add/remove/change a milestones here. The changes will be sent to the tradesperson to accept before being implemented'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 570,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 552,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 551,\n      columnNumber: 13\n    }, this), console.log({\n      stateItems,\n      stateItemsEdit\n    }), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex_row\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex_col_sm_7\",\n        children: [/*#__PURE__*/_jsxDEV(DragDropContext, {\n          onDragEnd: onDragEnd,\n          children: /*#__PURE__*/_jsxDEV(Droppable, {\n            droppableId: \"milestones\",\n            children: (provided, snapshot) => /*#__PURE__*/_jsxDEV(\"ul\", {\n              ref: provided.innerRef,\n              className: `milestones${snapshot.isDraggingOver ? ' dragging-over' : ''}`,\n              children: [(stateItems === null || stateItems === void 0 ? void 0 : stateItems.length) > 0 && stateItems.map(({\n                milestoneName,\n                isPhotoevidence,\n                recommendedHours,\n                isDeleteRequest,\n                fromDate,\n                toDate,\n                status,\n                count\n              }, index) => !!isDeleteRequest == false && customRenderElements({\n                milestoneName,\n                isPhotoevidence,\n                recommendedHours,\n                isDeleteRequest,\n                fromDate,\n                toDate,\n                status,\n                index,\n                custom_index: count\n              })), provided.placeholder, (stateItems === null || stateItems === void 0 ? void 0 : stateItems.length) === 0 && /*#__PURE__*/_jsxDEV(\"figure\", {\n                className: \"placeholder_img\",\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: milestonesPlaceholder,\n                  alt: \"milestones-placeholder\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 616,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 615,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 581,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 579,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 578,\n          columnNumber: 21\n        }, this), !(stateItems === null || stateItems === void 0 ? void 0 : stateItems.length) ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form_field\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"fill_btn full_btn btn-effect\",\n              onClick: () => {\n                setItemData({\n                  add: true,\n                  editId: '',\n                  edit: false,\n                  deleteId: ''\n                }); // handleStepComplete({})\n              },\n              children: '+ Add milestone'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 629,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 628,\n            columnNumber: 29\n          }, this)\n        }, void 0, false) : /*#__PURE__*/_jsxDEV(React.Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form_field\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"fill_btn fill_grey_btn full_btn btn-effect\",\n              onClick: () => {\n                setItemData({\n                  add: true,\n                  editId: '',\n                  edit: false,\n                  deleteId: ''\n                }); // handleStepComplete({})\n              },\n              children: '+ Add milestone'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 642,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 641,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form_field\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                let checkIfItem = checkIfDatesValid();\n                console.log({\n                  checkIfItem\n                });\n\n                if (!checkIfItem) {\n                  let check = checkIfValidDates(stateItems);\n                  console.log({\n                    check\n                  });\n\n                  if (check) {\n                    submitData();\n                  } else {\n                    setShowToast(true, \"Please arrange milestone date wise\");\n                  }\n                }\n              } // className={`fill_btn full_btn btn-effect`}>\n              ,\n              className: `fill_btn full_btn btn-effect ${checkIfChange() ? 'disable_btn' : ''}`,\n              children: 'Send to tradesperson'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 652,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 651,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 640,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 577,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 576,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 489,\n    columnNumber: 9\n  }, this);\n};\n\n_s(EditMilestone, \"IMG7dJGuGBcnXEjthi0ubyKKh9E=\");\n\n_c = EditMilestone;\nexport default _c2 = withRouter(EditMilestone);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"EditMilestone\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/home/appinventiv/Documents/Project/tickt/web/src/pages/builderJobDasboard/components/editMilestones/index.tsx"],"names":["React","useState","useEffect","DragDropContext","Droppable","Draggable","renderTimeWithCustomFormat","milestonesPlaceholder","moment","setShowToast","Button","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","moengage","mixPanel","MoEConstants","changeRequest","AddEditMile","withRouter","EditMilestone","props","item","jobName","details","milestones","jobDetail","Object","freeze","stateData","setStateData","stateItems","setItems","editItem","setEditItems","deleteItem","setDeleteItem","itemData","setItemData","add","edit","editId","deleteId","sortedItems","setSortedItems","toggleItem","setToggleItem","description","setDescription","length","filtered","map","index","reorder","list","source","destination","startIndex","endIndex","findItem","find","lt","console","log","includes","status","result","Array","from","removed","splice","prev","onDragEnd","reOrderItems","checkIfValidDates","isfilter","filter","item_","hasOwnProperty","fromDate","isValid","startOf","toDate","newarr","sort","a","b","start_a","end_a","start_b","end_b","filteredItem","item_reorder","JSON","stringify","checkIfDatesValid","data","start_selection","end_selection","isSame","item_find","forEach","item_date","start","end","isAfter","isSameOrAfter","isSameOrBefore","checkOnClick","e","edit_item_clone","target","checked","resetItems","addNewMile","state_data","parseInt","prev_count","count","isPhotoevidence","milestoneName","recommendedHours","order","toISOString","isDeleteRequest","removeMilestoneByIndex","concat","Items","checkIfChange","isTrue","dt","submitData","description_string","deletedItems","uniqueValues","milestoneId","undefined","push","filteredItems","format","to_date","jobId","tradieId","Set","response","success","moE_SendEvent","EDIT_MILESTONES","timeStamp","getCurrentTimeStamp","mixP_SendEvent","history","renderTimeIfExist","time","customRenderElements","custom_index","provided","snapshot","innerRef","draggableProps","dragHandleProps","style","preventDefault","stateItemsEdit","backTab","isDraggingOver","placeholder","checkIfItem","check"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\n// @ts-ignore\nimport { DragDropContext, Droppable, Draggable, DropResult } from 'react-beautiful-dnd';\nimport { renderTimeWithCustomFormat } from '../../../../utils/common';\nimport milestonesPlaceholder from '../../../../assets/images/Job milestones-preview.png';\nimport moment from 'moment';\nimport { setShowToast } from '../../../../redux/common/actions';\n\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport { moengage, mixPanel } from '../../../../services/analyticsTools';\nimport { MoEConstants } from '../../../../utils/constants';\nimport { changeRequest } from '../../../../redux/jobs/actions';\n\nimport AddEditMile from './addEditMile';\n\nimport { withRouter } from 'react-router-dom';\n\nconst EditMilestone = (props: any) => {\n    const { item, item: { jobName }, details: { milestones } } = props;\n    const jobDetail: any = Object.freeze(props?.details);\n    const [stateData, setStateData] = useState<any>([]);\n    const [stateItems, setItems] = useState<any>([]);\n    const [editItem, setEditItems] = useState<{ [index: string]: any }>({});\n    const [deleteItem, setDeleteItem] = React.useState(null);\n    const [itemData, setItemData] = useState({ add: false, edit: false, editId: '', deleteId: '' });\n    const [sortedItems, setSortedItems] = React.useState([]);\n    const [toggleItem, setToggleItem] = useState(false);\n\n    const [description, setDescription] = useState<any>([]);\n\n\n    useEffect(() => {\n        if (!stateData?.length) {\n            let filtered = milestones.map((item: any, index: any) => {\n                item['count'] = index + 1;\n                return item;\n            })\n            setStateData(filtered);\n            setItems(filtered);\n        }\n    }, [])\n\n    const reorder = (list: Array<any>, source: any, destination: any) => {\n        let startIndex = source.index;\n        let endIndex = destination.index;\n\n        let findItem = list.find((lt: any, index: any) => index === endIndex);\n        console.log({ findItem, list, destination, endIndex })\n        if (findItem) {\n            if ([1, 2].includes(findItem.status)) {\n                return list;\n            }\n        }\n\n        const result = Array.from(list);\n        const [removed] = result.splice(startIndex, 1);\n        result.splice(endIndex, 0, removed);\n        console.log({ result })\n        setDescription((prev: any) => ([\n            ...prev,\n            ...['Milestones are rearranged.']\n        ]));\n        return result;\n    };\n\n    const onDragEnd = (result: DropResult) => {\n        const { source, destination } = result;\n        // dropped outside the list\n        if (!destination) {\n            return;\n        }\n\n        // if (source.droppableId === destination.droppableId) {\n        const reOrderItems = reorder(\n            stateItems,\n            source,\n            destination\n        );\n        setItems((prev: any) => (reOrderItems));\n    };\n\n    const checkIfValidDates = (item: any) => {\n\n        let isfilter = stateItems.filter((item_: any) => {\n            if (item_.hasOwnProperty('fromDate')) {\n                if (moment(item_?.fromDate).isValid()) {\n                    item_['fromDate'] = moment(item_.fromDate).startOf('day').toDate()\n                    item_['toDate'] = item_.toDate === '' ? moment(item_.fromDate).startOf('day').toDate() : moment(item_.toDate).startOf('day').toDate()\n                    return item_;\n                }\n            }\n        });\n\n        if (!isfilter?.length) {\n            return true;\n        } else {\n            const newarr: any = isfilter.sort((a: any, b: any) => {\n                let start_a = a.fromDate;\n                let end_a = a.toDate;\n\n                let start_b = b.fromDate;\n                let end_b = b.toDate;\n\n\n                if (start_a === start_b) {\n                    return end_a - end_b;\n                }\n                return start_a - start_b;\n            });\n\n            let filteredItem: any = item.filter((item_reorder: any) => {\n                if (item_reorder.hasOwnProperty('fromDate')) {\n                    if (moment(item_reorder?.fromDate).isValid()) {\n                        return item_reorder;\n                    }\n                }\n            });\n            setSortedItems(newarr);\n            console.log({ newarr, filteredItem });\n            return JSON.stringify(newarr) === JSON.stringify(filteredItem);\n        }\n    }\n\n\n    const checkIfDatesValid = () => {\n        let data = item;\n\n        let start_selection: any = data?.fromDate;\n        let end_selection: any = null;\n        if (moment(data?.toDate).isValid()) {\n            if (!moment(data?.toDate).isSame(moment(data?.fromDate))) {\n                end_selection = data?.toDate;\n            }\n        }\n\n        let item_find: any = false;\n        let filteredItem = stateItems;\n\n        if (filteredItem?.length) {\n            filteredItem.forEach((item_date: any) => {\n                if (item_date.fromDate) {\n                    let start: any = moment(item_date.fromDate).isValid() ? item_date.fromDate : null;\n                    let end: any = moment(item_date.toDate).isValid() ? item_date.toDate : null;\n\n                    if (start && !end) {\n                        if (moment(start_selection).isAfter(moment(start))) {\n                            item_find = true; // true;\n                        }\n                    }\n\n                    if (start_selection && end_selection && !end) {\n                        if (moment(start).isSameOrAfter(moment(start_selection)) && moment(start).isSameOrBefore(moment(end_selection))) {\n                            item_find = false;\n                        } else {\n                            item_find = true\n                        }\n                    }\n                }\n            });\n        }\n\n        if (item_find) {\n            setShowToast(true, 'Please check the milestone dates');\n            return item_find;\n        }\n\n        return item_find;\n    }\n\n    const checkOnClick = (e: any, index: any) => {\n        let edit_item_clone: any = editItem;\n        edit_item_clone[index] = e.target.checked;\n        setEditItems((prev) => ({ ...prev, ...edit_item_clone }));\n    }\n\n    const resetItems = () => {\n        setItemData((prev: any) => ({ ...prev, add: false, edit: false, editId: '', deleteId: '' }));\n        setEditItems({});\n    }\n\n    const addNewMile = (item: any) => {\n        let state_data: any = stateItems;\n        if (itemData?.edit) { // edit\n            let index = parseInt(itemData.editId);\n            let prev_count = null;\n\n            if (state_data?.length > 1 && index > 0) {\n                prev_count = state_data[index - 1].count + 1;\n            } else {\n                prev_count = state_data[index].count;\n            }\n\n            console.log({ item, prev_count }, '---->')\n            state_data[itemData.editId]['isPhotoevidence'] = item.isPhotoevidence;\n            state_data[itemData.editId]['milestoneName'] = item.milestoneName;\n            state_data[itemData.editId]['recommendedHours'] = item.recommendedHours;\n            state_data[itemData.editId]['description'] = item.description;\n            state_data[itemData.editId]['status'] = item.status;\n            state_data[itemData.editId]['order'] = item.order;\n\n\n            state_data[index]['count'] = prev_count;\n\n\n            state_data[index]['fromDate'] = moment(item.fromDate).isValid() ? moment(item.fromDate).toISOString() : '';\n            state_data[index]['toDate'] = moment(item.toDate).isValid() ? moment(item.toDate).toISOString() : '';\n            // setStateData(state_data);\n            setItems(state_data)\n        } else {\n            item['count'] = state_data?.length + 1;\n            setItems((prev: any) => ([...prev, item]));\n            // setStateData((prev: any) => ([...prev, item]));\n        }\n    }\n\n    if (itemData?.add || itemData?.edit) {\n        let filtered = stateData.filter((item: any) => {\n            if (!item?.isDeleteRequest) {\n                return item;\n            }\n        })\n        return (\n            <AddEditMile\n                item={item}\n                milestones={stateItems}\n                // filtered={filtered}\n                jobDetail={jobDetail}\n                isSame={JSON.stringify(filtered) === JSON.stringify(stateData)}\n                editMile={itemData.editId}\n                addNewMile={addNewMile}\n                resetItems={resetItems}\n            />\n        )\n    }\n\n    const removeMilestoneByIndex = (index: any) => {\n        let state_data: any = stateItems;\n        state_data[index]['isDeleteRequest'] = true;\n        let count = 0;\n        if (state_data?.length) {\n            let filtered = state_data.map((item: any) => {\n                if (!item?.isDeleteRequest) {\n                    count++;\n                    item['count'] = count;\n                }\n                return item;\n            });\n            setStateData(filtered.concat(stateItems));\n\n            let Items = filtered.filter((item: any) => {\n                if (!item?.isDeleteRequest) {\n                    return item;\n                }\n            })\n\n            resetItems();\n            // removed length check to update the items.\n            // if (Items?.length) {\n            setItems(Items)\n            // }\n        }\n    }\n\n    const checkIfChange = () => {\n        let isTrue = true;\n        if (!stateItems?.length) {\n            isTrue = false;\n        } else {\n            stateItems?.forEach((dt: any) => {\n                if (dt?.description?.length) {\n                    isTrue = false;\n                }\n            });\n\n            stateData?.forEach((dt: any) => {\n                if (dt?.isDeleteRequest) {\n                    isTrue = false;\n                }\n            });\n        }\n        return isTrue;\n    }\n\n    const submitData = async () => {\n        let description_string = description;\n\n\n        let deletedItems: any = [];\n        let uniqueValues: any = {};\n        stateData.forEach((item: any) => {\n            if (item?.isDeleteRequest) {\n                if (item?.milestoneId) {\n                    if (uniqueValues[item?.milestoneId] == undefined) {\n                        uniqueValues[item?.milestoneId] = 1;\n                        deletedItems.push(item);\n                    }\n                }\n                //  else {\n                //     deletedItems.push(item);\n                // }\n            }\n        });\n\n        let filteredItems: any = deletedItems.concat(stateItems);\n\n        console.log({\n            deletedItems,\n            filteredItems\n        });\n\n        let filtered = filteredItems.map((item: any, index: any) => {\n            let data: any = {\n                \"milestoneId\": item?.milestoneId || '',\n                \"milestone_name\": item?.milestoneName,\n                \"isPhotoevidence\": item?.isPhotoevidence,\n                \"from_date\": moment(item?.fromDate).isValid() ? moment(item?.fromDate).format(\"YYYY-MM-DD\") : '',\n                \"to_date\": moment(item?.toDate).isValid() ? moment(item?.toDate).format(\"YYYY-MM-DD\") : '',\n                \"recommended_hours\": item?.recommendedHours,\n                \"description\": item?.description,\n                \"status\": item?.status,\n            }\n\n            if (item.description?.length) {\n                description_string.push(item.description);\n            }\n\n            if (!data?.to_date?.length) {\n                delete data.to_date;\n            }\n\n            if (item?.isDeleteRequest && item?.status > -1) {\n                data['isDeleteRequest'] = true;\n                data['description'] = `${item?.milestoneName} was deleted.`;\n                description_string.push(`${item?.milestoneName} was deleted.`);\n            }\n\n            if (!item?.milestoneId) {\n                delete data.milestoneId;\n            }\n            data['order'] = index + 1;\n            return data;\n        }).filter((item: any) => {\n\n            if (![1, 2, 3].includes(item?.status)) {\n                delete item.status;\n\n                if (item?.description?.length) {\n                    delete item.description;\n                }\n\n                return item;\n            }\n\n        });\n\n        let data = {\n            \"jobId\": item.jobId,\n            \"tradieId\": props?.details?.tradieId,\n            \"milestones\": filtered,\n            \"description\": Array.from(new Set(description_string))\n        };\n\n        console.log({ data })\n\n        let response: any = await changeRequest(data);\n        if (response?.success) {\n            moengage.moE_SendEvent(MoEConstants.EDIT_MILESTONES, { timeStamp: moengage.getCurrentTimeStamp() });\n            mixPanel.mixP_SendEvent(MoEConstants.EDIT_MILESTONES, { timeStamp: moengage.getCurrentTimeStamp() });\n            props.history.push('/milestone-request-sent-success');\n        }\n    }\n\n    const renderTimeIfExist = (fromDate: string, toDate: string) => {\n        const time = renderTimeWithCustomFormat(\n            fromDate,\n            moment(fromDate).isSame(moment(toDate)) ? '' : toDate,\n            '',\n            ['DD MMM', 'DD MMM YY']\n        )\n        return time === 'Choose' ? '' : time;\n    }\n\n\n    const customRenderElements = ({\n        milestoneName,\n        isPhotoevidence,\n        recommendedHours,\n        isDeleteRequest,\n        fromDate,\n        toDate,\n        status,\n        index,\n        custom_index\n    }: any) => {\n        console.log({\n            index,\n            custom_index\n        })\n        return (\n            <Draggable\n                key={`${index}-${milestoneName}`}\n                draggableId={`${milestoneName}-${index}`}\n                index={index}\n                isDragDisabled={![0, 4, 5, -1].includes(status) ? true : false}\n            >\n                {(provided: any, snapshot: any) => (\n                    <li\n                        key={index}\n                        className={![0, 4, 5, -1].includes(status) ? 'disable_milstone' : ''}\n                        ref={provided.innerRef}\n                        {...provided.draggableProps}\n                        {...provided.dragHandleProps}\n                        style={{\n                            ...provided.draggableProps.style,\n                        }}>\n                        {editItem[index] ? (\n                            <div className=\"edit_delete\">\n                                <span\n                                    onClick={(e) => {\n                                        e.preventDefault();\n                                        console.log({ index })\n                                        setItemData((prev: any) => ({\n                                            ...prev,\n                                            edit: true,\n                                            editId: index,\n                                            deleteId: ''\n                                        }));\n                                    }}\n                                    className=\"edit\">\n                                </span>\n                                <span\n                                    onClick={(e) => {\n                                        e.preventDefault();\n                                        setItemData((prev: any) => ({\n                                            ...prev,\n                                            editId: '',\n                                            deleteId: index\n                                        }));\n                                    }}\n                                    className=\"delete\"></span>\n                            </div>\n                        ) : ''}\n                        <div className=\"checkbox_wrap agree_check\">\n                            <input\n                                checked={editItem[index]}\n                                onClick={(e: any) => {\n                                    if ([0, 4, 5, -1].includes(status)) {\n                                        checkOnClick(e, index)\n                                    } else {\n                                        e.preventDefault();\n                                    }\n                                }}\n                                className=\"filter-type filled-in\"\n                                type=\"checkbox\"\n                                id={`milestone${index}`} />\n                            {console.log({\n                                custom_index,\n                                index\n                            })}\n                            <label htmlFor={`milestone${index}`}>{`${custom_index}. ${milestoneName}`}</label>\n                            <div className=\"info\">\n                                {isPhotoevidence ?\n                                    <span>{'Photo evidence required'}</span>\n                                    : <span></span>}\n                                <span>\n                                    {renderTimeIfExist(fromDate, toDate)}\n                                </span>\n                                <span>\n                                    {recommendedHours}\n                                </span>\n                            </div>\n                        </div>\n                    </li>\n                )}\n            </Draggable>\n        )\n    }\n    console.log({\n        stateItems\n    }, '------>><<-----')\n\n    const stateItemsEdit = stateItems.filter((item: any) => item?.isDeleteRequest == false);\n    return (\n        <React.Fragment>\n\n            <Dialog\n                open={toggleItem}\n                // onClose={handleClose}\n                aria-labelledby=\"alert-dialog-title\"\n                aria-describedby=\"alert-dialog-description\"\n            >\n                <DialogTitle id=\"alert-dialog-title\" className=\"xs_alert_dialog_title\">\n                    {'Heads Up'}\n                </DialogTitle>\n                <DialogContent>\n                    <DialogContentText>\n                        {'If you go back, you will lose all your changes.'}\n                    </DialogContentText>\n                </DialogContent>\n                <DialogActions>\n                    <Button\n                        onClick={() => {\n                            setToggleItem((prev: any) => !prev);\n                        }}\n                        color=\"primary\">\n                        {'Yes'}\n                    </Button>\n                    <Button\n                        onClick={() => {\n                            setToggleItem((prev: any) => !prev);\n                            props.backTab('edit');\n                        }}\n                        color=\"primary\" autoFocus>\n                        {'No'}\n                    </Button>\n                </DialogActions>\n            </Dialog>\n\n            <Dialog\n                open={itemData?.deleteId !== '' ? true : false}\n                onClose={resetItems}\n                aria-labelledby=\"alert-dialog-title\"\n                aria-describedby=\"alert-dialog-description\"\n            >\n                <DialogTitle id=\"alert-dialog-title\">\n                    {\"Are you sure you want to delete the milestone ?\"}\n                </DialogTitle>\n                <DialogActions>\n                    <Button\n                        onClick={() => {\n                            removeMilestoneByIndex(itemData?.deleteId);\n                        }}\n                        color=\"primary\" autoFocus>\n                        {'Yes'}\n                    </Button>\n                    <Button\n                        onClick={() => {\n                            resetItems()\n                        }}\n                        color=\"primary\">\n                        {'No'}\n                    </Button>\n                </DialogActions>\n            </Dialog>\n\n            <div className=\"flex_row\">\n                <div className=\"flex_col_sm_8\">\n                    <div className=\"relate\">\n                        <button\n                            onClick={() => {\n                                if (checkIfChange()) {\n                                    setToggleItem((prev: any) => !prev);\n                                    return\n                                }\n                                props.backTab('edit');\n                            }}\n                            className=\"back\"></button>\n                        <span className=\"xs_sub_title\">\n                            {jobName || ''}\n                        </span>\n                    </div>\n                    <span className=\"sub_title\">\n                        {'Change Request'}\n                    </span>\n                    <p className=\"commn_para\">\n                        {'You can add/remove/change a milestones here. The changes will be sent to the tradesperson to accept before being implemented'}\n                    </p>\n                </div>\n            </div>\n            {console.log({ stateItems, stateItemsEdit })}\n            <div className=\"flex_row\">\n                <div className=\"flex_col_sm_7\">\n                    <DragDropContext onDragEnd={onDragEnd}>\n                        <Droppable droppableId=\"milestones\">\n                            {(provided, snapshot) => (\n                                <ul ref={provided.innerRef}\n                                    className={`milestones${snapshot.isDraggingOver ? ' dragging-over' : ''}`}>\n                                    {stateItems?.length > 0 &&\n                                        stateItems.map(({\n                                            milestoneName,\n                                            isPhotoevidence,\n                                            recommendedHours,\n                                            isDeleteRequest,\n                                            fromDate,\n                                            toDate,\n                                            status,\n                                            count\n                                        }: {\n                                            milestoneName: string,\n                                            isPhotoevidence: boolean,\n                                            fromDate: string,\n                                            toDate: string,\n                                            status: number\n                                            recommendedHours: any,\n                                            isDeleteRequest?: boolean,\n                                            count?: any\n                                        }, index: any) => !!isDeleteRequest == false && (customRenderElements({\n                                            milestoneName,\n                                            isPhotoevidence,\n                                            recommendedHours,\n                                            isDeleteRequest,\n                                            fromDate,\n                                            toDate,\n                                            status,\n                                            index,\n                                            custom_index: count\n                                        })))}\n                                    {provided.placeholder}\n                                    {stateItems?.length === 0 && (\n                                        <figure className=\"placeholder_img\">\n                                            <img\n                                                src={milestonesPlaceholder}\n                                                alt=\"milestones-placeholder\"\n                                            />\n                                        </figure>\n                                    )}\n                                </ul>\n                            )}\n                        </Droppable>\n                    </DragDropContext>\n                    {!stateItems?.length ? (\n                        <>\n                            <div className=\"form_field\">\n                                <button\n                                    className=\"fill_btn full_btn btn-effect\"\n                                    onClick={() => {\n                                        setItemData({ add: true, editId: '', edit: false, deleteId: '' });\n                                        // handleStepComplete({})\n                                    }}>\n                                    {'+ Add milestone'}\n                                </button>\n                            </div>\n                        </>\n                    ) : (\n                        <React.Fragment>\n                            <div className=\"form_field\">\n                                <button className=\"fill_btn fill_grey_btn full_btn btn-effect\"\n                                    onClick={() => {\n                                        setItemData({ add: true, editId: '', edit: false, deleteId: '' });\n                                        // handleStepComplete({})\n                                    }}>\n                                    {'+ Add milestone'}\n                                </button>\n                            </div>\n\n                            <div className=\"form_field\">\n                                <button\n                                    onClick={() => {\n                                        let checkIfItem: boolean = checkIfDatesValid();\n                                        console.log({ checkIfItem })\n                                        if (!checkIfItem) {\n                                            let check: boolean = checkIfValidDates(stateItems);\n                                            console.log({ check })\n                                            if (check) {\n                                                submitData()\n                                            } else {\n                                                setShowToast(true, \"Please arrange milestone date wise\")\n                                            }\n                                        }\n                                    }}\n                                    // className={`fill_btn full_btn btn-effect`}>\n                                    className={`fill_btn full_btn btn-effect ${checkIfChange() ? 'disable_btn' : ''}`}>\n                                    {'Send to tradesperson'}\n                                </button>\n                            </div>\n                        </React.Fragment>\n                    )}\n                </div>\n            </div>\n        </React.Fragment >\n\n    )\n}\n\nexport default withRouter(EditMilestone);"]},"metadata":{},"sourceType":"module"}