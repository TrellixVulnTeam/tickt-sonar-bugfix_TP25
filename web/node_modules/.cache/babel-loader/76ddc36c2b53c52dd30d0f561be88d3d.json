{"ast":null,"code":"import _regeneratorRuntime from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState}from\"react\";import moment from\"moment\";// @ts-ignore\nimport ReactStars from\"react-rating-stars-component\";import{ratingTradieProfile}from\"../../../../redux/jobs/actions\";import{setShowToast}from\"../../../../redux/common/actions\";import dummy from\"../../../../assets/images/u_placeholder.jpg\";import more from\"../../../../assets/images/icon-direction-right.png\";import{withRouter}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var RateThisJob=function RateThisJob(props){var _data$jobData,_data$jobData2,_data$jobData3,_data$jobData4,_data$tradieData,_data$tradieData2,_data$tradieData3,_data$tradieData4;var _useState=useState({startDate:\"\",endDate:\"\",rating:0,review:\"\"}),_useState2=_slicedToArray(_useState,2),reviewBuilderData=_useState2[0],setReviewBuilderData=_useState2[1];var data=props===null||props===void 0?void 0:props.data;var ratingChanged=function ratingChanged(newRating){console.log(newRating);setReviewBuilderData(function(prevdata){return _objectSpread(_objectSpread({},prevdata),{},{rating:newRating});});};var handleChange=function handleChange(e){if(e.target.value.trim().length<=1000){setReviewBuilderData(function(prevdata){return _objectSpread(_objectSpread({},prevdata),{},{review:e.target.value});});}};var startDate=moment(data===null||data===void 0?void 0:data.fromDate).format(\"MMM DD\");var endDate=moment(data===null||data===void 0?void 0:data.toDate).format(\"MMM DD\");var submitReviewClicked=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var dataItem,_reviewBuilderData$re,response,_props$history;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(reviewBuilderData.rating===0)){_context.next=3;break;}setShowToast(true,\"Star rating is required\");return _context.abrupt(\"return\");case 3:if(reviewBuilderData.review.trim().length<1){// setShowToast(true, 'Comment is required');\n// return;\n}// if (reviewBuilderData.review.trim().length > 1 && reviewBuilderData.rating > 0) {\nif(!(reviewBuilderData.rating>0)){_context.next=11;break;}dataItem={jobId:data===null||data===void 0?void 0:data.jobId,tradieId:data===null||data===void 0?void 0:data.tradieId,rating:reviewBuilderData.rating};if(reviewBuilderData.review.trim().length>1){dataItem[\"review\"]=(reviewBuilderData===null||reviewBuilderData===void 0?void 0:(_reviewBuilderData$re=reviewBuilderData.review)===null||_reviewBuilderData$re===void 0?void 0:_reviewBuilderData$re.length)?reviewBuilderData.review.trim():\"\";}_context.next=9;return ratingTradieProfile(dataItem);case 9:response=_context.sent;if(response===null||response===void 0?void 0:response.success){props===null||props===void 0?void 0:(_props$history=props.history)===null||_props$history===void 0?void 0:_props$history.push(\"/rate-success\");}case 11:case\"end\":return _context.stop();}}},_callee);}));return function submitReviewClicked(){return _ref.apply(this,arguments);};}();var jobClickHandler=function jobClickHandler(_ref2){var jobId=_ref2.jobId,data=_ref2.data;// let urlEncode: any = window.btoa(`?jobId=${jobId}`)\nconsole.log({data:data},\"----- data----- data\");if(data===null||data===void 0?void 0:data.status){var urlEncode=\"?jobId=\".concat(jobId,\"&status=\").concat(data===null||data===void 0?void 0:data.status,\"&job=past&activeType=past\");props.history.push(\"/job-detail?\".concat(urlEncode));}};var tradieClicked=function tradieClicked(_ref3){var tradieId=_ref3.tradieId,jobId=_ref3.jobId;console.log({props:props});props.history.push(\"/tradie-info?tradeId=\".concat(tradieId,\"&jobId=\").concat(jobId));};var renderTime=function renderTime(_ref4){var fromDate=_ref4.fromDate,toDate=_ref4.toDate;if(moment(fromDate).isValid()&&!moment(toDate).isValid()){return\"\".concat(moment(fromDate).format(\"DD MMM\"));}if(moment(fromDate).isValid()&&moment(toDate).isValid()){var yearEnd=moment().endOf(\"year\").toISOString();var monthEnd=moment(fromDate).endOf(\"month\").toISOString();var item=moment(toDate).diff(moment(fromDate),\"months\",true);var item_year=moment(toDate).diff(moment(fromDate),\"years\",true);var monthDiff=parseInt(item.toString());var yearDiff=parseInt(item_year.toString());if(yearDiff>0||moment(toDate).isAfter(yearEnd)||moment(toDate).isAfter(yearEnd)){return\"\".concat(moment(fromDate).format(\"DD MMM YY\"),\" - \").concat(moment(toDate).format(\"DD MMM YY\"));}if(monthDiff>0||moment(toDate).isAfter(monthEnd)){return\"\".concat(moment(fromDate).format(\"DD MMM\"),\" - \").concat(moment(toDate).format(\"DD MMM\"));}return\"\".concat(moment(fromDate).format(\"DD MMM\"),\" - \").concat(moment(toDate).format(\"DD\"));}};console.log({data:data});return/*#__PURE__*/_jsxs(\"div\",{className:\"flex_row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex_col_sm_6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form_field relate\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back\",onClick:function onClick(){props===null||props===void 0?void 0:props.backToScreen();}}),/*#__PURE__*/_jsx(\"span\",{className:\"xs_sub_title\",children:\"Review the tradesperson\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"inner_title\",children:\"Rate this tradesperson\"}),/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(ReactStars,{count:5,onChange:ratingChanged,size:55,isHalf:true,emptyIcon:/*#__PURE__*/_jsx(\"i\",{className:\"far fa-star\"}),halfIcon:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star-half-alt\"}),fullIcon:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star\"}),activeColor:\"#fee600\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"form_field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form_label\",children:\"Comment (optional)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text_field\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Thanks..\",maxLength:1000,onChange:handleChange})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(\"button\",{className:\"fill_btn full_btn btn-effect\",onClick:submitReviewClicked,children:\"Leave review\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex_col_sm_6 col_ruler\",children:[/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relate\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"sub_title\",children:\"Job details\"}),/*#__PURE__*/_jsx(\"span\",{className:\"edit_icon\",title:\"More\",onClick:function onClick(){jobClickHandler({jobId:data===null||data===void 0?void 0:data.jobId,data:data});},children:/*#__PURE__*/_jsx(\"img\",{src:more,alt:\"more\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"tradie_card posted_by \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"user_wrap\",children:[/*#__PURE__*/_jsx(\"figure\",{className:\"u_img\",children:/*#__PURE__*/_jsx(\"img\",{src:(data===null||data===void 0?void 0:(_data$jobData=data.jobData)===null||_data$jobData===void 0?void 0:_data$jobData.tradeSelectedUrl)||dummy,alt:\"traide-img\",onError:function onError(e){var _e$target,_e$target2;if(e===null||e===void 0?void 0:(_e$target=e.target)===null||_e$target===void 0?void 0:_e$target.onerror){e.target.onerror=null;}if(e===null||e===void 0?void 0:(_e$target2=e.target)===null||_e$target2===void 0?void 0:_e$target2.src){e.target.src=dummy;}}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"details\",onClick:function onClick(){jobClickHandler({jobId:data===null||data===void 0?void 0:data.jobId,data:data});},children:[/*#__PURE__*/_jsx(\"span\",{className:\"name\",children:data===null||data===void 0?void 0:(_data$jobData2=data.jobData)===null||_data$jobData2===void 0?void 0:_data$jobData2.tradeName}),/*#__PURE__*/_jsx(\"span\",{className:\"prof\",children:data===null||data===void 0?void 0:data.jobName}),/*#__PURE__*/_jsx(\"span\",{className:\"prof\",children:renderTime({fromDate:data===null||data===void 0?void 0:(_data$jobData3=data.jobData)===null||_data$jobData3===void 0?void 0:_data$jobData3.fromDate,toDate:data===null||data===void 0?void 0:(_data$jobData4=data.jobData)===null||_data$jobData4===void 0?void 0:_data$jobData4.toDate})})]})]})})]}),/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relate\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"sub_title\",children:\"Tradesperson\"}),/*#__PURE__*/_jsx(\"span\",{className:\"edit_icon\",title:\"More\",onClick:function onClick(){tradieClicked({jobId:data===null||data===void 0?void 0:data.jobId,tradieId:data===null||data===void 0?void 0:data.tradieId});},children:/*#__PURE__*/_jsx(\"img\",{src:more,alt:\"more\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"tradie_card posted_by \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"user_wrap\",children:[/*#__PURE__*/_jsx(\"figure\",{className:\"u_img\",children:/*#__PURE__*/_jsx(\"img\",{src:(data===null||data===void 0?void 0:(_data$tradieData=data.tradieData)===null||_data$tradieData===void 0?void 0:_data$tradieData.tradieImage)||dummy,alt:\"traide-img\",onError:function onError(e){var _e$target3,_e$target4;if(e===null||e===void 0?void 0:(_e$target3=e.target)===null||_e$target3===void 0?void 0:_e$target3.onerror){e.target.onerror=null;}if(e===null||e===void 0?void 0:(_e$target4=e.target)===null||_e$target4===void 0?void 0:_e$target4.src){e.target.src=dummy;}}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"details\",onClick:function onClick(){tradieClicked({jobId:data===null||data===void 0?void 0:data.jobId,tradieId:data===null||data===void 0?void 0:data.tradieId});},children:[/*#__PURE__*/_jsx(\"span\",{className:\"name\",children:data===null||data===void 0?void 0:(_data$tradieData2=data.tradieData)===null||_data$tradieData2===void 0?void 0:_data$tradieData2.tradieName}),/*#__PURE__*/_jsx(\"span\",{className:\"rating\",children:\"\".concat((data===null||data===void 0?void 0:(_data$tradieData3=data.tradieData)===null||_data$tradieData3===void 0?void 0:_data$tradieData3.ratings)||\"0\",\" | \").concat((data===null||data===void 0?void 0:(_data$tradieData4=data.tradieData)===null||_data$tradieData4===void 0?void 0:_data$tradieData4.reviews)||0,\" reviews\")})]})]})})]})]})]});};export default withRouter(RateThisJob);","map":{"version":3,"sources":["/home/appinventiv/Documents/Project/tickt/web/src/pages/builderJobDasboard/components/ratethisJob/index.tsx"],"names":["useState","moment","ReactStars","ratingTradieProfile","setShowToast","dummy","more","withRouter","RateThisJob","props","startDate","endDate","rating","review","reviewBuilderData","setReviewBuilderData","data","ratingChanged","newRating","console","log","prevdata","handleChange","e","target","value","trim","length","fromDate","format","toDate","submitReviewClicked","dataItem","jobId","tradieId","response","success","history","push","jobClickHandler","status","urlEncode","tradieClicked","renderTime","isValid","yearEnd","endOf","toISOString","monthEnd","item","diff","item_year","monthDiff","parseInt","toString","yearDiff","isAfter","backToScreen","jobData","tradeSelectedUrl","onerror","src","tradeName","jobName","tradieData","tradieImage","tradieName","ratings","reviews"],"mappings":"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","sourcesContent":["import { useState } from \"react\";\nimport moment from \"moment\";\n// @ts-ignore\nimport ReactStars from \"react-rating-stars-component\";\nimport { ratingTradieProfile } from \"../../../../redux/jobs/actions\";\nimport { setShowToast } from \"../../../../redux/common/actions\";\n\nimport dummy from \"../../../../assets/images/u_placeholder.jpg\";\nimport more from \"../../../../assets/images/icon-direction-right.png\";\nimport { withRouter } from \"react-router-dom\";\n\ninterface Proptypes {\n  history: any;\n  location: any;\n  data: any;\n  backToScreen: () => void;\n}\nconst RateThisJob = (props: any) => {\n  const [reviewBuilderData, setReviewBuilderData] = useState({\n    startDate: \"\",\n    endDate: \"\",\n    rating: 0,\n    review: \"\",\n  });\n\n  let data: any = props?.data;\n\n  const ratingChanged = (newRating: number) => {\n    console.log(newRating);\n    setReviewBuilderData((prevdata: any) => ({\n      ...prevdata,\n      rating: newRating,\n    }));\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.value.trim().length <= 1000) {\n      setReviewBuilderData((prevdata: any) => ({\n        ...prevdata,\n        review: e.target.value,\n      }));\n    }\n  };\n\n  const startDate = moment(data?.fromDate).format(\"MMM DD\");\n  const endDate = moment(data?.toDate).format(\"MMM DD\");\n\n  const submitReviewClicked = async () => {\n    if (reviewBuilderData.rating === 0) {\n      setShowToast(true, \"Star rating is required\");\n      return;\n    }\n    if (reviewBuilderData.review.trim().length < 1) {\n      // setShowToast(true, 'Comment is required');\n      // return;\n    }\n    // if (reviewBuilderData.review.trim().length > 1 && reviewBuilderData.rating > 0) {\n    if (reviewBuilderData.rating > 0) {\n      const dataItem: any = {\n        jobId: data?.jobId,\n        tradieId: data?.tradieId,\n        rating: reviewBuilderData.rating,\n      };\n\n      if (reviewBuilderData.review.trim().length > 1) {\n        dataItem[\"review\"] = reviewBuilderData?.review?.length\n          ? reviewBuilderData.review.trim()\n          : \"\";\n      }\n\n      const response = await ratingTradieProfile(dataItem);\n      if (response?.success) {\n        props?.history?.push(\"/rate-success\");\n      }\n    }\n  };\n\n  const jobClickHandler = ({ jobId, data }: any) => {\n    // let urlEncode: any = window.btoa(`?jobId=${jobId}`)\n    console.log({ data }, \"----- data----- data\");\n    if (data?.status) {\n      let urlEncode: any = `?jobId=${jobId}&status=${data?.status}&job=past&activeType=past`;\n      props.history.push(`/job-detail?${urlEncode}`);\n    }\n  };\n\n  const tradieClicked = ({ tradieId, jobId }: any) => {\n    console.log({ props });\n    props.history.push(`/tradie-info?tradeId=${tradieId}&jobId=${jobId}`);\n  };\n\n  const renderTime = ({ fromDate, toDate }: any) => {\n    if (moment(fromDate).isValid() && !moment(toDate).isValid()) {\n      return `${moment(fromDate).format(\"DD MMM\")}`;\n    }\n\n    if (moment(fromDate).isValid() && moment(toDate).isValid()) {\n      let yearEnd = moment().endOf(\"year\").toISOString();\n      let monthEnd = moment(fromDate).endOf(\"month\").toISOString();\n\n      let item: any = moment(toDate).diff(moment(fromDate), \"months\", true);\n      let item_year: any = moment(toDate).diff(moment(fromDate), \"years\", true);\n\n      let monthDiff = parseInt(item.toString());\n      let yearDiff = parseInt(item_year.toString());\n\n      if (\n        yearDiff > 0 ||\n        moment(toDate).isAfter(yearEnd) ||\n        moment(toDate).isAfter(yearEnd)\n      ) {\n        return `${moment(fromDate).format(\"DD MMM YY\")} - ${moment(\n          toDate\n        ).format(\"DD MMM YY\")}`;\n      }\n      if (monthDiff > 0 || moment(toDate).isAfter(monthEnd)) {\n        return `${moment(fromDate).format(\"DD MMM\")} - ${moment(toDate).format(\n          \"DD MMM\"\n        )}`;\n      }\n      return `${moment(fromDate).format(\"DD MMM\")} - ${moment(toDate).format(\n        \"DD\"\n      )}`;\n    }\n  };\n\n  console.log({ data });\n  return (\n    <div className=\"flex_row\">\n      <div className=\"flex_col_sm_6\">\n        <div className=\"form_field relate\">\n          <button\n            className=\"back\"\n            onClick={() => {\n              props?.backToScreen();\n            }}\n          ></button>\n          {/* <span className=\"xs_sub_title\">{item?.jobName}</span> */}\n          <span className=\"xs_sub_title\">Review the tradesperson</span>\n        </div>\n        <span className=\"inner_title\">{\"Rate this tradesperson\"}</span>\n        <div className=\"form_field\">\n          <ReactStars\n            count={5}\n            onChange={ratingChanged}\n            size={55}\n            isHalf={true}\n            emptyIcon={<i className=\"far fa-star\"></i>}\n            halfIcon={<i className=\"fa fa-star-half-alt\"></i>}\n            fullIcon={<i className=\"fa fa-star\"></i>}\n            activeColor=\"#fee600\"\n          />\n        </div>\n        <div className=\"form_field\">\n          <label className=\"form_label\">{\"Comment (optional)\"}</label>\n          <div className=\"text_field\">\n            <input\n              type=\"text\"\n              placeholder=\"Thanks..\"\n              maxLength={1000}\n              onChange={handleChange}\n            />\n          </div>\n        </div>\n        <div className=\"form_field\">\n          <button\n            className=\"fill_btn full_btn btn-effect\"\n            onClick={submitReviewClicked}\n          >\n            {\"Leave review\"}\n          </button>\n        </div>\n      </div>\n      <div className=\"flex_col_sm_6 col_ruler\">\n        <>\n          <div className=\"relate\">\n            <span className=\"sub_title\">{\"Job details\"}</span>\n            <span\n              className=\"edit_icon\"\n              title=\"More\"\n              onClick={() => {\n                jobClickHandler({ jobId: data?.jobId, data });\n              }}\n            >\n              <img src={more} alt=\"more\" />\n            </span>\n          </div>\n          <div className=\"tradie_card posted_by \">\n            <div className=\"user_wrap\">\n              <figure className=\"u_img\">\n                <img\n                  src={data?.jobData?.tradeSelectedUrl || dummy}\n                  alt=\"traide-img\"\n                  onError={(e: any) => {\n                    if (e?.target?.onerror) {\n                      e.target.onerror = null;\n                    }\n                    if (e?.target?.src) {\n                      e.target.src = dummy;\n                    }\n                  }}\n                />\n              </figure>\n              <div\n                className=\"details\"\n                onClick={() => {\n                  jobClickHandler({ jobId: data?.jobId, data });\n                }}\n              >\n                <span className=\"name\">{data?.jobData?.tradeName}</span>\n                <span className=\"prof\">{data?.jobName}</span>\n                <span className=\"prof\">\n                  {renderTime({\n                    fromDate: data?.jobData?.fromDate,\n                    toDate: data?.jobData?.toDate,\n                  })}\n                </span>\n              </div>\n            </div>\n          </div>\n        </>\n\n        <>\n          <div className=\"relate\">\n            <span className=\"sub_title\">{\"Tradesperson\"}</span>\n            <span\n              className=\"edit_icon\"\n              title=\"More\"\n              onClick={() => {\n                tradieClicked({\n                  jobId: data?.jobId,\n                  tradieId: data?.tradieId,\n                });\n              }}\n            >\n              <img src={more} alt=\"more\" />\n            </span>\n          </div>\n          <div className=\"tradie_card posted_by \">\n            <div className=\"user_wrap\">\n              <figure className=\"u_img\">\n                <img\n                  src={data?.tradieData?.tradieImage || dummy}\n                  alt=\"traide-img\"\n                  onError={(e: any) => {\n                    if (e?.target?.onerror) {\n                      e.target.onerror = null;\n                    }\n                    if (e?.target?.src) {\n                      e.target.src = dummy;\n                    }\n                  }}\n                />\n              </figure>\n              <div\n                className=\"details\"\n                onClick={() => {\n                  tradieClicked({\n                    jobId: data?.jobId,\n                    tradieId: data?.tradieId,\n                  });\n                }}\n              >\n                <span className=\"name\">{data?.tradieData?.tradieName}</span>\n                <span className=\"rating\">\n                  {`${data?.tradieData?.ratings || \"0\"} | ${\n                    data?.tradieData?.reviews || 0\n                  } reviews`}\n                </span>\n              </div>\n            </div>\n          </div>\n        </>\n      </div>\n    </div>\n  );\n};\n\nexport default withRouter(RateThisJob);\n"]},"metadata":{},"sourceType":"module"}