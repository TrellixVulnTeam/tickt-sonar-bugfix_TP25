{"ast":null,"code":"import _regeneratorRuntime from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/* eslint-disable jsx-a11y/anchor-is-valid */import{useState,useEffect}from'react';import{useLocation,withRouter,useHistory}from\"react-router-dom\";import Joyride from'react-joyride';import Modal from'@material-ui/core/Modal';import Menu from'@material-ui/core/Menu';import MenuItem from'@material-ui/core/MenuItem';import storageService from'../../utils/storageService';import AuthModal from'../auth/authModal';import Urls,{urlFor}from'../../network/Urls';import{useDispatch}from'react-redux';import{setLoading,setShowNotification}from'../../redux/common/actions';import{messaging,deleteToken,signOut}from'../../services/firebase';import{onNotificationClick,formatNotificationTime}from'../../utils/common';import{getNotificationList}from'../../redux/homeSearch/actions';import{markNotifAsRead}from'../../redux/auth/actions';import{moengage,mixPanel}from'../../services/analyticsTools';import{MoEConstants}from'../../utils/constants';import moment from'moment';import _ from'lodash';import colorLogo from'../../assets/images/ic-logo-yellow.png';import menu from\"../../assets/images/menu-line-white.svg\";import bell from'../../assets/images/ic-notification.png';import cancel from\"../../assets/images/ic-cancel.png\";import dummy from'../../assets/images/u_placeholder.jpg';import profile from'../../assets/images/ic-profile.png';import revenue from'../../assets/images/ic-revenue.png';import guide from'../../assets/images/ic-tutorial.png';import savedJobs from'../../assets/images/ic-job.png';import noNotification from'../../assets/images/no-notifications.png';import skipBtn from'../../assets/images/skip.png';import backBtn from'../../assets/images/back.png';import nextBtn from'../../assets/images/next.png';import doneBtn from'../../assets/images/check-mark.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var DISABLE_HEADER=['/signup','/login','/reset-password','/404','/email-updated-successfully','/change-password-success'];var Header=function Header(props){var _notificationData$lis3,_notificationData$lis4,_notificationData$lis5;var window_=window;var dispatch=useDispatch();var _useLocation=useLocation(),pathname=_useLocation.pathname;var history=useHistory();var type=storageService.getItem('userType');var _useState=useState(null),_useState2=_slicedToArray(_useState,2),userType=_useState2[0],setUserType=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),anchorEl=_useState4[0],setAnchorEl=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),anchorElNotif=_useState6[0],setAnchorElNotif=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),showModal=_useState8[0],setShowModal=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),showHeader=_useState10[0],setShowHeader=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),toggleMenu=_useState12[0],setToggleMenu=_useState12[1];var _useState13=useState('discover'),_useState14=_slicedToArray(_useState13,2),activeLink=_useState14[0],setActiveLink=_useState14[1];var _useState15=useState({count:0,list:[],unreadCount:0}),_useState16=_slicedToArray(_useState15,2),notificationData=_useState16[0],setNotificationData=_useState16[1];var _useState17=useState(1),_useState18=_slicedToArray(_useState17,2),notificationPgNo=_useState18[0],setNotificationPgNo=_useState18[1];var _useState19=useState(true),_useState20=_slicedToArray(_useState19,2),hasMoreNotif=_useState20[0],setHasMoreNotif=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),isIntercom=_useState22[0],setIntercom=_useState22[1];var _useState23=useState(false),_useState24=_slicedToArray(_useState23,2),startTour=_useState24[0],setStartTour=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),isFalse=_useState26[0],setIsFalse=_useState26[1];var forceUpdate=useForceUpdate();var _useState27=useState(''),_useState28=_slicedToArray(_useState27,2),activeTarget=_useState28[0],setActiveTarget=_useState28[1];var _useState29=useState(false),_useState30=_slicedToArray(_useState29,2),logoutClicked=_useState30[0],setLogoutClicked=_useState30[1];var _useState31=useState(''),_useState32=_slicedToArray(_useState31,2),profileData=_useState32[0],setProfileData=_useState32[1];function useForceUpdate(){var _useState33=useState(0),_useState34=_slicedToArray(_useState33,2),value=_useState34[0],setValue=_useState34[1];// integer state\nreturn function(){return setValue(function(value){return value+Math.random();});};// update the state to force render\n}var onMessageListner=function onMessageListner(){if(messaging){messaging.onMessage(function(payload){var _payload$data;console.log('firebase notification received inside header : ',payload);// const title = payload.data.title;\n// const options = {\n//     body: payload.data.notificationText\n// }\n// var notifications = new Notification(title, options);\n// notifications.onclick = function (event) {\n//     console.log('event: ', event);\n//     event.preventDefault(); // prevent the browser from focusing the Notification's tab\n//     window.open('http://localhost:3000/active-jobs', '_self');\n// }\nsetShowNotification(true,payload);if(((_payload$data=payload.data)===null||_payload$data===void 0?void 0:_payload$data.notificationType)!==\"25\"){setNotificationData(function(prevData){var newPayLoad=_objectSpread({},payload.data);newPayLoad.read=0;var newPushList=_toConsumableArray(prevData.list);newPushList.unshift(newPayLoad);return _objectSpread(_objectSpread({},prevData),{},{unreadCount:prevData.unreadCount+1,list:newPushList});});}});}};var callNotificationList=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(resetUnreadNotif,isInit){var _notificationData$lis,_notificationData$lis2;var res1,_res1$data,_result$list,result,notifList;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(((_notificationData$lis=notificationData.list)===null||_notificationData$lis===void 0?void 0:_notificationData$lis.length)>0&&((_notificationData$lis2=notificationData.list)===null||_notificationData$lis2===void 0?void 0:_notificationData$lis2.length)>(notificationData===null||notificationData===void 0?void 0:notificationData.count))){_context.next=3;break;}setHasMoreNotif(false);return _context.abrupt(\"return\");case 3:_context.next=5;return getNotificationList(resetUnreadNotif?1:notificationPgNo,resetUnreadNotif&&isInit?false:resetUnreadNotif?true:false);case 5:res1=_context.sent;if(res1.success){result=(_res1$data=res1.data)===null||_res1$data===void 0?void 0:_res1$data.result;if((result===null||result===void 0?void 0:(_result$list=result.list)===null||_result$list===void 0?void 0:_result$list.length)<10){setHasMoreNotif(false);}notifList=resetUnreadNotif||isInit?result===null||result===void 0?void 0:result.list:[].concat(_toConsumableArray(notificationData.list),_toConsumableArray(result===null||result===void 0?void 0:result.list));setNotificationData(function(prevData){return _objectSpread(_objectSpread({},prevData),{},{count:result===null||result===void 0?void 0:result.count,list:notifList,unreadCount:result===null||result===void 0?void 0:result.unreadCount});});if(resetUnreadNotif){handleClose('notification');setNotificationPgNo(2);}else{setNotificationPgNo(notificationPgNo+1);}if(props.recallHeaderNotif){props.recallHeaderNotification(false);}}case 7:case\"end\":return _context.stop();}}},_callee);}));return function callNotificationList(_x,_x2){return _ref.apply(this,arguments);};}();console.log('notificationDataHeader: ',notificationData);useEffect(function(){var _URLSearchParams,_props$location;onMessageListner();setActiveLink('discover');setUserType(storageService.getItem('userType'));callOnPathChange();var pushNotifId=(_URLSearchParams=new URLSearchParams((_props$location=props.location)===null||_props$location===void 0?void 0:_props$location.search))===null||_URLSearchParams===void 0?void 0:_URLSearchParams.get('pushNotifId');if(pushNotifId){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return markNotifAsRead({notificationId:pushNotifId});case 2:res=_context2.sent;if(res.success){callNotificationList(true,true);}case 4:case\"end\":return _context2.stop();}}},_callee2);}))();}},[]);var callOnPathChange=function callOnPathChange(){var _props$tradeListData;if(userType&&!DISABLE_HEADER.includes(pathname)&&pathname!=='guest-user'){callNotificationList(true,true);if(userType===1){if(!profileData||profileData&&!_.isEqual(props.tradieProfileData,profileData)){props.callTradieProfileData();}}else if(userType===2){if(!profileData||profileData&&!_.isEqual(props.builderProfile,profileData)){props.getProfileBuilder();}}}if(DISABLE_HEADER.includes(pathname)){setShowHeader(false);}else{setShowHeader(true);}setUserType(storageService.getItem('userType'));if(((_props$tradeListData=props.tradeListData)===null||_props$tradeListData===void 0?void 0:_props$tradeListData.length)===0){props.callTradeList();}};useEffect(function(){var _Object$keys,_Object$keys2;if(props.tradieProfileData&&((_Object$keys=Object.keys(props.tradieProfileData))===null||_Object$keys===void 0?void 0:_Object$keys.length)){setProfileData(props.tradieProfileData);}if(props.builderProfile&&((_Object$keys2=Object.keys(props.builderProfile))===null||_Object$keys2===void 0?void 0:_Object$keys2.length)){setProfileData(props.builderProfile);}},[props.tradieProfileData,props.builderProfile]);useEffect(function(){if((props===null||props===void 0?void 0:props.builderProfile)&&Object.keys(props===null||props===void 0?void 0:props.builderProfile).length&&!isIntercom){setIntercom(true);setHidden();}if((props===null||props===void 0?void 0:props.tradieProfileData)&&Object.keys(props===null||props===void 0?void 0:props.tradieProfileData).length&&!isIntercom){setIntercom(true);setHidden();}},[props]);var setHidden=function setHidden(){var data=storageService.getItem('userInfo');if(data){if(!Object.values(data).includes([''])){if(window_.Intercom){// window_.Intercom('shutdown');\nwindow_.Intercom('update',{app_id:'tvbm4bhr',name:data.userName,email:data.email,user_id:data._id});}}else{forceUpdate();setIsFalse(true);callOnPathChange();console.log({type:type},'user_id');}}};useEffect(function(){if(pathname==='/login'){// window_.Intercom('hide');\n}if(pathname==='/'){var _props$location2,_props$location2$stat;setActiveLink('discover');setHidden();if((props===null||props===void 0?void 0:(_props$location2=props.location)===null||_props$location2===void 0?void 0:(_props$location2$stat=_props$location2.state)===null||_props$location2$stat===void 0?void 0:_props$location2$stat.path)==='/signup'){setStartTour(true);props.history.replace('/');}}if(['/jobs','/active-jobs','/applied-jobs','/past-jobs','/new-jobs','/approved-milestones','/mark-milestone','/review-builder'].includes(pathname)){setActiveLink('jobs');setHidden();}if(pathname==='/post-new-job'){setActiveLink('post');setHidden();}if(pathname==='/chat'){setActiveLink('chat');setHidden();}if(['/builder-info','/saved-tradespeople','/search-tradie-results'].includes(pathname)){setHidden();}},[pathname]);useEffect(function(){callOnPathChange();},[pathname,userType,isFalse]);useEffect(function(){if(props.recallHeaderNotif){callOnPathChange();}},[props.recallHeaderNotif]);useEffect(function(){if(startTour){document.body.classList.add('no-scroll');}else{document.body.classList.remove('no-scroll');}},[startTour]);var handleClick=function handleClick(event,type){if(type==='notification'){setAnchorElNotif(event.currentTarget);}else{setAnchorEl(event.currentTarget);}};var handleClose=function handleClose(type){if(type==='notification'){setAnchorElNotif(null);}else{setAnchorEl(null);}};var logoutHandler=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _storageService$getIt;var response,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setLogoutClicked(false);setLoading(true);_context3.next=4;return fetch(urlFor(\"\".concat(Urls.logout,\"?deviceId=\").concat((_storageService$getIt=storageService.getItem('userInfo'))===null||_storageService$getIt===void 0?void 0:_storageService$getIt.deviceId)),{method:\"GET\",headers:{'Content-Type':'application/json',Authorization:storageService.getItem('jwtToken'),'timezone':moment.tz.guess()}});case 4:response=_context3.sent;_context3.next=7;return response.json();case 7:res=_context3.sent;setLoading(false);if(res.status_code===200){moengage.moE_SendEvent(MoEConstants.LOG_OUT,{success_status:true,current_page:pathname});mixPanel.mixP_SendEvent(MoEConstants.LOG_OUT,{success_status:true,current_page:pathname});signOut();deleteToken();moengage.moE_LogoutEvent();}dispatch({type:'USER_LOGGED_OUT'});storageService.clearAll();history.push('/login');case 13:case\"end\":return _context3.stop();}}},_callee3);}));return function logoutHandler(){return _ref3.apply(this,arguments);};}();var postClicked=function postClicked(){setToggleMenu(false);setActiveLink('post');history.push('/post-new-job');};var chatClicked=function chatClicked(){setToggleMenu(false);if(userType===1||userType===2){setActiveLink('chat');history.push('/chat');}};var jobClick=function jobClick(){setToggleMenu(false);if(userType===1){setActiveLink('jobs');history.push('/active-jobs');}else if(userType===2){setActiveLink('jobs');history.push('/jobs');}};var renderByType=function renderByType(_ref4){var name=_ref4.name;if(userType===1||userType===2){return profileData===null||profileData===void 0?void 0:profileData[name];}};var handleCallback=function handleCallback(state){var action=state.action,target=state.step.target;var width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;setActiveTarget(target);if(action==='reset'){setStartTour(false);}else if(action==='start'&&width<=650){setToggleMenu(true);}if(target==='.tour-profile'&&toggleMenu){setToggleMenu(false);}};var tradieTour=[{target:'.tour-discover a',content:\"Hi \".concat(renderByType({name:'userName'}),\", here is your go-to for finding new jobs.\"),disableBeacon:true},{target:'.tour-jobs a',content:'Here you can find all your active jobs and keep on top of milestones!'},{target:'.tour-chat a',content:'Chat with builders about job requirements'},{target:'.tour-profile',content:'Manage your profile and settings'},{target:'.tour-notifications',content:'Check notifications and stay on the front foot'}];var builderTour=[{target:'.tour-discover a',content:\"Hi \".concat(renderByType({name:'userName'}),\", here is your go-to for finding tradespeople.\"),disableBeacon:true},{target:'.tour-jobs a',content:'Here you can find all your active jobs and keep on top of milestones!'},{target:'.tour-post a',content:'Here you can post a new job'},{target:'.tour-chat a',content:'Your chats for job and tradespeople are here'},{target:'.tour-profile',content:'Manage your profile and settings'},{target:'.tour-notifications',content:'Check notifications and stay on the front foot'}];return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Joyride,{run:startTour,showProgress:true,continuous:true,showSkipButton:true,scrollToFirstStep:true,spotlightPadding:activeTarget==='.tour-notifications'?12:0,disableOverlayClose:true,disableCloseOnEsc:true,steps:userType===1?tradieTour:builderTour,styles:{options:{zIndex:2000},overlay:{background:'#00000099'}},floaterProps:{hideArrow:true},tooltipComponent:function tooltipComponent(_ref5){var continuous=_ref5.continuous,index=_ref5.index,step=_ref5.step,backProps=_ref5.backProps,skipProps=_ref5.skipProps,primaryProps=_ref5.primaryProps,tooltipProps=_ref5.tooltipProps,isLastStep=_ref5.isLastStep,size=_ref5.size;return/*#__PURE__*/_jsxs(\"div\",_objectSpread(_objectSpread({className:\"tour-tooltip\"},tooltipProps),{},{children:[/*#__PURE__*/_jsx(\"div\",{className:\"tour-tooltip-content\",children:step.content}),/*#__PURE__*/_jsxs(\"div\",{className:\"tour-tooltip-footer\",children:[/*#__PURE__*/_jsx(\"button\",_objectSpread(_objectSpread({className:\"\"},skipProps),{},{title:\"Skip\",children:/*#__PURE__*/_jsx(\"img\",{src:skipBtn,alt:\"skip\",className:\"skip\"})})),index>0&&/*#__PURE__*/_jsx(\"button\",_objectSpread(_objectSpread({className:\"\"},backProps),{},{title:\"Back\",children:/*#__PURE__*/_jsx(\"img\",{src:backBtn,alt:\"back\"})})),continuous&&/*#__PURE__*/ // <button className=\"\" {...primaryProps} title={isLastStep ? 'Done' : 'Next'}>\n//     {isLastStep ? 'Done' : 'Next'} {step.showProgress && `(${index + 1}/${size})`}\n// </button>\n_jsxs(\"button\",_objectSpread(_objectSpread({className:\"\"},primaryProps),{},{title:isLastStep?'Done':'Next',children:[isLastStep?/*#__PURE__*/_jsx(\"img\",{src:doneBtn,alt:\"done\"}):/*#__PURE__*/_jsx(\"img\",{src:nextBtn,alt:\"next\"}),/*#__PURE__*/_jsx(\"span\",{children:step.showProgress&&\"(\".concat(index+1,\"/\").concat(size,\")\")})]}))]})]}));},callback:handleCallback}),showHeader&&/*#__PURE__*/_jsx(\"header\",{id:\"header\",children:/*#__PURE__*/_jsx(\"div\",{className:\"custom_container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex_headrow\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"brand_wrap\",children:/*#__PURE__*/_jsx(\"figure\",{children:/*#__PURE__*/_jsx(\"img\",{onClick:function onClick(){if(userType===0){return;}if(pathname==='/'){window.scrollTo({top:0,left:0,behavior:'smooth'});return;}setActiveLink('discover');setToggleMenu(false);props.history.push('/');},src:colorLogo,alt:\"logo\"})})}),/*#__PURE__*/_jsxs(\"ul\",{className:\"center_nav \".concat(toggleMenu?'active':''),children:[/*#__PURE__*/_jsx(\"li\",{className:\"tour-discover\",children:/*#__PURE__*/_jsx(\"a\",{onClick:function onClick(){if(userType===1||userType===2){setActiveLink('discover');history.push('/');}else{return;}},className:startTour?activeTarget==='.tour-discover a'?'active':'':activeLink==='discover'?'active':'',children:'Discover'})}),/*#__PURE__*/_jsx(\"li\",{className:\"tour-jobs\",children:/*#__PURE__*/_jsx(\"a\",{className:startTour?activeTarget==='.tour-jobs a'?'active':'':activeLink==='jobs'?'active':'',onClick:jobClick,children:'Jobs'})}),userType===2&&/*#__PURE__*/_jsx(\"li\",{className:\"tour-post\",children:/*#__PURE__*/_jsx(\"a\",{className:startTour?activeTarget==='.tour-post a'?'active':'':activeLink==='post'?'active':'',onClick:postClicked,children:'Post'})}),/*#__PURE__*/_jsx(\"li\",{className:\"tour-chat\",children:/*#__PURE__*/_jsx(\"a\",{className:startTour?activeTarget==='.tour-chat a'?'active':'':activeLink==='chat'?'active':'',onClick:chatClicked,children:'Chat'})})]}),/*#__PURE__*/_jsxs(\"ul\",{className:\"side_nav\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"mob_nav\",children:/*#__PURE__*/_jsx(\"img\",{src:menu,alt:\"menu\",onClick:function onClick(){setToggleMenu(!toggleMenu);}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile_notification\",children:[storageService.getItem(\"jwtToken\")&&/*#__PURE__*/_jsx(\"div\",{className:\"notification_bell\",onClick:function onClick(event){return handleClick(event,'notification');},children:/*#__PURE__*/_jsxs(\"figure\",{className:\"bell tour-notifications\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"\".concat(notificationData.unreadCount?'badge':''),children:notificationData.unreadCount||''}),/*#__PURE__*/_jsx(\"img\",{src:bell,alt:\"notify\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"user_profile\",children:[storageService.getItem(\"jwtToken\")&&/*#__PURE__*/_jsx(\"figure\",{className:\"tour-profile\",\"aria-controls\":\"simple-menu\",\"aria-haspopup\":\"true\",onClick:function onClick(event){return handleClick(event,'profile');},children:/*#__PURE__*/_jsx(\"img\",{src:renderByType({name:'userImage'})||dummy,alt:\"profile-img\"})}),/*#__PURE__*/_jsxs(Menu,{className:\"sub_menu\",id:\"simple-menu\",anchorEl:anchorEl,keepMounted:true,open:Boolean(anchorEl),onClose:function onClose(){return handleClose('profile');},elevation:0,getContentAnchorEl:null,anchorOrigin:{vertical:'bottom',horizontal:'center'},transformOrigin:{vertical:'top',horizontal:'right'},children:[/*#__PURE__*/_jsx(\"span\",{className:\"sub_title\",children:renderByType({name:'userName'})}),/*#__PURE__*/_jsx(MenuItem,{onClick:function onClick(){handleClose('pofile');history.push(\"/\".concat(props.userType===1?'tradie':'builder',\"-info?\").concat(props.userType===1?'trade':'builder',\"Id=\").concat(renderByType({name:'userId'})));},children:/*#__PURE__*/_jsxs(\"span\",{className:\"setting_icon\",children:[/*#__PURE__*/_jsx(\"img\",{src:profile,alt:\"profile\"}),'My Profile']})}),[1,2].includes(props.userType)&&/*#__PURE__*/_jsx(MenuItem,{onClick:function onClick(){handleClose('profile');history.push('/payment-history');},children:/*#__PURE__*/_jsxs(\"span\",{className:\"setting_icon\",children:[/*#__PURE__*/_jsx(\"img\",{src:revenue,alt:\"revenue\"}),props.userType===1?'Payment history':'Transaction history']})}),[1,2].includes(props.userType)&&/*#__PURE__*/_jsx(MenuItem,{onClick:function onClick(){handleClose('profile');history.push(props.userType===1?'/saved-jobs':'/saved-tradespeople');},children:/*#__PURE__*/_jsxs(\"span\",{className:\"setting_icon\",children:[/*#__PURE__*/_jsx(\"img\",{src:savedJobs,alt:\"savedJobs\"}),\"Saved \".concat(props.userType===1?'jobs':'tradespeople')]})}),[1,2].includes(props.userType)&&/*#__PURE__*/_jsx(MenuItem,{onClick:function onClick(){handleClose('profile');setStartTour(true);},children:/*#__PURE__*/_jsxs(\"span\",{className:\"setting_icon\",children:[/*#__PURE__*/_jsx(\"img\",{src:guide,alt:\"guide\"}),'App Guide']})}),/*#__PURE__*/_jsx(MenuItem,{onClick:function onClick(){handleClose('profile');setLogoutClicked(true);},children:/*#__PURE__*/_jsx(\"span\",{className:\"setting_icon logout\",children:\"Logout\"})})]}),/*#__PURE__*/_jsx(Modal,{className:\"custom_modal\",open:logoutClicked,onClose:function onClose(){return setLogoutClicked(false);},\"aria-labelledby\":\"simple-modal-title\",\"aria-describedby\":\"simple-modal-description\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"custom_wh confirmation\",\"data-aos\":\"zoom-in\",\"data-aos-delay\":\"30\",\"data-aos-duration\":\"1000\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"heading\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"xs_sub_title\",children:\"Logout Confirmation\"}),/*#__PURE__*/_jsx(\"button\",{className:\"close_btn\",onClick:function onClick(){return setLogoutClicked(false);},children:/*#__PURE__*/_jsx(\"img\",{src:cancel,alt:\"cancel\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal_message\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Are you sure you want to logout?\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"dialog_actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"fill_btn btn-effect\",onClick:logoutHandler,children:\"Yes\"}),/*#__PURE__*/_jsx(\"button\",{className:\"fill_grey_btn btn-effect\",onClick:function onClick(){return setLogoutClicked(false);},children:\"No\"})]})]})}),/*#__PURE__*/_jsxs(Menu,{className:\"sub_menu notifications\",id:\"simple-menu\",anchorEl:anchorElNotif,keepMounted:true,open:Boolean(anchorElNotif),onClose:function onClose(){return handleClose('notification');},elevation:0,getContentAnchorEl:null,anchorOrigin:{vertical:'bottom',horizontal:'center'},transformOrigin:{vertical:'top',horizontal:'right'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"sub_title\",children:\"Notifications\"}),/*#__PURE__*/_jsx(\"a\",{href:\"javascript:void(0)\",className:\"link mark_all\",onClick:function onClick(){if(notificationData.unreadCount===0){handleClose('notification');return;}callNotificationList(true);},children:\"Mark all as read\"})]}),((_notificationData$lis3=notificationData.list)===null||_notificationData$lis3===void 0?void 0:_notificationData$lis3.length)>0&&notificationData.list.map(function(item){return/*#__PURE__*/_jsx(MenuItem,{className:\"\".concat(item.read?'':'unread'),onClick:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var _history$location,_history$location2;var url1,url2,res,_window$location;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:handleClose('notification');url1=onNotificationClick(item);url2=((_history$location=history.location)===null||_history$location===void 0?void 0:_history$location.pathname)+((_history$location2=history.location)===null||_history$location2===void 0?void 0:_history$location2.search);if(!(item.read===0)){_context4.next=13;break;}if(!((item===null||item===void 0?void 0:item.notificationType)===13||url1===url2&&(item===null||item===void 0?void 0:item.notificationType)===9)){_context4.next=10;break;}_context4.next=7;return markNotifAsRead({notificationId:item===null||item===void 0?void 0:item._id});case 7:_context4.t0=_context4.sent;_context4.next=11;break;case 10:_context4.t0=markNotifAsRead({notificationId:item===null||item===void 0?void 0:item._id});case 11:res=_context4.t0;if((item===null||item===void 0?void 0:item.notificationType)===13&&(res===null||res===void 0?void 0:res.success)){callNotificationList(true,true);}case 13:if(!(url1===url2&&item.read===0||url1===url2&&(item===null||item===void 0?void 0:item.notificationType)==9)){_context4.next=16;break;}(_window$location=window.location)===null||_window$location===void 0?void 0:_window$location.reload();return _context4.abrupt(\"return\");case 16:props.history.push(url1);case 17:case\"end\":return _context4.stop();}}},_callee4);})),children:/*#__PURE__*/_jsxs(\"div\",{className:\"notif\",children:[/*#__PURE__*/_jsxs(\"figure\",{className:\"not_img\",children:[/*#__PURE__*/_jsx(\"img\",{src:(item===null||item===void 0?void 0:item.image)||dummy,alt:\"img\"}),/*#__PURE__*/_jsx(\"span\",{className:\"\".concat(item.read?'':'dot')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info\",children:[/*#__PURE__*/_jsx(\"span\",{title:item.title,className:\"who line-1\",children:item.title}),/*#__PURE__*/_jsx(\"span\",{title:item.notificationText,className:\"line-1\",children:item.notificationText})]}),/*#__PURE__*/_jsx(\"span\",{className:\"time\",children:formatNotificationTime(item===null||item===void 0?void 0:item.updatedAt,'day')})]})});}),hasMoreNotif&&((_notificationData$lis4=notificationData.list)===null||_notificationData$lis4===void 0?void 0:_notificationData$lis4.length)>0&&/*#__PURE__*/_jsx(\"div\",{className:\"more_notif\",onClick:function onClick(){return callNotificationList();},children:/*#__PURE__*/_jsx(\"a\",{className:\"link\",children:\"View more\"})}),(notificationData===null||notificationData===void 0?void 0:(_notificationData$lis5=notificationData.list)===null||_notificationData$lis5===void 0?void 0:_notificationData$lis5.length)===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"no_notification\",children:[/*#__PURE__*/_jsx(\"figure\",{children:/*#__PURE__*/_jsx(\"img\",{src:noNotification,alt:\"no-notifications\"})}),/*#__PURE__*/_jsx(\"span\",{children:\"No Notifications\"})]})]})]})]}),!storageService.getItem(\"jwtToken\")&&/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{className:\"active\",onClick:function onClick(){return setShowModal(!showModal);},children:'Log in'})}),/*#__PURE__*/_jsx(AuthModal,{showModal:showModal,setShowModal:setShowModal,history:props.history,firstTimePopup:true,children:props.children})]})]})})})]});};export default withRouter(Header);","map":{"version":3,"sources":["/home/appinventiv/Documents/Project/tickt/web/src/common/header/header.tsx"],"names":["useState","useEffect","useLocation","withRouter","useHistory","Joyride","Modal","Menu","MenuItem","storageService","AuthModal","Urls","urlFor","useDispatch","setLoading","setShowNotification","messaging","deleteToken","signOut","onNotificationClick","formatNotificationTime","getNotificationList","markNotifAsRead","moengage","mixPanel","MoEConstants","moment","_","colorLogo","bell","cancel","dummy","profile","revenue","guide","savedJobs","noNotification","skipBtn","backBtn","nextBtn","doneBtn","DISABLE_HEADER","Header","props","window_","window","dispatch","pathname","history","type","getItem","userType","setUserType","anchorEl","setAnchorEl","anchorElNotif","setAnchorElNotif","showModal","setShowModal","showHeader","setShowHeader","toggleMenu","setToggleMenu","activeLink","setActiveLink","count","list","unreadCount","notificationData","setNotificationData","notificationPgNo","setNotificationPgNo","hasMoreNotif","setHasMoreNotif","isIntercom","setIntercom","startTour","setStartTour","isFalse","setIsFalse","forceUpdate","useForceUpdate","activeTarget","setActiveTarget","logoutClicked","setLogoutClicked","profileData","setProfileData","value","setValue","Math","random","onMessageListner","onMessage","payload","console","log","data","notificationType","prevData","newPayLoad","read","newPushList","unshift","callNotificationList","resetUnreadNotif","isInit","length","res1","success","result","notifList","handleClose","recallHeaderNotif","recallHeaderNotification","callOnPathChange","pushNotifId","URLSearchParams","location","search","get","notificationId","res","includes","isEqual","tradieProfileData","callTradieProfileData","builderProfile","getProfileBuilder","tradeListData","callTradeList","Object","keys","setHidden","values","Intercom","app_id","name","userName","email","user_id","_id","state","path","replace","document","body","classList","add","remove","handleClick","event","currentTarget","logoutHandler","fetch","logout","deviceId","method","headers","Authorization","tz","guess","response","json","status_code","moE_SendEvent","LOG_OUT","success_status","current_page","mixP_SendEvent","moE_LogoutEvent","clearAll","push","postClicked","chatClicked","jobClick","renderByType","handleCallback","action","target","step","width","innerWidth","documentElement","clientWidth","tradieTour","content","disableBeacon","builderTour","options","zIndex","overlay","background","hideArrow","continuous","index","backProps","skipProps","primaryProps","tooltipProps","isLastStep","size","showProgress","scrollTo","top","left","behavior","menu","Boolean","vertical","horizontal","map","item","url1","url2","reload","image","title","notificationText","updatedAt","children"],"mappings":"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","sourcesContent":["/* eslint-disable jsx-a11y/anchor-is-valid */\nimport { useState, useEffect } from 'react';\nimport { useLocation, withRouter, useHistory } from \"react-router-dom\";\nimport Joyride from 'react-joyride';\nimport Modal from '@material-ui/core/Modal';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport storageService from '../../utils/storageService';\nimport AuthModal from '../auth/authModal';\nimport Urls, { urlFor } from '../../network/Urls';\nimport { useDispatch } from 'react-redux';\nimport { setLoading, setShowNotification } from '../../redux/common/actions';\nimport { messaging, deleteToken, signOut } from '../../services/firebase';\nimport { onNotificationClick, formatNotificationTime } from '../../utils/common';\nimport { getNotificationList } from '../../redux/homeSearch/actions';\nimport { markNotifAsRead } from '../../redux/auth/actions';\nimport { moengage, mixPanel } from '../../services/analyticsTools';\nimport { MoEConstants } from '../../utils/constants';\n\nimport moment from 'moment';\nimport _ from 'lodash';\n\nimport colorLogo from '../../assets/images/ic-logo-yellow.png';\nimport menu from '../../assets/images/menu-line-white.svg';\nimport bell from '../../assets/images/ic-notification.png';\nimport cancel from \"../../assets/images/ic-cancel.png\";\nimport dummy from '../../assets/images/u_placeholder.jpg';\nimport profile from '../../assets/images/ic-profile.png';\nimport revenue from '../../assets/images/ic-revenue.png';\nimport guide from '../../assets/images/ic-tutorial.png';\nimport savedJobs from '../../assets/images/ic-job.png';\nimport noNotification from '../../assets/images/no-notifications.png';\n\nimport skipBtn from '../../assets/images/skip.png';\nimport backBtn from '../../assets/images/back.png';\nimport nextBtn from '../../assets/images/next.png';\nimport doneBtn from '../../assets/images/check-mark.png';\n\nconst DISABLE_HEADER = [\n    '/signup',\n    '/login',\n    '/reset-password',\n    '/404',\n    '/email-updated-successfully',\n    '/change-password-success'\n];\n\nconst Header = (props: any) => {\n    let window_: any = window;\n    const dispatch = useDispatch();\n    let { pathname } = useLocation();\n    let history = useHistory();\n    let type = storageService.getItem('userType');\n\n    const [userType, setUserType] = useState(null)\n    const [anchorEl, setAnchorEl] = useState(null);\n    const [anchorElNotif, setAnchorElNotif] = useState(null);\n    const [showModal, setShowModal] = useState<boolean>(false);\n    const [showHeader, setShowHeader] = useState<boolean>(false);\n    const [toggleMenu, setToggleMenu] = useState(false);\n    const [activeLink, setActiveLink] = useState('discover');\n    const [notificationData, setNotificationData] = useState<any>({\n        count: 0,\n        list: [],\n        unreadCount: 0\n    });\n    const [notificationPgNo, setNotificationPgNo] = useState<number>(1);\n    const [hasMoreNotif, setHasMoreNotif] = useState<boolean>(true);\n    const [isIntercom, setIntercom] = useState(false);\n    const [startTour, setStartTour] = useState(false);\n    const [isFalse, setIsFalse] = useState(false);\n    const forceUpdate = useForceUpdate();\n    const [activeTarget, setActiveTarget] = useState('');\n    const [logoutClicked, setLogoutClicked] = useState(false);\n    const [profileData, setProfileData] = useState('');\n\n    function useForceUpdate() {\n        const [value, setValue] = useState(0); // integer state\n        return () => setValue(value => value + Math.random()); // update the state to force render\n    }\n\n    const onMessageListner = () => {\n        if (messaging) {\n            messaging.onMessage((payload: any) => {\n                console.log('firebase notification received inside header : ', payload);\n                // const title = payload.data.title;\n                // const options = {\n                //     body: payload.data.notificationText\n                // }\n                // var notifications = new Notification(title, options);\n                // notifications.onclick = function (event) {\n                //     console.log('event: ', event);\n                //     event.preventDefault(); // prevent the browser from focusing the Notification's tab\n                //     window.open('http://localhost:3000/active-jobs', '_self');\n                // }\n\n                setShowNotification(true, payload);\n                if (payload.data?.notificationType !== \"25\") {\n                    setNotificationData((prevData: any) => {\n                        let newPayLoad = { ...payload.data };\n                        newPayLoad.read = 0;\n                        let newPushList = [...prevData.list];\n                        newPushList.unshift(newPayLoad);\n                        return {\n                            ...prevData,\n                            unreadCount: prevData.unreadCount + 1,\n                            list: newPushList\n                        }\n                    });\n                }\n            })\n        }\n    }\n\n    const callNotificationList = async (resetUnreadNotif?: boolean, isInit?: boolean) => {\n        if (notificationData.list?.length > 0 && notificationData.list?.length > notificationData?.count) {\n            setHasMoreNotif(false);\n            return;\n        }\n        const res1 = await getNotificationList(resetUnreadNotif ? 1 : notificationPgNo, (resetUnreadNotif && isInit) ? false : resetUnreadNotif ? true : false);\n        if (res1.success) {\n            const result = res1.data?.result;\n            if (result?.list?.length < 10) {\n                setHasMoreNotif(false);\n            }\n            const notifList: any = (resetUnreadNotif || isInit) ? result?.list : [...notificationData.list, ...result?.list];\n\n            setNotificationData((prevData: any) => ({\n                ...prevData,\n                count: result?.count,\n                list: notifList,\n                unreadCount: result?.unreadCount\n            }));\n            if (resetUnreadNotif) {\n                handleClose('notification');\n                setNotificationPgNo(2);\n            } else {\n                setNotificationPgNo(notificationPgNo + 1);\n            }\n            if (props.recallHeaderNotif) {\n                props.recallHeaderNotification(false);\n            }\n        }\n    }\n    console.log('notificationDataHeader: ', notificationData);\n\n    useEffect(() => {\n        onMessageListner();\n        setActiveLink('discover');\n        setUserType(storageService.getItem('userType'))\n        callOnPathChange();\n\n        const pushNotifId = new URLSearchParams(props.location?.search)?.get('pushNotifId');\n        if (pushNotifId) {\n            (async () => {\n                const res: any = await markNotifAsRead({ notificationId: pushNotifId });\n                if (res.success) {\n                    callNotificationList(true, true);\n                }\n            })();\n        }\n    }, []);\n\n\n    const callOnPathChange = () => {\n        if (userType && !DISABLE_HEADER.includes(pathname) && pathname !== 'guest-user') {\n            callNotificationList(true, true);\n            if (userType === 1) {\n                if (!profileData || (profileData && !_.isEqual(props.tradieProfileData, profileData))) {\n                    props.callTradieProfileData();\n                }\n            } else if (userType === 2) {\n                if (!profileData || (profileData && !_.isEqual(props.builderProfile, profileData))) {\n                    props.getProfileBuilder();\n                }\n            }\n        }\n        if (DISABLE_HEADER.includes(pathname)) {\n            setShowHeader(false);\n        } else {\n            setShowHeader(true);\n        }\n        setUserType(storageService.getItem('userType'));\n        if (props.tradeListData?.length === 0) {\n            props.callTradeList();\n        }\n    }\n\n    useEffect(() => {\n        if (props.tradieProfileData && Object.keys(props.tradieProfileData)?.length) {\n            setProfileData(props.tradieProfileData);\n        }\n        if (props.builderProfile && Object.keys(props.builderProfile)?.length) {\n            setProfileData(props.builderProfile);\n        }\n    }, [props.tradieProfileData, props.builderProfile])\n\n    useEffect(() => {\n        if (props?.builderProfile && Object.keys(props?.builderProfile).length && !isIntercom) {\n            setIntercom(true)\n            setHidden();\n        }\n        if (props?.tradieProfileData && Object.keys(props?.tradieProfileData).length && !isIntercom) {\n            setIntercom(true)\n            setHidden();\n        }\n    }, [props]);\n\n\n    const setHidden = () => {\n        let data: any = storageService.getItem('userInfo');\n        if (data) {\n            if (!Object.values(data).includes([''])) {\n                if (window_.Intercom) {\n                    // window_.Intercom('shutdown');\n                    window_.Intercom('update', {\n                        app_id: 'tvbm4bhr',\n                        name: data.userName,\n                        email: data.email,\n                        user_id: data._id,\n                    });\n                }\n            } else {\n                forceUpdate();\n                setIsFalse(true);\n                callOnPathChange();\n                console.log({ type }, 'user_id')\n            }\n        }\n    }\n\n    useEffect(() => {\n        if (pathname === '/login') {\n            // window_.Intercom('hide');\n        }\n        if (pathname === '/') {\n            setActiveLink('discover');\n            setHidden();\n            if (props?.location?.state?.path === '/signup') {\n                setStartTour(true);\n                props.history.replace('/');\n            }\n        }\n        if ([\n            '/jobs',\n            '/active-jobs',\n            '/applied-jobs',\n            '/past-jobs',\n            '/new-jobs',\n            '/approved-milestones',\n            '/mark-milestone',\n            '/review-builder'\n        ].includes(pathname)) {\n            setActiveLink('jobs');\n            setHidden();\n        }\n        if (pathname === '/post-new-job') {\n            setActiveLink('post');\n            setHidden();\n        }\n        if (pathname === '/chat') {\n            setActiveLink('chat')\n            setHidden();\n        }\n        if (['/builder-info', '/saved-tradespeople', '/search-tradie-results'].includes(pathname)) {\n            setHidden();\n        }\n\n    }, [pathname]);\n\n    useEffect(() => {\n        callOnPathChange();\n    }, [pathname, userType, isFalse]);\n\n    useEffect(() => {\n        if (props.recallHeaderNotif) {\n            callOnPathChange();\n        }\n    }, [props.recallHeaderNotif]);\n\n    useEffect(() => {\n        if (startTour) {\n            document.body.classList.add('no-scroll');\n        } else {\n            document.body.classList.remove('no-scroll');\n        }\n    }, [startTour]);\n\n    const handleClick = (event: any, type: string) => {\n        if (type === 'notification') {\n            setAnchorElNotif(event.currentTarget);\n        } else {\n            setAnchorEl(event.currentTarget);\n        }\n    };\n\n    const handleClose = (type: string) => {\n        if (type === 'notification') {\n            setAnchorElNotif(null);\n        } else {\n            setAnchorEl(null);\n        }\n    };\n\n    const logoutHandler = async () => {\n        setLogoutClicked(false);\n        setLoading(true);\n        const response = await fetch(urlFor(`${Urls.logout}?deviceId=${storageService.getItem('userInfo')?.deviceId}`), {\n            method: \"GET\",\n            headers: {\n                'Content-Type': 'application/json',\n                Authorization: storageService.getItem('jwtToken'),\n                'timezone': moment.tz.guess()\n            }\n        });\n        const res = await response.json();\n        setLoading(false);\n        if (res.status_code === 200) {\n            moengage.moE_SendEvent(MoEConstants.LOG_OUT, { success_status: true, current_page: pathname })\n            mixPanel.mixP_SendEvent(MoEConstants.LOG_OUT, { success_status: true, current_page: pathname })\n            signOut();\n            deleteToken();\n            moengage.moE_LogoutEvent();\n        }\n        dispatch({ type: 'USER_LOGGED_OUT' });\n        storageService.clearAll();\n        history.push('/login');\n    }\n\n    const postClicked = () => {\n        setToggleMenu(false);\n        setActiveLink('post');\n        history.push('/post-new-job')\n    }\n\n    const chatClicked = () => {\n        setToggleMenu(false);\n        if (userType === 1 || userType === 2) {\n            setActiveLink('chat');\n            history.push('/chat');\n        }\n    }\n\n    const jobClick = () => {\n        setToggleMenu(false);\n        if (userType === 1) {\n            setActiveLink('jobs');\n            history.push('/active-jobs');\n        } else if (userType === 2) {\n            setActiveLink('jobs');\n            history.push('/jobs')\n        }\n    }\n\n    const renderByType = ({ name }: any) => {\n        if (userType === 1 || userType === 2) {\n            return profileData?.[name];\n        }\n    }\n\n    const handleCallback = (state: any) => {\n        const { action, step: { target } } = state;\n        const width = window.innerWidth\n            || document.documentElement.clientWidth\n            || document.body.clientWidth;\n\n        setActiveTarget(target);\n\n        if (action === 'reset') {\n            setStartTour(false);\n        } else if (action === 'start' && width <= 650) {\n            setToggleMenu(true);\n        }\n\n        if (target === '.tour-profile' && toggleMenu) {\n            setToggleMenu(false);\n        }\n    }\n\n    const tradieTour = [\n        {\n            target: '.tour-discover a',\n            content: `Hi ${renderByType({ name: 'userName' })}, here is your go-to for finding new jobs.`,\n            disableBeacon: true\n        },\n        {\n            target: '.tour-jobs a',\n            content: 'Here you can find all your active jobs and keep on top of milestones!',\n        },\n        {\n            target: '.tour-chat a',\n            content: 'Chat with builders about job requirements',\n        },\n        {\n            target: '.tour-profile',\n            content: 'Manage your profile and settings',\n        },\n        {\n            target: '.tour-notifications',\n            content: 'Check notifications and stay on the front foot',\n        },\n    ];\n\n    const builderTour = [\n        {\n            target: '.tour-discover a',\n            content: `Hi ${renderByType({ name: 'userName' })}, here is your go-to for finding tradespeople.`,\n            disableBeacon: true\n        },\n        {\n            target: '.tour-jobs a',\n            content: 'Here you can find all your active jobs and keep on top of milestones!',\n        },\n        {\n            target: '.tour-post a',\n            content: 'Here you can post a new job',\n        },\n        {\n            target: '.tour-chat a',\n            content: 'Your chats for job and tradespeople are here',\n        },\n        {\n            target: '.tour-profile',\n            content: 'Manage your profile and settings',\n        },\n        {\n            target: '.tour-notifications',\n            content: 'Check notifications and stay on the front foot',\n        },\n    ]\n\n    return (\n        <>\n            <Joyride\n                run={startTour}\n                showProgress\n                continuous\n                showSkipButton\n                scrollToFirstStep\n                spotlightPadding={activeTarget === '.tour-notifications' ? 12 : 0}\n                disableOverlayClose\n                disableCloseOnEsc\n                steps={userType === 1 ? tradieTour : builderTour}\n                styles={{\n                    options: {\n                        zIndex: 2000,\n                    },\n                    overlay: {\n                        background: '#00000099',\n                    }\n                }}\n                floaterProps={{\n                    hideArrow: true,\n                }}\n                tooltipComponent={({\n                    continuous,\n                    index,\n                    step,\n                    backProps,\n                    skipProps,\n                    primaryProps,\n                    tooltipProps,\n                    isLastStep,\n                    size,\n                }) => (\n                    <div className=\"tour-tooltip\" {...tooltipProps}>\n                        <div className=\"tour-tooltip-content\">{step.content}</div>\n                        <div className=\"tour-tooltip-footer\">\n                            <button className=\"\" {...skipProps} title=\"Skip\">\n                                <img src={skipBtn} alt=\"skip\" className=\"skip\" />\n                            </button>\n                            {index > 0 && (\n                                <button className=\"\" {...backProps} title=\"Back\">\n                                    <img src={backBtn} alt=\"back\" />\n                                </button>\n                            )}\n                            {continuous && (\n                                // <button className=\"\" {...primaryProps} title={isLastStep ? 'Done' : 'Next'}>\n                                //     {isLastStep ? 'Done' : 'Next'} {step.showProgress && `(${index + 1}/${size})`}\n                                // </button>\n\n                                <button className=\"\" {...primaryProps} title={isLastStep ? 'Done' : 'Next'}>\n                                    {isLastStep ? <img src={doneBtn} alt=\"done\" /> : <img src={nextBtn} alt=\"next\" />}\n                                    <span>{step.showProgress && `(${index + 1}/${size})`}</span>\n                                </button>\n                            )}\n                        </div>\n                    </div>\n                )}\n                callback={handleCallback}\n            />\n            {showHeader && <header id=\"header\">\n                <div className=\"custom_container\">\n                    <div className=\"flex_headrow\">\n                        <div className=\"brand_wrap\">\n                            <figure>\n                                <img\n                                    onClick={() => {\n                                        if (userType === 0) {\n                                            return;\n                                        }\n                                        if (pathname === '/') {\n                                            window.scrollTo({ top: 0, left: 0, behavior: 'smooth' });\n                                            return;\n                                        }\n                                        setActiveLink('discover');\n                                        setToggleMenu(false);\n                                        props.history.push('/');\n                                    }}\n                                    src={colorLogo}\n                                    alt=\"logo\" />\n                            </figure>\n                        </div>\n                        <ul className={`center_nav ${toggleMenu ? 'active' : ''}`}>\n                            <li className=\"tour-discover\">\n                                <a\n                                    onClick={() => {\n                                        if (userType === 1 || userType === 2) {\n                                            setActiveLink('discover');\n                                            history.push('/');\n                                        } else {\n                                            return;\n                                        }\n                                    }}\n                                    className={startTour ? activeTarget === '.tour-discover a' ? 'active' : '' : activeLink === 'discover' ? 'active' : ''}>\n                                    {'Discover'}\n                                </a>\n                            </li>\n                            <li className=\"tour-jobs\">\n                                <a className={startTour ? activeTarget === '.tour-jobs a' ? 'active' : '' : activeLink === 'jobs' ? 'active' : ''} onClick={jobClick}>\n                                    {'Jobs'}\n                                </a>\n                            </li>\n\n                            {userType === 2 &&\n                                <li className=\"tour-post\">\n                                    <a className={startTour ? activeTarget === '.tour-post a' ? 'active' : '' : activeLink === 'post' ? 'active' : ''} onClick={postClicked}>\n                                        {'Post'}\n                                    </a>\n                                </li>}\n                            <li className=\"tour-chat\">\n                                <a className={startTour ? activeTarget === '.tour-chat a' ? 'active' : '' : activeLink === 'chat' ? 'active' : ''} onClick={chatClicked}>\n                                    {'Chat'}\n                                </a>\n                            </li>\n                        </ul>\n                        <ul className=\"side_nav\">\n                            <li className=\"mob_nav\">\n                                <img\n                                    src={menu}\n                                    alt=\"menu\"\n                                    onClick={() => { setToggleMenu(!toggleMenu); }} />\n                            </li>\n                            <div className=\"profile_notification\">\n                                {storageService.getItem(\"jwtToken\") &&\n                                    <div className=\"notification_bell\" onClick={(event) => handleClick(event, 'notification')}>\n                                        <figure className=\"bell tour-notifications\">\n                                            <span className={`${notificationData.unreadCount ? 'badge' : ''}`}>{notificationData.unreadCount || ''}</span>\n                                            <img src={bell} alt=\"notify\" />\n                                        </figure>\n                                    </div>}\n                                <div className=\"user_profile\">\n                                    {storageService.getItem(\"jwtToken\") &&\n                                        <figure className=\"tour-profile\" aria-controls=\"simple-menu\" aria-haspopup=\"true\" onClick={(event) => handleClick(event, 'profile')}>\n                                            <img src={renderByType({ name: 'userImage' }) || dummy} alt=\"profile-img\" />\n                                        </figure>}\n\n                                    <Menu className=\"sub_menu\"\n                                        id=\"simple-menu\"\n                                        anchorEl={anchorEl}\n                                        keepMounted\n                                        open={Boolean(anchorEl)}\n                                        onClose={() => handleClose('profile')}\n                                        elevation={0}\n                                        getContentAnchorEl={null}\n                                        anchorOrigin={{\n                                            vertical: 'bottom',\n                                            horizontal: 'center',\n                                        }}\n                                        transformOrigin={{\n                                            vertical: 'top',\n                                            horizontal: 'right',\n                                        }}\n                                    >\n                                        <span className=\"sub_title\">\n                                            {renderByType({ name: 'userName' })}\n                                        </span>\n\n\n                                        <MenuItem onClick={() => {\n                                            handleClose('pofile');\n                                            history.push(`/${props.userType === 1 ? 'tradie' : 'builder'}-info?${props.userType === 1 ? 'trade' : 'builder'}Id=${renderByType({ name: 'userId' })}`);\n                                        }}>\n                                            <span className=\"setting_icon\">\n                                                <img src={profile} alt=\"profile\" />\n                                                {'My Profile'}\n                                            </span>\n                                        </MenuItem>\n                                        {[1, 2].includes(props.userType) && (\n                                            <MenuItem onClick={() => { handleClose('profile'); history.push('/payment-history'); }}>\n                                                <span className=\"setting_icon\">\n                                                    <img src={revenue} alt=\"revenue\" />\n                                                    {props.userType === 1 ? 'Payment history' : 'Transaction history'}\n                                                </span>\n                                            </MenuItem>\n                                        )}\n                                        {[1, 2].includes(props.userType) && (\n                                            <MenuItem onClick={() => { handleClose('profile'); history.push(props.userType === 1 ? '/saved-jobs' : '/saved-tradespeople') }}>\n                                                <span className=\"setting_icon\">\n                                                    <img src={savedJobs} alt=\"savedJobs\" />\n                                                    {`Saved ${props.userType === 1 ? 'jobs' : 'tradespeople'}`}\n                                                </span>\n                                            </MenuItem>\n                                        )}\n                                        {[1, 2].includes(props.userType) && (\n                                            <MenuItem onClick={() => { handleClose('profile'); setStartTour(true); }}>\n                                                <span className=\"setting_icon\">\n                                                    <img src={guide} alt=\"guide\" />\n                                                    {'App Guide'}\n                                                </span>\n                                            </MenuItem>\n                                        )}\n                                        <MenuItem onClick={() => {\n                                            handleClose('profile');\n                                            setLogoutClicked(true);\n                                        }}>\n                                            <span className=\"setting_icon logout\">Logout</span>\n                                        </MenuItem>\n                                    </Menu>\n\n                                    {/* logout popup */}\n                                    <Modal\n                                        className=\"custom_modal\"\n                                        open={logoutClicked}\n                                        onClose={() => setLogoutClicked(false)}\n                                        aria-labelledby=\"simple-modal-title\"\n                                        aria-describedby=\"simple-modal-description\"\n                                    >\n                                        <div className=\"custom_wh confirmation\" data-aos=\"zoom-in\" data-aos-delay=\"30\" data-aos-duration=\"1000\">\n                                            <div className=\"heading\">\n                                                <span className=\"xs_sub_title\">{`Logout Confirmation`}</span>\n                                                <button className=\"close_btn\" onClick={() => setLogoutClicked(false)}>\n                                                    <img src={cancel} alt=\"cancel\" />\n                                                </button>\n                                            </div>\n                                            <div className=\"modal_message\">\n                                                <p>{`Are you sure you want to logout?`}</p>\n                                            </div>\n                                            <div className=\"dialog_actions\">\n                                                <button className=\"fill_btn btn-effect\" onClick={logoutHandler}>Yes</button>\n                                                <button className=\"fill_grey_btn btn-effect\" onClick={() => setLogoutClicked(false)}>No</button>\n                                            </div>\n                                        </div>\n                                    </Modal>\n\n                                    {/* Notification */}\n                                    <Menu className=\"sub_menu notifications\"\n                                        id=\"simple-menu\"\n                                        anchorEl={anchorElNotif}\n                                        keepMounted\n                                        open={Boolean(anchorElNotif)}\n                                        onClose={() => handleClose('notification')}\n                                        elevation={0}\n                                        getContentAnchorEl={null}\n                                        anchorOrigin={{\n                                            vertical: 'bottom',\n                                            horizontal: 'center',\n                                        }}\n                                        transformOrigin={{\n                                            vertical: 'top',\n                                            horizontal: 'right',\n                                        }}\n                                    >\n                                        <div>\n                                            <span className=\"sub_title\">Notifications</span>\n                                            <a href=\"javascript:void(0)\" className=\"link mark_all\"\n                                                onClick={() => {\n                                                    if (notificationData.unreadCount === 0) {\n                                                        handleClose('notification');\n                                                        return;\n                                                    }\n                                                    callNotificationList(true)\n                                                }}\n                                            >Mark all as read</a>\n                                        </div>\n\n                                        {notificationData.list?.length > 0 &&\n                                            notificationData.list.map((item: any) =>\n                                                <MenuItem className={`${item.read ? '' : 'unread'}`} onClick={async () => {\n                                                    handleClose('notification');\n                                                    const url1: string = onNotificationClick(item);\n                                                    const url2: string = history.location?.pathname + history.location?.search;\n                                                    if (item.read === 0) {\n                                                        const res: any = (item?.notificationType === 13 || (url1 === url2 && item?.notificationType === 9)) ? await markNotifAsRead({ notificationId: item?._id }) : markNotifAsRead({ notificationId: item?._id });\n                                                        if (item?.notificationType === 13 && res?.success) {\n                                                            callNotificationList(true, true);\n                                                        }\n                                                    }\n                                                    if ((url1 === url2 && item.read === 0) || (url1 === url2 && item?.notificationType == 9)) {\n                                                        window.location?.reload();\n                                                        return;\n                                                    }\n                                                    props.history.push(url1);\n                                                }}\n                                                >\n                                                    <div className=\"notif\">\n                                                        <figure className=\"not_img\">\n                                                            <img src={item?.image || dummy} alt=\"img\" />\n                                                            {/* <span className=\"dot\"></span> */}\n                                                            <span className={`${item.read ? '' : 'dot'}`}></span>\n                                                        </figure>\n                                                        <div className=\"info\">\n                                                            {/* <span className=\"who line-1\">{item.title}</span> */}\n                                                            <span title={item.title} className=\"who line-1\">{item.title}</span>\n                                                            <span title={item.notificationText} className=\"line-1\">{item.notificationText}</span>\n                                                            {/* <span className=\"see\">See the message</span> */}\n                                                        </div>\n                                                        <span className=\"time\">{formatNotificationTime(item?.updatedAt, 'day')}</span>\n                                                    </div>\n                                                </MenuItem>\n                                            )}\n                                        {hasMoreNotif && notificationData.list?.length > 0 && <div className=\"more_notif\" onClick={() => callNotificationList()}>\n                                            <a className=\"link\">View more</a>\n                                        </div>}\n\n                                        {notificationData?.list?.length === 0 && <div className=\"no_notification\">\n                                            <figure>\n                                                <img src={noNotification} alt=\"no-notifications\" />\n                                            </figure>\n                                            <span>No Notifications</span>\n                                        </div>}\n\n                                    </Menu>\n                                    {/* Notification close */}\n\n                                </div>\n                            </div>\n                            {!storageService.getItem(\"jwtToken\") &&\n                                <li>\n                                    <a className=\"active\" onClick={() => setShowModal(!showModal)}>\n                                        {'Log in'}\n                                    </a>\n                                </li>}\n                            <AuthModal\n                                showModal={showModal}\n                                setShowModal={setShowModal}\n                                history={props.history}\n                                firstTimePopup>\n                                {props.children}\n                            </AuthModal>\n                        </ul>\n                    </div>\n                </div>\n            </header>}\n        </>\n    )\n}\n\nexport default withRouter(Header);\n"]},"metadata":{},"sourceType":"module"}