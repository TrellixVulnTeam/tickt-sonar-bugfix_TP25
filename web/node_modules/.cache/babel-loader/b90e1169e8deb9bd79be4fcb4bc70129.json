{"ast":null,"code":"var _jsxFileName = \"/home/appinventiv/Documents/Project/tickt/web/src/pages/postJob/components/editMileStone.tsx\";\nimport React, { Component } from 'react';\nimport moment from 'moment';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n// for error messages\nconst label = {\n  milestone_name: 'Milestone Name',\n  from_date: 'From Date',\n  recommended_hours: 'Recommended Hours'\n};\nconst pattern = \"^([0-9][0-9]?[0-9]?[0-9]?[0-9]):[0-9][0-9]$\";\nexport default class EditMilestone extends Component {\n  constructor(props) {\n    super(props);\n\n    this.checkIsDateValid = (milestones, time) => {\n      const {\n        editMileStone,\n        editMilestoneTiming\n      } = this.props;\n      let checkIsValid = true;\n      let isSkip = true;\n      let filterMilestone = [];\n\n      if (milestones.length > 1) {\n        filterMilestone = milestones.filter((mile_item, index) => index !== editMileStone);\n        filterMilestone.forEach(mile => {\n          let validStart = moment(mile.from_date).isValid();\n          let validEnd = moment(mile.to_date).isValid();\n          let validStartInput = moment(time.from_date).isValid();\n          let validEndInput = moment(time.to_date).isValid();\n\n          if (validStart && validEnd) {\n            if (validStartInput && validEndInput) {\n              if (moment(time.from_date).isSameOrAfter(mile.from_date) && (moment(time.to_date).isSameOrBefore(mile.to_date) || moment(time.to_date).isSameOrAfter(mile.from_date))) {\n                checkIsValid = false;\n                isSkip = false;\n              }\n            }\n\n            if (validStartInput && !validEndInput) {\n              if (moment(time.from_date).isSameOrAfter(mile.from_date) && moment(time.from_date).isSameOrBefore(mile.to_date)) {\n                checkIsValid = false;\n                isSkip = false;\n              }\n            }\n          }\n\n          if (validStart && validStartInput && !validEnd) {\n            if (moment(time.from_date).isSame(mile.from_date) || moment(time.to_date).isSame(mile.from_date)) {\n              checkIsValid = false;\n              isSkip = false;\n            }\n          }\n\n          if (validEnd && validEndInput) {\n            if (moment(time.to_date).isSame(mile.to_date)) {\n              checkIsValid = false;\n              isSkip = false;\n            }\n          }\n        });\n      }\n\n      return {\n        checkIsValid,\n        skip: isSkip\n      };\n    };\n\n    this.handleChange = (name, value) => {\n      let error_clone = this.state.errors;\n\n      if (name === \"milestone_name\") {\n        value = value.trimLeft().replace(/[^a-zA-Z|0-9 ]/g, \"\");\n      }\n\n      if (name === \"recommended_hours\") {\n        value = value.trimLeft();\n      }\n\n      if (['milestone_name', 'from_date', 'recommended_hours'].includes(name)) {\n        error_clone[name] = this.isInvalid(name, value);\n      }\n\n      this.setState({ ...this.state,\n        [name]: value,\n        errors: error_clone\n      });\n    };\n\n    this.handleContinue = () => {\n      this.setItems();\n      this.props.handleStepForward(6);\n    };\n\n    this.setItems = () => {\n      const {\n        milestones,\n        handleStepMileStone,\n        newMileStoneScreen,\n        editMileStone\n      } = this.props;\n      let {\n        milestone_name,\n        from_date,\n        to_date,\n        isPhotoevidence,\n        recommended_hours,\n        errors\n      } = this.state;\n      let milestone_index = editMileStone;\n      handleStepMileStone({\n        \"milestone_name\": milestone_name,\n        \"isPhotoevidence\": isPhotoevidence,\n        \"from_date\": from_date,\n        // milestones[milestone_index]?.from_date || '',\n        \"to_date\": to_date,\n        //milestones[milestone_index]?.to_date || '',\n        \"recommended_hours\": recommended_hours\n      }, milestone_index);\n    };\n\n    this.checkHoursVal = (value, lable, name) => {\n      if (value === null || value === void 0 ? void 0 : value.length) {\n        if (value.match(pattern) !== null) {\n          let splitItem = value.split(':')[1];\n          let IntItem = +splitItem;\n          let conditionItem = IntItem % 15 === 0;\n\n          if (!conditionItem) {\n            return 'Time should be in mutiples of 15 like 10:15, 10:30';\n          }\n        } else {\n          return 'Please enter a valid pattern like : 10:15';\n        }\n      } else {\n        return `${label[name]} is required.`;\n      }\n    };\n\n    this.isInvalid = (name, value) => {\n      switch (name) {\n        case 'milestone_name':\n          return !value.length ? `${label[name]} is required.` : value.length > 50 ? 'Maximum 50 characters are allowed.' : '';\n\n        case 'from_date':\n          return !value.length ? `${label[name]} is required.` : '';\n\n        case 'recommended_hours':\n          return this.checkHoursVal(value, label, name);\n      }\n    };\n\n    this.checkErrors = () => {\n      var _filteredMiles$milest;\n\n      const {\n        milestones\n      } = this.props;\n      let filteredMiles = [];\n\n      if ((milestones === null || milestones === void 0 ? void 0 : milestones.length) && Array.isArray(milestones)) {\n        filteredMiles = milestones.filter(item => {\n          if (item === null || item === void 0 ? void 0 : item.milestone_name) {\n            return item;\n          }\n        });\n      }\n\n      let milestone_index = filteredMiles.length ? filteredMiles.length - 1 : 0;\n      let from_date = ((_filteredMiles$milest = filteredMiles[milestone_index]) === null || _filteredMiles$milest === void 0 ? void 0 : _filteredMiles$milest.from_date) || '';\n      let {\n        milestone_name,\n        recommended_hours,\n        errors: {\n          pattern_error\n        }\n      } = this.state;\n\n      if (milestone_name === null || milestone_name === void 0 ? void 0 : milestone_name.length) {\n        let errorItems = {};\n        let error_1 = this.isInvalid('milestone_name', milestone_name);\n        let error_2 = this.isInvalid('from_date', from_date);\n        let error_3 = this.isInvalid('recommended_hours', recommended_hours);\n        errorItems['milestone_name'] = error_1; // errorItems['from_date'] = error_2;\n\n        if (milestone_name === null || milestone_name === void 0 ? void 0 : milestone_name.length) {\n          errorItems['milestone_name'] = error_1;\n        }\n\n        if ((recommended_hours === null || recommended_hours === void 0 ? void 0 : recommended_hours.length) && (error_3 === null || error_3 === void 0 ? void 0 : error_3.length)) {\n          errorItems['recommended_hours'] = error_3;\n        }\n\n        if (JSON.stringify(this.state.errors) !== JSON.stringify(errorItems)) {\n          this.setState({\n            errors: errorItems\n          });\n        }\n\n        if (!(error_1 === null || error_1 === void 0 ? void 0 : error_1.length) && ((recommended_hours === null || recommended_hours === void 0 ? void 0 : recommended_hours.length) === 0 || !(pattern_error === null || pattern_error === void 0 ? void 0 : pattern_error.length))) {\n          return false;\n        }\n      }\n\n      return true;\n    };\n\n    this.renderTimeWithCustomFormat = (fromDate, toDate, format, formatSet) => {\n      if (moment(fromDate, format).isValid() && !moment(toDate, format).isValid()) {\n        return `${moment(fromDate, format).format('DD MMM')}`;\n      }\n\n      if (moment(fromDate, format).isValid() && moment(toDate, format).isValid()) {\n        let yearEnd = moment().endOf(\"year\").toISOString();\n        let monthEnd = moment(fromDate, format).endOf(\"month\").toISOString();\n        let item = moment(toDate, format).diff(moment(fromDate, format), 'months', true);\n        let item_year = moment(toDate, format).diff(moment(fromDate, format), 'years', true);\n        let monthDiff = parseInt(item.toString());\n        let yearDiff = parseInt(item_year.toString());\n\n        if (yearDiff > 0 || moment(toDate, format).isAfter(yearEnd) || moment(toDate, format).isAfter(yearEnd)) {\n          return `${moment(fromDate, format).format(formatSet[1])} - ${moment(toDate, format).format(formatSet[1])}`;\n        }\n\n        if (monthDiff > 0 || moment(toDate, format).isAfter(monthEnd)) {\n          return `${moment(fromDate, format).format(formatSet[0])} - ${moment(toDate, format).format(formatSet[0])}`;\n        }\n\n        return `${moment(fromDate, format).format(formatSet[0])} - ${moment(toDate, format).format(formatSet[0])}`;\n      }\n\n      return 'Choose';\n    };\n\n    this.state = {\n      milestone_name: '',\n      isPhotoevidence: true,\n      from_date: '',\n      to_date: '',\n      recommended_hours: '',\n      errors: {\n        milestone_name: '',\n        from_date: '',\n        recommended_hours: '',\n        pattern_error: ''\n      }\n    };\n  }\n\n  componentDidMount() {\n    const {\n      editMileStone,\n      milestones,\n      editMilestoneTiming\n    } = this.props;\n    let item = milestones[editMileStone];\n\n    if (item && Object.keys(item).length) {\n      let {\n        milestone_name,\n        isPhotoevidence,\n        from_date,\n        to_date,\n        recommended_hours\n      } = item;\n      let isValid = null;\n      let isSkip = null;\n\n      if (editMilestoneTiming && Object.keys(editMilestoneTiming).length) {\n        const {\n          checkIsValid,\n          skip\n        } = this.checkIsDateValid(milestones, editMilestoneTiming);\n        isValid = checkIsValid;\n        isSkip = skip;\n\n        if (isValid) {\n          if ('from_date' in editMilestoneTiming) {\n            from_date = editMilestoneTiming === null || editMilestoneTiming === void 0 ? void 0 : editMilestoneTiming.from_date;\n          }\n\n          if ('to_date' in editMilestoneTiming) {\n            to_date = editMilestoneTiming === null || editMilestoneTiming === void 0 ? void 0 : editMilestoneTiming.to_date;\n          }\n        }\n      }\n\n      this.setState({\n        from_date: from_date,\n        isPhotoevidence: isPhotoevidence === undefined ? false : isPhotoevidence,\n        milestone_name: milestone_name,\n        recommended_hours: recommended_hours,\n        to_date: to_date\n      }, () => {\n        if (isValid !== null) {\n          this.props.addTimeToMileStone({\n            from_date,\n            to_date\n          }, editMileStone, isSkip);\n        }\n      });\n    }\n  }\n\n  render() {\n    const {\n      handleStepForward,\n      handleStepBack,\n      milestones,\n      editMileStone\n    } = this.props;\n    let {\n      milestone_name,\n      isPhotoevidence,\n      recommended_hours,\n      from_date,\n      to_date,\n      errors\n    } = this.state;\n    let from_date_format = from_date;\n    let to_date_format = to_date;\n    let check_errors = this.checkErrors();\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"app_wrapper\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"section_wrapper\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"custom_container\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form_field\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex_row\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex_col_sm_5\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"relate\",\n                  children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"back\",\n                    onClick: () => {\n                      handleStepForward(6);\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 305,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"title\",\n                    children: `Edit Milestone ${editMileStone + 1}`\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 309,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 304,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 303,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 302,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex_row\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex_col_sm_5\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form_field\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"form_label\",\n                  children: \"Milestone name\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 319,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text_field\",\n                  children: /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"text\",\n                    placeholder: \"Enter Milestone name\",\n                    onChange: e => {\n                      this.handleChange('milestone_name', e.target.value);\n                    },\n                    value: milestone_name,\n                    name: \"milestone_name\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 321,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 320,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"error_msg\",\n                  children: errors === null || errors === void 0 ? void 0 : errors.milestone_name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 328,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 318,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form_field\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"checkbox_wrap agree_check\",\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    onChange: () => {\n                      this.handleChange('isPhotoevidence', !isPhotoevidence);\n                    },\n                    checked: isPhotoevidence,\n                    className: \"filter-type filled-in\",\n                    type: \"checkbox\",\n                    id: \"milestone1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 333,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"milestone1\",\n                    children: /*#__PURE__*/_jsxDEV(\"b\", {\n                      children: 'Photo evidence required'\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 340,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 339,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 332,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 330,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form_field\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"f_spacebw\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"form_label\",\n                    children: \"Duration of milestone (optional)\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 348,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => {\n                      handleStepForward(8);\n                    },\n                    className: \"fill_btn fill_grey_btn choose_btn\",\n                    children: this.renderTimeWithCustomFormat(from_date_format, to_date_format, 'MM-DD-YYYY', ['DD MMM', 'DD MMM YYYY'] // ['MMM DD', 'MMM DD YYYY'] // to keep the date format stable on front-end (TIC-2467)\n                    )\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 349,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 347,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 346,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form_field\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"form_label\",\n                  children: \"Estimated hours (optional)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 367,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text_field\",\n                  children: /*#__PURE__*/_jsxDEV(\"input\", {\n                    onChange: e => {\n                      this.setState({\n                        recommended_hours: e.target.value.trimLeft()\n                      }, () => {\n                        let rh_value = this.state.recommended_hours;\n                        let error_item = this.state.errors; // \"^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$\";\n\n                        if (!(rh_value === null || rh_value === void 0 ? void 0 : rh_value.length) || rh_value.match(pattern) !== null) {\n                          error_item['pattern_error'] = '';\n                          let splitItem = rh_value.split(':')[1];\n                          let IntItem = +splitItem;\n                          let conditionItem = IntItem % 15 === 0;\n\n                          if (!conditionItem) {\n                            error_item['pattern_error'] = 'Time should be in multiples of 15 like 10:15, 10:30';\n                          }\n                        } else {\n                          error_item['pattern_error'] = 'Please enter a valid pattern like : 10:15';\n                        }\n\n                        this.setState({\n                          errors: error_item\n                        });\n                      });\n                    } // onChange={(e) => { this.handleChange('recommended_hours', e.target.value) }}\n                    ,\n                    value: recommended_hours,\n                    autoComplete: \"off\",\n                    type: \"text\",\n                    placeholder: \"Enter Estimated hours\",\n                    name: \"recommended_hours\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 369,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 368,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"error_msg\",\n                  children: (recommended_hours === null || recommended_hours === void 0 ? void 0 : recommended_hours.length) === 0 ? '' : errors.recommended_hours\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 398,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"error_msg\",\n                  children: (recommended_hours === null || recommended_hours === void 0 ? void 0 : recommended_hours.length) === 0 ? '' : errors.pattern_error\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 399,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 366,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form_field\",\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: this.handleContinue // className=\"fill_btn full_btn\">\n                  ,\n                  className: `fill_btn full_btn btn-effect ${check_errors ? 'disable_btn' : ''}`,\n                  children: 'Continue'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 403,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 402,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 317,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 316,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 13\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["/home/appinventiv/Documents/Project/tickt/web/src/pages/postJob/components/editMileStone.tsx"],"names":["React","Component","moment","label","milestone_name","from_date","recommended_hours","pattern","EditMilestone","constructor","props","checkIsDateValid","milestones","time","editMileStone","editMilestoneTiming","checkIsValid","isSkip","filterMilestone","length","filter","mile_item","index","forEach","mile","validStart","isValid","validEnd","to_date","validStartInput","validEndInput","isSameOrAfter","isSameOrBefore","isSame","skip","handleChange","name","value","error_clone","state","errors","trimLeft","replace","includes","isInvalid","setState","handleContinue","setItems","handleStepForward","handleStepMileStone","newMileStoneScreen","isPhotoevidence","milestone_index","checkHoursVal","lable","match","splitItem","split","IntItem","conditionItem","checkErrors","filteredMiles","Array","isArray","item","pattern_error","errorItems","error_1","error_2","error_3","JSON","stringify","renderTimeWithCustomFormat","fromDate","toDate","format","formatSet","yearEnd","endOf","toISOString","monthEnd","diff","item_year","monthDiff","parseInt","toString","yearDiff","isAfter","componentDidMount","Object","keys","undefined","addTimeToMileStone","render","handleStepBack","from_date_format","to_date_format","check_errors","e","target","rh_value","error_item"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,MAAP,MAAmB,QAAnB;;AAyBA;AACA,MAAMC,KAAkC,GAAG;AACvCC,EAAAA,cAAc,EAAE,gBADuB;AAEvCC,EAAAA,SAAS,EAAE,WAF4B;AAGvCC,EAAAA,iBAAiB,EAAE;AAHoB,CAA3C;AAMA,MAAMC,OAAO,GAAG,6CAAhB;AACA,eAAe,MAAMC,aAAN,SAA4BP,SAA5B,CAAoD;AAC/DQ,EAAAA,WAAW,CAACC,KAAD,EAAa;AACpB,UAAMA,KAAN;;AADoB,SAiBxBC,gBAjBwB,GAiBL,CAACC,UAAD,EAAkBC,IAAlB,KAAgC;AAC/C,YAAM;AAAEC,QAAAA,aAAF;AAAiBC,QAAAA;AAAjB,UAAyC,KAAKL,KAApD;AACA,UAAIM,YAAiB,GAAG,IAAxB;AACA,UAAIC,MAAW,GAAG,IAAlB;AAEA,UAAIC,eAAoB,GAAG,EAA3B;;AAEA,UAAIN,UAAU,CAACO,MAAX,GAAoB,CAAxB,EAA2B;AACvBD,QAAAA,eAAe,GAAGN,UAAU,CAACQ,MAAX,CAAkB,CAACC,SAAD,EAAiBC,KAAjB,KAAgCA,KAAK,KAAKR,aAA5D,CAAlB;AACAI,QAAAA,eAAe,CAACK,OAAhB,CAAyBC,IAAD,IAAe;AACnC,cAAIC,UAAU,GAAGvB,MAAM,CAACsB,IAAI,CAACnB,SAAN,CAAN,CAAuBqB,OAAvB,EAAjB;AACA,cAAIC,QAAQ,GAAGzB,MAAM,CAACsB,IAAI,CAACI,OAAN,CAAN,CAAqBF,OAArB,EAAf;AAEA,cAAIG,eAAe,GAAG3B,MAAM,CAACW,IAAI,CAACR,SAAN,CAAN,CAAuBqB,OAAvB,EAAtB;AACA,cAAII,aAAa,GAAG5B,MAAM,CAACW,IAAI,CAACe,OAAN,CAAN,CAAqBF,OAArB,EAApB;;AAEA,cAAID,UAAU,IAAIE,QAAlB,EAA4B;AACxB,gBAAIE,eAAe,IAAIC,aAAvB,EAAsC;AAClC,kBAAI5B,MAAM,CAACW,IAAI,CAACR,SAAN,CAAN,CAAuB0B,aAAvB,CAAqCP,IAAI,CAACnB,SAA1C,MAAyDH,MAAM,CAACW,IAAI,CAACe,OAAN,CAAN,CAAqBI,cAArB,CAAoCR,IAAI,CAACI,OAAzC,KACzD1B,MAAM,CAACW,IAAI,CAACe,OAAN,CAAN,CAAqBG,aAArB,CAAmCP,IAAI,CAACnB,SAAxC,CADA,CAAJ,EAEE;AACEW,gBAAAA,YAAY,GAAG,KAAf;AACAC,gBAAAA,MAAM,GAAG,KAAT;AACH;AACJ;;AAED,gBAAIY,eAAe,IAAI,CAACC,aAAxB,EAAuC;AACnC,kBACI5B,MAAM,CAACW,IAAI,CAACR,SAAN,CAAN,CAAuB0B,aAAvB,CAAqCP,IAAI,CAACnB,SAA1C,KACAH,MAAM,CAACW,IAAI,CAACR,SAAN,CAAN,CAAuB2B,cAAvB,CAAsCR,IAAI,CAACI,OAA3C,CAFJ,EAEyD;AACrDZ,gBAAAA,YAAY,GAAG,KAAf;AACAC,gBAAAA,MAAM,GAAG,KAAT;AACH;AACJ;AACJ;;AAED,cAAIQ,UAAU,IAAII,eAAd,IAAiC,CAACF,QAAtC,EAAgD;AAC5C,gBAAIzB,MAAM,CAACW,IAAI,CAACR,SAAN,CAAN,CAAuB4B,MAAvB,CAA8BT,IAAI,CAACnB,SAAnC,KAAiDH,MAAM,CAACW,IAAI,CAACe,OAAN,CAAN,CAAqBK,MAArB,CAA4BT,IAAI,CAACnB,SAAjC,CAArD,EAAkG;AAC9FW,cAAAA,YAAY,GAAG,KAAf;AACAC,cAAAA,MAAM,GAAG,KAAT;AACH;AACJ;;AAED,cAAIU,QAAQ,IAAIG,aAAhB,EAA+B;AAC3B,gBAAI5B,MAAM,CAACW,IAAI,CAACe,OAAN,CAAN,CAAqBK,MAArB,CAA4BT,IAAI,CAACI,OAAjC,CAAJ,EAA+C;AAC3CZ,cAAAA,YAAY,GAAG,KAAf;AACAC,cAAAA,MAAM,GAAG,KAAT;AACH;AACJ;AAEJ,SAzCD;AA0CH;;AACD,aAAO;AAAED,QAAAA,YAAF;AAAgBkB,QAAAA,IAAI,EAAEjB;AAAtB,OAAP;AACH,KAtEuB;;AAAA,SAmHxBkB,YAnHwB,GAmHT,CAACC,IAAD,EAAeC,KAAf,KAA8B;AACzC,UAAIC,WAAgB,GAAG,KAAKC,KAAL,CAAWC,MAAlC;;AAGA,UAAIJ,IAAI,KAAK,gBAAb,EAA+B;AAC3BC,QAAAA,KAAK,GAAIA,KAAD,CAAQI,QAAR,GAAmBC,OAAnB,CAA2B,iBAA3B,EAA8C,EAA9C,CAAR;AACH;;AAED,UAAIN,IAAI,KAAK,mBAAb,EAAkC;AAC9BC,QAAAA,KAAK,GAAIA,KAAD,CAAQI,QAAR,EAAR;AACH;;AAGD,UAAI,CAAC,gBAAD,EAAmB,WAAnB,EAAgC,mBAAhC,EAAqDE,QAArD,CAA8DP,IAA9D,CAAJ,EAAyE;AACrEE,QAAAA,WAAW,CAACF,IAAD,CAAX,GAAoB,KAAKQ,SAAL,CAAeR,IAAf,EAAqBC,KAArB,CAApB;AACH;;AACD,WAAKQ,QAAL,CAAc,EAAE,GAAG,KAAKN,KAAV;AAAiB,SAACH,IAAD,GAAQC,KAAzB;AAAgCG,QAAAA,MAAM,EAAEF;AAAxC,OAAd;AACH,KApIuB;;AAAA,SAsIxBQ,cAtIwB,GAsIP,MAAM;AACnB,WAAKC,QAAL;AACA,WAAKrC,KAAL,CAAWsC,iBAAX,CAA6B,CAA7B;AACH,KAzIuB;;AAAA,SA4IxBD,QA5IwB,GA4Ib,MAAM;AACb,YAAM;AAAEnC,QAAAA,UAAF;AAAcqC,QAAAA,mBAAd;AAAmCC,QAAAA,kBAAnC;AAAuDpC,QAAAA;AAAvD,UAAyE,KAAKJ,KAApF;AACA,UAAI;AAAEN,QAAAA,cAAF;AAAkBC,QAAAA,SAAlB;AAA6BuB,QAAAA,OAA7B;AAAsCuB,QAAAA,eAAtC;AAAuD7C,QAAAA,iBAAvD;AAA0EkC,QAAAA;AAA1E,UAAqF,KAAKD,KAA9F;AACA,UAAIa,eAAe,GAAGtC,aAAtB;AACAmC,MAAAA,mBAAmB,CAAC;AAChB,0BAAkB7C,cADF;AAEhB,2BAAmB+C,eAFH;AAGhB,qBAAa9C,SAHG;AAGQ;AACxB,mBAAWuB,OAJK;AAII;AACpB,6BAAqBtB;AALL,OAAD,EAMhB8C,eANgB,CAAnB;AAOH,KAvJuB;;AAAA,SA0JxBC,aA1JwB,GA0JR,CAAChB,KAAD,EAAaiB,KAAb,EAAyBlB,IAAzB,KAAuC;AACnD,UAAIC,KAAJ,aAAIA,KAAJ,uBAAIA,KAAK,CAAElB,MAAX,EAAmB;AACf,YAAIkB,KAAK,CAACkB,KAAN,CAAYhD,OAAZ,MAAyB,IAA7B,EAAmC;AAC/B,cAAIiD,SAAS,GAAGnB,KAAK,CAACoB,KAAN,CAAY,GAAZ,EAAiB,CAAjB,CAAhB;AACA,cAAIC,OAAO,GAAG,CAACF,SAAf;AACA,cAAIG,aAAa,GAAGD,OAAO,GAAG,EAAV,KAAiB,CAArC;;AAEA,cAAI,CAACC,aAAL,EAAoB;AAChB,mBAAO,oDAAP;AACH;AACJ,SARD,MAQO;AACH,iBAAO,2CAAP;AACH;AACJ,OAZD,MAYO;AACH,eAAQ,GAAExD,KAAK,CAACiC,IAAD,CAAO,eAAtB;AACH;AACJ,KA1KuB;;AAAA,SA4KxBQ,SA5KwB,GA4KZ,CAACR,IAAD,EAAeC,KAAf,KAAiC;AACzC,cAAQD,IAAR;AACI,aAAK,gBAAL;AACI,iBAAO,CAACC,KAAK,CAAClB,MAAP,GAAiB,GAAEhB,KAAK,CAACiC,IAAD,CAAO,eAA/B,GAAgDC,KAAK,CAAClB,MAAN,GAAe,EAAf,GAAoB,oCAApB,GAA2D,EAAlH;;AACJ,aAAK,WAAL;AACI,iBAAO,CAACkB,KAAK,CAAClB,MAAP,GAAiB,GAAEhB,KAAK,CAACiC,IAAD,CAAO,eAA/B,GAAgD,EAAvD;;AACJ,aAAK,mBAAL;AACI,iBAAO,KAAKiB,aAAL,CAAmBhB,KAAnB,EAA0BlC,KAA1B,EAAiCiC,IAAjC,CAAP;AANR;AAQH,KArLuB;;AAAA,SAuLxBwB,WAvLwB,GAuLV,MAAM;AAAA;;AAChB,YAAM;AAAEhD,QAAAA;AAAF,UAAiB,KAAKF,KAA5B;AAEA,UAAImD,aAAa,GAAG,EAApB;;AACA,UAAI,CAAAjD,UAAU,SAAV,IAAAA,UAAU,WAAV,YAAAA,UAAU,CAAEO,MAAZ,KAAsB2C,KAAK,CAACC,OAAN,CAAcnD,UAAd,CAA1B,EAAqD;AACjDiD,QAAAA,aAAa,GAAGjD,UAAU,CAACQ,MAAX,CAAmB4C,IAAD,IAAe;AAC7C,cAAIA,IAAJ,aAAIA,IAAJ,uBAAIA,IAAI,CAAE5D,cAAV,EAA0B;AACtB,mBAAO4D,IAAP;AACH;AACJ,SAJe,CAAhB;AAKH;;AAED,UAAIZ,eAAe,GAAGS,aAAa,CAAC1C,MAAd,GAAuB0C,aAAa,CAAC1C,MAAd,GAAuB,CAA9C,GAAkD,CAAxE;AACA,UAAId,SAAS,GAAG,0BAAAwD,aAAa,CAACT,eAAD,CAAb,gFAAgC/C,SAAhC,KAA6C,EAA7D;AACA,UAAI;AAAED,QAAAA,cAAF;AAAkBE,QAAAA,iBAAlB;AAAqCkC,QAAAA,MAAM,EAAE;AAAEyB,UAAAA;AAAF;AAA7C,UAAmE,KAAK1B,KAA5E;;AACA,UAAInC,cAAJ,aAAIA,cAAJ,uBAAIA,cAAc,CAAEe,MAApB,EAA4B;AACxB,YAAI+C,UAAe,GAAG,EAAtB;AACA,YAAIC,OAAO,GAAG,KAAKvB,SAAL,CAAe,gBAAf,EAAiCxC,cAAjC,CAAd;AACA,YAAIgE,OAAO,GAAG,KAAKxB,SAAL,CAAe,WAAf,EAA4BvC,SAA5B,CAAd;AACA,YAAIgE,OAAO,GAAG,KAAKzB,SAAL,CAAe,mBAAf,EAAoCtC,iBAApC,CAAd;AACA4D,QAAAA,UAAU,CAAC,gBAAD,CAAV,GAA+BC,OAA/B,CALwB,CAMxB;;AAEA,YAAI/D,cAAJ,aAAIA,cAAJ,uBAAIA,cAAc,CAAEe,MAApB,EAA4B;AACxB+C,UAAAA,UAAU,CAAC,gBAAD,CAAV,GAA+BC,OAA/B;AACH;;AAED,YAAI,CAAA7D,iBAAiB,SAAjB,IAAAA,iBAAiB,WAAjB,YAAAA,iBAAiB,CAAEa,MAAnB,MAA6BkD,OAA7B,aAA6BA,OAA7B,uBAA6BA,OAAO,CAAElD,MAAtC,CAAJ,EAAkD;AAC9C+C,UAAAA,UAAU,CAAC,mBAAD,CAAV,GAAkCG,OAAlC;AACH;;AAED,YAAIC,IAAI,CAACC,SAAL,CAAe,KAAKhC,KAAL,CAAWC,MAA1B,MAAsC8B,IAAI,CAACC,SAAL,CAAeL,UAAf,CAA1C,EAAsE;AAClE,eAAKrB,QAAL,CAAc;AAAEL,YAAAA,MAAM,EAAE0B;AAAV,WAAd;AACH;;AAED,YAAI,EAACC,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAEhD,MAAV,MAAqB,CAAAb,iBAAiB,SAAjB,IAAAA,iBAAiB,WAAjB,YAAAA,iBAAiB,CAAEa,MAAnB,MAA8B,CAA9B,IAAmC,EAAC8C,aAAD,aAACA,aAAD,uBAACA,aAAa,CAAE9C,MAAhB,CAAxD,CAAJ,EAAqF;AACjF,iBAAO,KAAP;AACH;AACJ;;AACD,aAAO,IAAP;AACH,KA/NuB;;AAAA,SAiOxBqD,0BAjOwB,GAiOK,CAACC,QAAD,EAAgBC,MAAhB,EAA6BC,MAA7B,EAA0CC,SAA1C,KAA8D;AAEvF,UAAI1E,MAAM,CAACuE,QAAD,EAAWE,MAAX,CAAN,CAAyBjD,OAAzB,MAAsC,CAACxB,MAAM,CAACwE,MAAD,EAASC,MAAT,CAAN,CAAuBjD,OAAvB,EAA3C,EAA6E;AACzE,eAAQ,GAAExB,MAAM,CAACuE,QAAD,EAAWE,MAAX,CAAN,CAAyBA,MAAzB,CAAgC,QAAhC,CAA0C,EAApD;AACH;;AAED,UAAIzE,MAAM,CAACuE,QAAD,EAAWE,MAAX,CAAN,CAAyBjD,OAAzB,MAAsCxB,MAAM,CAACwE,MAAD,EAASC,MAAT,CAAN,CAAuBjD,OAAvB,EAA1C,EAA4E;AACxE,YAAImD,OAAO,GAAG3E,MAAM,GAAG4E,KAAT,CAAe,MAAf,EAAuBC,WAAvB,EAAd;AACA,YAAIC,QAAQ,GAAG9E,MAAM,CAACuE,QAAD,EAAWE,MAAX,CAAN,CAAyBG,KAAzB,CAA+B,OAA/B,EAAwCC,WAAxC,EAAf;AAEA,YAAIf,IAAS,GAAG9D,MAAM,CAACwE,MAAD,EAASC,MAAT,CAAN,CAAuBM,IAAvB,CAA4B/E,MAAM,CAACuE,QAAD,EAAWE,MAAX,CAAlC,EAAsD,QAAtD,EAAgE,IAAhE,CAAhB;AACA,YAAIO,SAAc,GAAGhF,MAAM,CAACwE,MAAD,EAASC,MAAT,CAAN,CAAuBM,IAAvB,CAA4B/E,MAAM,CAACuE,QAAD,EAAWE,MAAX,CAAlC,EAAsD,OAAtD,EAA+D,IAA/D,CAArB;AAEA,YAAIQ,SAAS,GAAGC,QAAQ,CAACpB,IAAI,CAACqB,QAAL,EAAD,CAAxB;AACA,YAAIC,QAAQ,GAAGF,QAAQ,CAACF,SAAS,CAACG,QAAV,EAAD,CAAvB;;AAEA,YAAIC,QAAQ,GAAG,CAAX,IAAgBpF,MAAM,CAACwE,MAAD,EAASC,MAAT,CAAN,CAAuBY,OAAvB,CAA+BV,OAA/B,CAAhB,IAA2D3E,MAAM,CAACwE,MAAD,EAASC,MAAT,CAAN,CAAuBY,OAAvB,CAA+BV,OAA/B,CAA/D,EAAwG;AACpG,iBAAQ,GAAE3E,MAAM,CAACuE,QAAD,EAAWE,MAAX,CAAN,CAAyBA,MAAzB,CAAgCC,SAAS,CAAC,CAAD,CAAzC,CAA8C,MAAK1E,MAAM,CAACwE,MAAD,EAASC,MAAT,CAAN,CAAuBA,MAAvB,CAA8BC,SAAS,CAAC,CAAD,CAAvC,CAA4C,EAAzG;AACH;;AACD,YAAIO,SAAS,GAAG,CAAZ,IAAiBjF,MAAM,CAACwE,MAAD,EAASC,MAAT,CAAN,CAAuBY,OAAvB,CAA+BP,QAA/B,CAArB,EAA+D;AAC3D,iBAAQ,GAAE9E,MAAM,CAACuE,QAAD,EAAWE,MAAX,CAAN,CAAyBA,MAAzB,CAAgCC,SAAS,CAAC,CAAD,CAAzC,CAA8C,MAAK1E,MAAM,CAACwE,MAAD,EAASC,MAAT,CAAN,CAAuBA,MAAvB,CAA8BC,SAAS,CAAC,CAAD,CAAvC,CAA4C,EAAzG;AACH;;AACD,eAAQ,GAAE1E,MAAM,CAACuE,QAAD,EAAWE,MAAX,CAAN,CAAyBA,MAAzB,CAAgCC,SAAS,CAAC,CAAD,CAAzC,CAA8C,MAAK1E,MAAM,CAACwE,MAAD,EAASC,MAAT,CAAN,CAAuBA,MAAvB,CAA8BC,SAAS,CAAC,CAAD,CAAvC,CAA4C,EAAzG;AACH;;AAED,aAAO,QAAP;AACH,KA3PuB;;AAEpB,SAAKrC,KAAL,GAAa;AACTnC,MAAAA,cAAc,EAAE,EADP;AAET+C,MAAAA,eAAe,EAAE,IAFR;AAGT9C,MAAAA,SAAS,EAAE,EAHF;AAITuB,MAAAA,OAAO,EAAE,EAJA;AAKTtB,MAAAA,iBAAiB,EAAE,EALV;AAMTkC,MAAAA,MAAM,EAAE;AACJpC,QAAAA,cAAc,EAAE,EADZ;AAEJC,QAAAA,SAAS,EAAE,EAFP;AAGJC,QAAAA,iBAAiB,EAAE,EAHf;AAIJ2D,QAAAA,aAAa,EAAE;AAJX;AANC,KAAb;AAaH;;AAyDDuB,EAAAA,iBAAiB,GAAG;AAChB,UAAM;AAAE1E,MAAAA,aAAF;AAAiBF,MAAAA,UAAjB;AAA6BG,MAAAA;AAA7B,QAAqD,KAAKL,KAAhE;AACA,QAAIsD,IAAI,GAAGpD,UAAU,CAACE,aAAD,CAArB;;AAEA,QAAIkD,IAAI,IAAIyB,MAAM,CAACC,IAAP,CAAY1B,IAAZ,EAAkB7C,MAA9B,EAAsC;AAClC,UAAI;AAAEf,QAAAA,cAAF;AAAkB+C,QAAAA,eAAlB;AAAmC9C,QAAAA,SAAnC;AAA8CuB,QAAAA,OAA9C;AAAuDtB,QAAAA;AAAvD,UAA6E0D,IAAjF;AAEA,UAAItC,OAAY,GAAG,IAAnB;AACA,UAAIT,MAAW,GAAG,IAAlB;;AAEA,UAAIF,mBAAmB,IAAI0E,MAAM,CAACC,IAAP,CAAY3E,mBAAZ,EAAiCI,MAA5D,EAAoE;AAChE,cAAM;AAAEH,UAAAA,YAAF;AAAgBkB,UAAAA;AAAhB,YAAyB,KAAKvB,gBAAL,CAAsBC,UAAtB,EAAkCG,mBAAlC,CAA/B;AACAW,QAAAA,OAAO,GAAGV,YAAV;AACAC,QAAAA,MAAM,GAAGiB,IAAT;;AAEA,YAAIR,OAAJ,EAAa;AACT,cAAI,eAAeX,mBAAnB,EAAwC;AACpCV,YAAAA,SAAS,GAAGU,mBAAH,aAAGA,mBAAH,uBAAGA,mBAAmB,CAAEV,SAAjC;AACH;;AACD,cAAI,aAAaU,mBAAjB,EAAsC;AAClCa,YAAAA,OAAO,GAAGb,mBAAH,aAAGA,mBAAH,uBAAGA,mBAAmB,CAAEa,OAA/B;AACH;AACJ;AACJ;;AAED,WAAKiB,QAAL,CAAc;AACVxC,QAAAA,SAAS,EAAEA,SADD;AAEV8C,QAAAA,eAAe,EAAEA,eAAe,KAAKwC,SAApB,GAAgC,KAAhC,GAAwCxC,eAF/C;AAGV/C,QAAAA,cAAc,EAAEA,cAHN;AAIVE,QAAAA,iBAAiB,EAAEA,iBAJT;AAKVsB,QAAAA,OAAO,EAAEA;AALC,OAAd,EAMG,MAAM;AACL,YAAIF,OAAO,KAAK,IAAhB,EAAsB;AAClB,eAAKhB,KAAL,CAAWkF,kBAAX,CACI;AAAEvF,YAAAA,SAAF;AAAauB,YAAAA;AAAb,WADJ,EAEId,aAFJ,EAGIG,MAHJ;AAKH;AACJ,OAdD;AAeH;AACJ;;AA4ID4E,EAAAA,MAAM,GAAG;AACL,UAAM;AAAE7C,MAAAA,iBAAF;AAAqB8C,MAAAA,cAArB;AAAqClF,MAAAA,UAArC;AAAiDE,MAAAA;AAAjD,QAAmE,KAAKJ,KAA9E;AACA,QAAI;AAAEN,MAAAA,cAAF;AAAkB+C,MAAAA,eAAlB;AAAmC7C,MAAAA,iBAAnC;AAAsDD,MAAAA,SAAtD;AAAiEuB,MAAAA,OAAjE;AAA0EY,MAAAA;AAA1E,QAAqF,KAAKD,KAA9F;AACA,QAAIwD,gBAAgB,GAAG1F,SAAvB;AACA,QAAI2F,cAAc,GAAGpE,OAArB;AAEA,QAAIqE,YAAY,GAAG,KAAKrC,WAAL,EAAnB;AAEA,wBACI;AAAK,MAAA,SAAS,EAAC,aAAf;AAAA,6BACI;AAAK,QAAA,SAAS,EAAC,iBAAf;AAAA,+BACI;AAAK,UAAA,SAAS,EAAC,kBAAf;AAAA,kCACI;AAAK,YAAA,SAAS,EAAC,YAAf;AAAA,mCACI;AAAK,cAAA,SAAS,EAAC,UAAf;AAAA,qCACI;AAAK,gBAAA,SAAS,EAAC,eAAf;AAAA,uCACI;AAAK,kBAAA,SAAS,EAAC,QAAf;AAAA,0CACI;AACI,oBAAA,SAAS,EAAC,MADd;AAEI,oBAAA,OAAO,EAAE,MAAM;AAAEZ,sBAAAA,iBAAiB,CAAC,CAAD,CAAjB;AAAsB;AAF3C;AAAA;AAAA;AAAA;AAAA,0BADJ,eAKI;AAAM,oBAAA,SAAS,EAAC,OAAhB;AAAA,8BACM,kBAAiBlC,aAAa,GAAG,CAAE;AADzC;AAAA;AAAA;AAAA;AAAA,0BALJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,kBADJ,eAgBI;AAAK,YAAA,SAAS,EAAC,UAAf;AAAA,mCACI;AAAK,cAAA,SAAS,EAAC,eAAf;AAAA,sCACI;AAAK,gBAAA,SAAS,EAAC,YAAf;AAAA,wCACI;AAAO,kBAAA,SAAS,EAAC,YAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADJ,eAEI;AAAK,kBAAA,SAAS,EAAC,YAAf;AAAA,yCACI;AACI,oBAAA,IAAI,EAAC,MADT;AAEI,oBAAA,WAAW,EAAC,sBAFhB;AAGI,oBAAA,QAAQ,EAAGoF,CAAD,IAAO;AAAE,2BAAK/D,YAAL,CAAkB,gBAAlB,EAAoC+D,CAAC,CAACC,MAAF,CAAS9D,KAA7C;AAAqD,qBAH5E;AAII,oBAAA,KAAK,EAAEjC,cAJX;AAKI,oBAAA,IAAI,EAAC;AALT;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,wBAFJ,eAUI;AAAM,kBAAA,SAAS,EAAC,WAAhB;AAAA,4BAA6BoC,MAA7B,aAA6BA,MAA7B,uBAA6BA,MAAM,CAAEpC;AAArC;AAAA;AAAA;AAAA;AAAA,wBAVJ;AAAA;AAAA;AAAA;AAAA;AAAA,sBADJ,eAaI;AAAK,gBAAA,SAAS,EAAC,YAAf;AAAA,uCAEI;AAAK,kBAAA,SAAS,EAAC,2BAAf;AAAA,0CACI;AACI,oBAAA,QAAQ,EAAE,MAAM;AAAE,2BAAK+B,YAAL,CAAkB,iBAAlB,EAAqC,CAACgB,eAAtC;AAAwD,qBAD9E;AAEI,oBAAA,OAAO,EAAEA,eAFb;AAGI,oBAAA,SAAS,EAAC,uBAHd;AAII,oBAAA,IAAI,EAAC,UAJT;AAKI,oBAAA,EAAE,EAAC;AALP;AAAA;AAAA;AAAA;AAAA,0BADJ,eAOI;AAAO,oBAAA,OAAO,EAAC,YAAf;AAAA,2CACI;AAAA,gCACK;AADL;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,0BAPJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAFJ;AAAA;AAAA;AAAA;AAAA,sBAbJ,eA6BI;AAAK,gBAAA,SAAS,EAAC,YAAf;AAAA,uCACI;AAAK,kBAAA,SAAS,EAAC,WAAf;AAAA,0CACI;AAAO,oBAAA,SAAS,EAAC,YAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BADJ,eAEI;AACI,oBAAA,OAAO,EAAE,MAAM;AAAEH,sBAAAA,iBAAiB,CAAC,CAAD,CAAjB;AAAsB,qBAD3C;AAEI,oBAAA,SAAS,EAAC,mCAFd;AAAA,8BAGK,KAAKwB,0BAAL,CACGuB,gBADH,EAEGC,cAFH,EAGG,YAHH,EAIG,CAAC,QAAD,EAAW,aAAX,CAJH,CAKG;AALH;AAHL;AAAA;AAAA;AAAA;AAAA,0BAFJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,sBA7BJ,eAiDI;AAAK,gBAAA,SAAS,EAAC,YAAf;AAAA,wCACI;AAAO,kBAAA,SAAS,EAAC,YAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADJ,eAEI;AAAK,kBAAA,SAAS,EAAC,YAAf;AAAA,yCACI;AACI,oBAAA,QAAQ,EAAGE,CAAD,IAAO;AACb,2BAAKrD,QAAL,CAAc;AAAEvC,wBAAAA,iBAAiB,EAAG4F,CAAC,CAACC,MAAF,CAAS9D,KAAV,CAAiBI,QAAjB;AAArB,uBAAd,EAAkE,MAAM;AACpE,4BAAI2D,QAAQ,GAAG,KAAK7D,KAAL,CAAWjC,iBAA1B;AACA,4BAAI+F,UAAU,GAAG,KAAK9D,KAAL,CAAWC,MAA5B,CAFoE,CAIpE;;AAEA,4BAAI,EAAC4D,QAAD,aAACA,QAAD,uBAACA,QAAQ,CAAEjF,MAAX,KAAqBiF,QAAQ,CAAC7C,KAAT,CAAehD,OAAf,MAA4B,IAArD,EAA2D;AACvD8F,0BAAAA,UAAU,CAAC,eAAD,CAAV,GAA8B,EAA9B;AACA,8BAAI7C,SAAS,GAAG4C,QAAQ,CAAC3C,KAAT,CAAe,GAAf,EAAoB,CAApB,CAAhB;AACA,8BAAIC,OAAO,GAAG,CAACF,SAAf;AACA,8BAAIG,aAAa,GAAGD,OAAO,GAAG,EAAV,KAAiB,CAArC;;AACA,8BAAI,CAACC,aAAL,EAAoB;AAChB0C,4BAAAA,UAAU,CAAC,eAAD,CAAV,GAA8B,qDAA9B;AACH;AACJ,yBARD,MAQO;AACHA,0BAAAA,UAAU,CAAC,eAAD,CAAV,GAA8B,2CAA9B;AACH;;AACD,6BAAKxD,QAAL,CAAc;AAAEL,0BAAAA,MAAM,EAAE6D;AAAV,yBAAd;AACH,uBAlBD;AAmBH,qBArBL,CAsBI;AAtBJ;AAuBI,oBAAA,KAAK,EAAE/F,iBAvBX;AAwBI,oBAAA,YAAY,EAAC,KAxBjB;AAyBI,oBAAA,IAAI,EAAC,MAzBT;AA0BI,oBAAA,WAAW,EAAC,uBA1BhB;AA2BI,oBAAA,IAAI,EAAC;AA3BT;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,wBAFJ,eAgCI;AAAM,kBAAA,SAAS,EAAC,WAAhB;AAAA,4BAA6B,CAAAA,iBAAiB,SAAjB,IAAAA,iBAAiB,WAAjB,YAAAA,iBAAiB,CAAEa,MAAnB,MAA8B,CAA9B,GAAkC,EAAlC,GAAuCqB,MAAM,CAAClC;AAA3E;AAAA;AAAA;AAAA;AAAA,wBAhCJ,eAiCI;AAAM,kBAAA,SAAS,EAAC,WAAhB;AAAA,4BAA6B,CAAAA,iBAAiB,SAAjB,IAAAA,iBAAiB,WAAjB,YAAAA,iBAAiB,CAAEa,MAAnB,MAA8B,CAA9B,GAAkC,EAAlC,GAAuCqB,MAAM,CAACyB;AAA3E;AAAA;AAAA;AAAA;AAAA,wBAjCJ;AAAA;AAAA;AAAA;AAAA;AAAA,sBAjDJ,eAqFI;AAAK,gBAAA,SAAS,EAAC,YAAf;AAAA,uCACI;AACI,kBAAA,OAAO,EAAE,KAAKnB,cADlB,CAEI;AAFJ;AAGI,kBAAA,SAAS,EAAG,gCAA+BmD,YAAY,GAAG,aAAH,GAAmB,EAAG,EAHjF;AAAA,4BAIK;AAJL;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,sBArFJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,kBAhBJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,YADJ;AAwHH;;AA9X8D","sourcesContent":["import React, { Component } from 'react';\nimport moment from 'moment';\n\ninterface Props {\n    data: any;\n    stepCompleted: Boolean;\n    editMileStone: any;\n    editMilestoneTiming: any;\n    handleStepComplete: (data: any) => void;\n    addTimeToMileStone: (data: any, index: any, skip?: any) => void;\n    handleStepForward: (data: any) => void;\n    newMileStoneScreen: (data: any) => void;\n    handleStepMileStone: (data: any, index: any) => void;\n    handleStepBack: () => void;\n    milestones: any;\n}\n\ninterface State {\n    milestone_name: string,\n    isPhotoevidence: boolean,\n    from_date: string,\n    to_date: string,\n    recommended_hours: any\n    errors: any;\n}\n\n// for error messages\nconst label: { [index: string]: string } = {\n    milestone_name: 'Milestone Name',\n    from_date: 'From Date',\n    recommended_hours: 'Recommended Hours',\n}\n\nconst pattern = \"^([0-9][0-9]?[0-9]?[0-9]?[0-9]):[0-9][0-9]$\";\nexport default class EditMilestone extends Component<Props, State> {\n    constructor(props: any) {\n        super(props)\n        this.state = {\n            milestone_name: '',\n            isPhotoevidence: true,\n            from_date: '',\n            to_date: '',\n            recommended_hours: '',\n            errors: {\n                milestone_name: '',\n                from_date: '',\n                recommended_hours: '',\n                pattern_error: ''\n            }\n        }\n    }\n\n    checkIsDateValid = (milestones: any, time: any) => {\n        const { editMileStone, editMilestoneTiming } = this.props;\n        let checkIsValid: any = true;\n        let isSkip: any = true;\n\n        let filterMilestone: any = [];\n\n        if (milestones.length > 1) {\n            filterMilestone = milestones.filter((mile_item: any, index: any) => index !== editMileStone);\n            filterMilestone.forEach((mile: any) => {\n                let validStart = moment(mile.from_date).isValid();\n                let validEnd = moment(mile.to_date).isValid();\n\n                let validStartInput = moment(time.from_date).isValid();\n                let validEndInput = moment(time.to_date).isValid();\n\n                if (validStart && validEnd) {\n                    if (validStartInput && validEndInput) {\n                        if (moment(time.from_date).isSameOrAfter(mile.from_date) && (moment(time.to_date).isSameOrBefore(mile.to_date) ||\n                            moment(time.to_date).isSameOrAfter(mile.from_date))\n                        ) {\n                            checkIsValid = false;\n                            isSkip = false;\n                        }\n                    }\n\n                    if (validStartInput && !validEndInput) {\n                        if (\n                            moment(time.from_date).isSameOrAfter(mile.from_date) &&\n                            moment(time.from_date).isSameOrBefore(mile.to_date)) {\n                            checkIsValid = false;\n                            isSkip = false;\n                        }\n                    }\n                }\n\n                if (validStart && validStartInput && !validEnd) {\n                    if (moment(time.from_date).isSame(mile.from_date) || moment(time.to_date).isSame(mile.from_date)) {\n                        checkIsValid = false;\n                        isSkip = false;\n                    }\n                }\n\n                if (validEnd && validEndInput) {\n                    if (moment(time.to_date).isSame(mile.to_date)) {\n                        checkIsValid = false;\n                        isSkip = false;\n                    }\n                }\n\n            });\n        }\n        return { checkIsValid, skip: isSkip };\n    }\n\n    componentDidMount() {\n        const { editMileStone, milestones, editMilestoneTiming } = this.props;\n        let item = milestones[editMileStone];\n\n        if (item && Object.keys(item).length) {\n            let { milestone_name, isPhotoevidence, from_date, to_date, recommended_hours } = item;\n\n            let isValid: any = null;\n            let isSkip: any = null;\n\n            if (editMilestoneTiming && Object.keys(editMilestoneTiming).length) {\n                const { checkIsValid, skip } = this.checkIsDateValid(milestones, editMilestoneTiming);\n                isValid = checkIsValid;\n                isSkip = skip;\n\n                if (isValid) {\n                    if ('from_date' in editMilestoneTiming) {\n                        from_date = editMilestoneTiming?.from_date;\n                    }\n                    if ('to_date' in editMilestoneTiming) {\n                        to_date = editMilestoneTiming?.to_date;\n                    }\n                }\n            }\n\n            this.setState({\n                from_date: from_date,\n                isPhotoevidence: isPhotoevidence === undefined ? false : isPhotoevidence,\n                milestone_name: milestone_name,\n                recommended_hours: recommended_hours,\n                to_date: to_date,\n            }, () => {\n                if (isValid !== null) {\n                    this.props.addTimeToMileStone(\n                        { from_date, to_date },\n                        editMileStone,\n                        isSkip\n                    )\n                }\n            })\n        }\n    }\n\n    handleChange = (name: string, value: any) => {\n        let error_clone: any = this.state.errors;\n\n\n        if (name === \"milestone_name\") {\n            value = (value).trimLeft().replace(/[^a-zA-Z|0-9 ]/g, \"\")\n        }\n\n        if (name === \"recommended_hours\") {\n            value = (value).trimLeft();\n        }\n\n\n        if (['milestone_name', 'from_date', 'recommended_hours'].includes(name)) {\n            error_clone[name] = this.isInvalid(name, value)\n        }\n        this.setState({ ...this.state, [name]: value, errors: error_clone });\n    }\n\n    handleContinue = () => {\n        this.setItems();\n        this.props.handleStepForward(6);\n    }\n\n\n    setItems = () => {\n        const { milestones, handleStepMileStone, newMileStoneScreen, editMileStone } = this.props;\n        let { milestone_name, from_date, to_date, isPhotoevidence, recommended_hours, errors } = this.state;\n        let milestone_index = editMileStone;\n        handleStepMileStone({\n            \"milestone_name\": milestone_name,\n            \"isPhotoevidence\": isPhotoevidence,\n            \"from_date\": from_date, // milestones[milestone_index]?.from_date || '',\n            \"to_date\": to_date, //milestones[milestone_index]?.to_date || '',\n            \"recommended_hours\": recommended_hours\n        }, milestone_index);\n    }\n\n\n    checkHoursVal = (value: any, lable: any, name: any) => {\n        if (value?.length) {\n            if (value.match(pattern) !== null) {\n                let splitItem = value.split(':')[1];\n                let IntItem = +splitItem;\n                let conditionItem = IntItem % 15 === 0;\n\n                if (!conditionItem) {\n                    return 'Time should be in mutiples of 15 like 10:15, 10:30';\n                }\n            } else {\n                return 'Please enter a valid pattern like : 10:15';\n            }\n        } else {\n            return `${label[name]} is required.`\n        }\n    }\n\n    isInvalid = (name: string, value: string) => {\n        switch (name) {\n            case 'milestone_name':\n                return !value.length ? `${label[name]} is required.` : value.length > 50 ? 'Maximum 50 characters are allowed.' : '';\n            case 'from_date':\n                return !value.length ? `${label[name]} is required.` : '';\n            case 'recommended_hours':\n                return this.checkHoursVal(value, label, name);\n        }\n    }\n\n    checkErrors = () => {\n        const { milestones } = this.props;\n\n        let filteredMiles = [];\n        if (milestones?.length && Array.isArray(milestones)) {\n            filteredMiles = milestones.filter((item: any) => {\n                if (item?.milestone_name) {\n                    return item;\n                }\n            });\n        }\n\n        let milestone_index = filteredMiles.length ? filteredMiles.length - 1 : 0;\n        let from_date = filteredMiles[milestone_index]?.from_date || '';\n        let { milestone_name, recommended_hours, errors: { pattern_error } } = this.state;\n        if (milestone_name?.length) {\n            let errorItems: any = {};\n            let error_1 = this.isInvalid('milestone_name', milestone_name);\n            let error_2 = this.isInvalid('from_date', from_date);\n            let error_3 = this.isInvalid('recommended_hours', recommended_hours);\n            errorItems['milestone_name'] = error_1;\n            // errorItems['from_date'] = error_2;\n\n            if (milestone_name?.length) {\n                errorItems['milestone_name'] = error_1;\n            }\n\n            if (recommended_hours?.length && error_3?.length) {\n                errorItems['recommended_hours'] = error_3;\n            }\n\n            if (JSON.stringify(this.state.errors) !== JSON.stringify(errorItems)) {\n                this.setState({ errors: errorItems })\n            }\n\n            if (!error_1?.length && (recommended_hours?.length === 0 || !pattern_error?.length)) {\n                return false;\n            }\n        }\n        return true;\n    }\n\n    renderTimeWithCustomFormat = (fromDate: any, toDate: any, format: any, formatSet?: any) => {\n\n        if (moment(fromDate, format).isValid() && !moment(toDate, format).isValid()) {\n            return `${moment(fromDate, format).format('DD MMM')}`\n        }\n\n        if (moment(fromDate, format).isValid() && moment(toDate, format).isValid()) {\n            let yearEnd = moment().endOf(\"year\").toISOString();\n            let monthEnd = moment(fromDate, format).endOf(\"month\").toISOString();\n\n            let item: any = moment(toDate, format).diff(moment(fromDate, format), 'months', true);\n            let item_year: any = moment(toDate, format).diff(moment(fromDate, format), 'years', true);\n\n            let monthDiff = parseInt(item.toString());\n            let yearDiff = parseInt(item_year.toString());\n\n            if (yearDiff > 0 || moment(toDate, format).isAfter(yearEnd) || moment(toDate, format).isAfter(yearEnd)) {\n                return `${moment(fromDate, format).format(formatSet[1])} - ${moment(toDate, format).format(formatSet[1])}`\n            }\n            if (monthDiff > 0 || moment(toDate, format).isAfter(monthEnd)) {\n                return `${moment(fromDate, format).format(formatSet[0])} - ${moment(toDate, format).format(formatSet[0])}`\n            }\n            return `${moment(fromDate, format).format(formatSet[0])} - ${moment(toDate, format).format(formatSet[0])}`\n        }\n\n        return 'Choose';\n    }\n\n    render() {\n        const { handleStepForward, handleStepBack, milestones, editMileStone } = this.props;\n        let { milestone_name, isPhotoevidence, recommended_hours, from_date, to_date, errors } = this.state;\n        let from_date_format = from_date;\n        let to_date_format = to_date;\n\n        let check_errors = this.checkErrors();\n\n        return (\n            <div className=\"app_wrapper\">\n                <div className=\"section_wrapper\">\n                    <div className=\"custom_container\">\n                        <div className=\"form_field\">\n                            <div className=\"flex_row\">\n                                <div className=\"flex_col_sm_5\">\n                                    <div className=\"relate\">\n                                        <button\n                                            className=\"back\"\n                                            onClick={() => { handleStepForward(6) }}>\n                                        </button>\n                                        <span className=\"title\">\n                                            {`Edit Milestone ${editMileStone + 1}`}\n                                        </span>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        <div className=\"flex_row\">\n                            <div className=\"flex_col_sm_5\">\n                                <div className=\"form_field\">\n                                    <label className=\"form_label\">Milestone name</label>\n                                    <div className=\"text_field\">\n                                        <input\n                                            type=\"text\"\n                                            placeholder=\"Enter Milestone name\"\n                                            onChange={(e) => { this.handleChange('milestone_name', e.target.value) }}\n                                            value={milestone_name}\n                                            name=\"milestone_name\" />\n                                    </div>\n                                    <span className=\"error_msg\">{errors?.milestone_name}</span>\n                                </div>\n                                <div className=\"form_field\">\n\n                                    <div className=\"checkbox_wrap agree_check\">\n                                        <input\n                                            onChange={() => { this.handleChange('isPhotoevidence', !isPhotoevidence) }}\n                                            checked={isPhotoevidence}\n                                            className=\"filter-type filled-in\"\n                                            type=\"checkbox\"\n                                            id=\"milestone1\" />\n                                        <label htmlFor=\"milestone1\">\n                                            <b>\n                                                {'Photo evidence required'}\n                                            </b>\n                                        </label>\n                                    </div>\n                                </div>\n                                <div className=\"form_field\">\n                                    <div className=\"f_spacebw\">\n                                        <label className=\"form_label\">Duration of milestone (optional)</label>\n                                        <button\n                                            onClick={() => { handleStepForward(8) }}\n                                            className=\"fill_btn fill_grey_btn choose_btn\">\n                                            {this.renderTimeWithCustomFormat(\n                                                from_date_format,\n                                                to_date_format,\n                                                'MM-DD-YYYY',\n                                                ['DD MMM', 'DD MMM YYYY']\n                                                // ['MMM DD', 'MMM DD YYYY'] // to keep the date format stable on front-end (TIC-2467)\n                                            )}\n                                            {/* {!to_date_format.length && from_date_format.length\n                                                ? `${from_date_format}` : to_date_format.length\n                                                    ? `${from_date_format} - ${to_date_format}`\n                                                    : 'Choose'} */}\n                                        </button>\n                                    </div>\n                                </div>\n                                <div className=\"form_field\">\n                                    <label className=\"form_label\">Estimated hours (optional)</label>\n                                    <div className=\"text_field\">\n                                        <input\n                                            onChange={(e) => {\n                                                this.setState({ recommended_hours: (e.target.value).trimLeft() }, () => {\n                                                    let rh_value = this.state.recommended_hours;\n                                                    let error_item = this.state.errors;\n\n                                                    // \"^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$\";\n\n                                                    if (!rh_value?.length || rh_value.match(pattern) !== null) {\n                                                        error_item['pattern_error'] = '';\n                                                        let splitItem = rh_value.split(':')[1];\n                                                        let IntItem = +splitItem;\n                                                        let conditionItem = IntItem % 15 === 0;\n                                                        if (!conditionItem) {\n                                                            error_item['pattern_error'] = 'Time should be in multiples of 15 like 10:15, 10:30';\n                                                        }\n                                                    } else {\n                                                        error_item['pattern_error'] = 'Please enter a valid pattern like : 10:15';\n                                                    }\n                                                    this.setState({ errors: error_item });\n                                                });\n                                            }}\n                                            // onChange={(e) => { this.handleChange('recommended_hours', e.target.value) }}\n                                            value={recommended_hours}\n                                            autoComplete=\"off\"\n                                            type=\"text\"\n                                            placeholder=\"Enter Estimated hours\"\n                                            name=\"recommended_hours\" />\n                                    </div>\n                                    <span className=\"error_msg\">{recommended_hours?.length === 0 ? '' : errors.recommended_hours}</span>\n                                    <span className=\"error_msg\">{recommended_hours?.length === 0 ? '' : errors.pattern_error}</span>\n                                </div>\n\n                                <div className=\"form_field\">\n                                    <button\n                                        onClick={this.handleContinue}\n                                        // className=\"fill_btn full_btn\">\n                                        className={`fill_btn full_btn btn-effect ${check_errors ? 'disable_btn' : ''}`}>\n                                        {'Continue'}\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n            </div>\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}