{"ast":null,"code":"var _jsxFileName = \"/home/appinventiv/Documents/Project/tickt/web/src/pages/builderJobDasboard/components/editMilestones/index.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\"; // @ts-ignore\n\nimport { DragDropContext, Droppable, Draggable } from \"react-beautiful-dnd\";\nimport { renderTimeWithCustomFormat } from \"../../../../utils/common\";\nimport milestonesPlaceholder from \"../../../../assets/images/Job milestones-preview.png\";\nimport moment from \"moment\";\nimport { setShowToast } from \"../../../../redux/common/actions\";\nimport Button from \"@material-ui/core/Button\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport { moengage, mixPanel } from \"../../../../services/analyticsTools\";\nimport { MoEConstants } from \"../../../../utils/constants\";\nimport { changeRequest } from \"../../../../redux/jobs/actions\";\nimport AddEditMile from \"./addEditMile\";\nimport { withRouter } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst EditMilestone = props => {\n  _s();\n\n  const {\n    item,\n    item: {\n      jobName\n    },\n    details: {\n      milestones\n    }\n  } = props;\n  const jobDetail = Object.freeze(props === null || props === void 0 ? void 0 : props.details);\n  const [stateData, setStateData] = useState([]);\n  const [stateItems, setItems] = useState([]);\n  const [editItem, setEditItems] = useState({});\n  const [itemData, setItemData] = useState({\n    add: false,\n    edit: false,\n    editId: \"\",\n    deleteId: \"\"\n  });\n  const [sortedItems, setSortedItems] = React.useState([]);\n  const [toggleItem, setToggleItem] = useState(false);\n  const [description, setDescription] = useState([]);\n  useEffect(() => {\n    if (!(stateData === null || stateData === void 0 ? void 0 : stateData.length)) {\n      let filtered = milestones.map((item, index) => {\n        item[\"count\"] = index + 1;\n        return item;\n      });\n      setStateData(filtered);\n      setItems(filtered);\n    }\n  }, []);\n\n  const reorder = (list, source, destination) => {\n    let startIndex = source.index;\n    let endIndex = destination.index;\n    let findItem = list.find(index => index === endIndex);\n    console.log({\n      findItem,\n      list,\n      destination,\n      endIndex\n    });\n\n    if (findItem) {\n      if ([1, 2].includes(findItem.status)) {\n        return list;\n      }\n    }\n\n    const result = Array.from(list);\n    const [removed] = result.splice(startIndex, 1);\n    result.splice(endIndex, 0, removed);\n    console.log({\n      result\n    });\n    setDescription(prev => [...prev, ...[\"Milestones are rearranged.\"]]);\n    return result;\n  };\n\n  const onDragEnd = result => {\n    const {\n      source,\n      destination\n    } = result; // dropped outside the list\n\n    if (!destination) {\n      return;\n    } // if (source.droppableId === destination.droppableId) {\n\n\n    const reOrderItems = reorder(stateItems, source, destination);\n    setItems(prev => reOrderItems);\n  };\n\n  const checkIfValidDates = item => {\n    let isfilter = stateItems.filter(item_ => {\n      if (item_.hasOwnProperty(\"fromDate\")) {\n        if (moment(item_ === null || item_ === void 0 ? void 0 : item_.fromDate).isValid()) {\n          item_[\"fromDate\"] = moment(item_.fromDate).startOf(\"day\").toDate();\n          item_[\"toDate\"] = item_.toDate === \"\" ? moment(item_.fromDate).startOf(\"day\").toDate() : moment(item_.toDate).startOf(\"day\").toDate();\n          return item_;\n        }\n      }\n    });\n\n    if (!(isfilter === null || isfilter === void 0 ? void 0 : isfilter.length)) {\n      return true;\n    } else {\n      const newarr = isfilter.sort((a, b) => {\n        let start_a = a.fromDate;\n        let end_a = a.toDate;\n        let start_b = b.fromDate;\n        let end_b = b.toDate;\n\n        if (start_a === start_b) {\n          return end_a - end_b;\n        }\n\n        return start_a - start_b;\n      });\n      let filteredItem = item.filter(item_reorder => {\n        if (item_reorder.hasOwnProperty(\"fromDate\")) {\n          if (moment(item_reorder === null || item_reorder === void 0 ? void 0 : item_reorder.fromDate).isValid()) {\n            return item_reorder;\n          }\n        }\n      });\n      setSortedItems(newarr);\n      console.log({\n        newarr,\n        filteredItem\n      });\n      return JSON.stringify(newarr) === JSON.stringify(filteredItem);\n    }\n  };\n\n  const checkIfDatesValid = () => {\n    let data = item;\n    let start_selection = data === null || data === void 0 ? void 0 : data.fromDate;\n    let end_selection = null;\n\n    if (moment(data === null || data === void 0 ? void 0 : data.toDate).isValid()) {\n      if (!moment(data === null || data === void 0 ? void 0 : data.toDate).isSame(moment(data === null || data === void 0 ? void 0 : data.fromDate))) {\n        end_selection = data === null || data === void 0 ? void 0 : data.toDate;\n      }\n    }\n\n    let item_find = false;\n    let filteredItem = stateItems;\n\n    if (filteredItem === null || filteredItem === void 0 ? void 0 : filteredItem.length) {\n      filteredItem.forEach(item_date => {\n        if (item_date.fromDate) {\n          let start = moment(item_date.fromDate).isValid() ? item_date.fromDate : null;\n          let end = moment(item_date.toDate).isValid() ? item_date.toDate : null;\n\n          if (start && !end) {\n            if (moment(start_selection).isAfter(moment(start))) {\n              item_find = true; // true;\n            }\n          }\n\n          if (start_selection && end_selection && !end) {\n            if (moment(start).isSameOrAfter(moment(start_selection)) && moment(start).isSameOrBefore(moment(end_selection))) {\n              item_find = false;\n            } else {\n              item_find = true;\n            }\n          }\n        }\n      });\n    }\n\n    if (item_find) {\n      setShowToast(true, \"Please check the milestone dates\");\n      return item_find;\n    }\n\n    return item_find;\n  };\n\n  const checkOnClick = (e, index) => {\n    let edit_item_clone = editItem;\n    edit_item_clone[index] = e.target.checked;\n    setEditItems(prev => ({ ...prev,\n      ...edit_item_clone\n    }));\n  };\n\n  const resetItems = () => {\n    setItemData(prev => ({ ...prev,\n      add: false,\n      edit: false,\n      editId: \"\",\n      deleteId: \"\"\n    }));\n    setEditItems({});\n  };\n\n  const addNewMile = item => {\n    let state_data = stateItems;\n\n    if (itemData === null || itemData === void 0 ? void 0 : itemData.edit) {\n      // edit\n      let index = parseInt(itemData.editId);\n      let prev_count = null;\n\n      if ((state_data === null || state_data === void 0 ? void 0 : state_data.length) > 1 && index > 0) {\n        prev_count = state_data[index - 1].count + 1;\n      } else {\n        prev_count = state_data[index].count;\n      }\n\n      console.log({\n        item,\n        prev_count\n      }, \"---->\");\n      state_data[itemData.editId][\"isPhotoevidence\"] = item.isPhotoevidence;\n      state_data[itemData.editId][\"milestoneName\"] = item.milestoneName;\n      state_data[itemData.editId][\"recommendedHours\"] = item.recommendedHours;\n      state_data[itemData.editId][\"description\"] = item.description;\n      state_data[itemData.editId][\"status\"] = item.status;\n      state_data[itemData.editId][\"order\"] = item.order;\n      state_data[index][\"count\"] = prev_count;\n      state_data[index][\"fromDate\"] = moment(item.fromDate).isValid() ? moment(item.fromDate).toISOString() : \"\";\n      state_data[index][\"toDate\"] = moment(item.toDate).isValid() ? moment(item.toDate).toISOString() : \"\"; // setStateData(state_data);\n\n      setItems(state_data);\n    } else {\n      item[\"count\"] = (state_data === null || state_data === void 0 ? void 0 : state_data.length) + 1;\n      setItems(prev => [...prev, item]); // setStateData((prev: any) => ([...prev, item]));\n    }\n  };\n\n  if ((itemData === null || itemData === void 0 ? void 0 : itemData.add) || (itemData === null || itemData === void 0 ? void 0 : itemData.edit)) {\n    let filtered = stateData.filter(item => {\n      if (!(item === null || item === void 0 ? void 0 : item.isDeleteRequest)) {\n        return item;\n      }\n    });\n    return /*#__PURE__*/_jsxDEV(AddEditMile, {\n      item: item,\n      milestones: stateItems // filtered={filtered}\n      ,\n      jobDetail: jobDetail,\n      isSame: JSON.stringify(filtered) === JSON.stringify(stateData),\n      editMile: itemData.editId,\n      addNewMile: addNewMile,\n      resetItems: resetItems\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 7\n    }, this);\n  }\n\n  const removeMilestoneByIndex = index => {\n    let state_data = stateItems;\n    state_data[index][\"isDeleteRequest\"] = true;\n    let count = 0;\n\n    if (state_data === null || state_data === void 0 ? void 0 : state_data.length) {\n      let filtered = state_data.map(item => {\n        if (!(item === null || item === void 0 ? void 0 : item.isDeleteRequest)) {\n          count++;\n          item[\"count\"] = count;\n        }\n\n        return item;\n      });\n      setStateData(filtered.concat(stateItems));\n      let Items = filtered.filter(item => {\n        if (!(item === null || item === void 0 ? void 0 : item.isDeleteRequest)) {\n          return item;\n        }\n      });\n      resetItems(); // removed length check to update the items.\n      // if (Items?.length) {\n\n      setItems(Items); // }\n    }\n  };\n\n  const checkIfChange = () => {\n    let isTrue = true;\n\n    if (!(stateItems === null || stateItems === void 0 ? void 0 : stateItems.length)) {\n      isTrue = false;\n    } else {\n      stateItems === null || stateItems === void 0 ? void 0 : stateItems.forEach(dt => {\n        var _dt$description;\n\n        if (dt === null || dt === void 0 ? void 0 : (_dt$description = dt.description) === null || _dt$description === void 0 ? void 0 : _dt$description.length) {\n          isTrue = false;\n        }\n      });\n      stateData === null || stateData === void 0 ? void 0 : stateData.forEach(dt => {\n        if (dt === null || dt === void 0 ? void 0 : dt.isDeleteRequest) {\n          isTrue = false;\n        }\n      });\n    }\n\n    return isTrue;\n  };\n\n  const submitData = async () => {\n    var _props$details;\n\n    let description_string = description;\n    let deletedItems = [];\n    let uniqueValues = {};\n    stateData.forEach(item => {\n      if (item === null || item === void 0 ? void 0 : item.isDeleteRequest) {\n        if (item === null || item === void 0 ? void 0 : item.milestoneId) {\n          if (uniqueValues[item === null || item === void 0 ? void 0 : item.milestoneId] == undefined) {\n            uniqueValues[item === null || item === void 0 ? void 0 : item.milestoneId] = 1;\n            deletedItems.push(item);\n          }\n        } //  else {\n        //     deletedItems.push(item);\n        // }\n\n      }\n    });\n    let filteredItems = deletedItems.concat(stateItems);\n    console.log({\n      deletedItems,\n      filteredItems\n    });\n    let filtered = filteredItems.map((item, index) => {\n      var _item$description, _data$to_date;\n\n      let data = {\n        milestoneId: (item === null || item === void 0 ? void 0 : item.milestoneId) || \"\",\n        milestone_name: item === null || item === void 0 ? void 0 : item.milestoneName,\n        isPhotoevidence: item === null || item === void 0 ? void 0 : item.isPhotoevidence,\n        from_date: moment(item === null || item === void 0 ? void 0 : item.fromDate).isValid() ? moment(item === null || item === void 0 ? void 0 : item.fromDate).format(\"YYYY-MM-DD\") : \"\",\n        to_date: moment(item === null || item === void 0 ? void 0 : item.toDate).isValid() ? moment(item === null || item === void 0 ? void 0 : item.toDate).format(\"YYYY-MM-DD\") : \"\",\n        recommended_hours: item === null || item === void 0 ? void 0 : item.recommendedHours,\n        description: item === null || item === void 0 ? void 0 : item.description,\n        status: item === null || item === void 0 ? void 0 : item.status\n      };\n\n      if ((_item$description = item.description) === null || _item$description === void 0 ? void 0 : _item$description.length) {\n        description_string.push(item.description);\n      }\n\n      if (!(data === null || data === void 0 ? void 0 : (_data$to_date = data.to_date) === null || _data$to_date === void 0 ? void 0 : _data$to_date.length)) {\n        delete data.to_date;\n      }\n\n      if ((item === null || item === void 0 ? void 0 : item.isDeleteRequest) && (item === null || item === void 0 ? void 0 : item.status) > -1) {\n        data[\"isDeleteRequest\"] = true;\n        data[\"description\"] = `${item === null || item === void 0 ? void 0 : item.milestoneName} was deleted.`;\n        description_string.push(`${item === null || item === void 0 ? void 0 : item.milestoneName} was deleted.`);\n      }\n\n      if (!(item === null || item === void 0 ? void 0 : item.milestoneId)) {\n        delete data.milestoneId;\n      }\n\n      data[\"order\"] = index + 1;\n      return data;\n    }).filter(item => {\n      if (![1, 2, 3].includes(item === null || item === void 0 ? void 0 : item.status)) {\n        var _item$description2;\n\n        delete item.status;\n\n        if (item === null || item === void 0 ? void 0 : (_item$description2 = item.description) === null || _item$description2 === void 0 ? void 0 : _item$description2.length) {\n          delete item.description;\n        }\n\n        return item;\n      }\n    });\n    let data = {\n      jobId: item.jobId,\n      tradieId: props === null || props === void 0 ? void 0 : (_props$details = props.details) === null || _props$details === void 0 ? void 0 : _props$details.tradieId,\n      milestones: filtered,\n      description: Array.from(new Set(description_string))\n    };\n    console.log({\n      data\n    });\n    let response = await changeRequest(data);\n\n    if (response === null || response === void 0 ? void 0 : response.success) {\n      moengage.moE_SendEvent(MoEConstants.EDIT_MILESTONES, {\n        timeStamp: moengage.getCurrentTimeStamp()\n      });\n      mixPanel.mixP_SendEvent(MoEConstants.EDIT_MILESTONES, {\n        timeStamp: moengage.getCurrentTimeStamp()\n      });\n      props.history.push(\"/milestone-request-sent-success\");\n    }\n  };\n\n  const renderTimeIfExist = (fromDate, toDate) => {\n    const time = renderTimeWithCustomFormat(fromDate, moment(fromDate).isSame(moment(toDate)) ? \"\" : toDate, \"\", [\"DD MMM\", \"DD MMM YY\"]);\n    return time === \"Choose\" ? \"\" : time;\n  };\n\n  const customRenderElements = ({\n    milestoneName,\n    isPhotoevidence,\n    recommendedHours,\n    fromDate,\n    toDate,\n    status,\n    index,\n    custom_index\n  }) => {\n    console.log({\n      index,\n      custom_index\n    });\n    return /*#__PURE__*/_jsxDEV(Draggable, {\n      draggableId: `${milestoneName}-${index}`,\n      index: index,\n      isDragDisabled: ![0, 4, 5, -1].includes(status) ? true : false,\n      children: provided => /*#__PURE__*/_jsxDEV(\"li\", {\n        className: ![0, 4, 5, -1].includes(status) ? \"disable_milstone\" : \"\",\n        ref: provided.innerRef,\n        ...provided.draggableProps,\n        ...provided.dragHandleProps,\n        style: { ...provided.draggableProps.style\n        },\n        children: [editItem[index] ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"edit_delete\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            onClick: e => {\n              e.preventDefault();\n              console.log({\n                index\n              });\n              setItemData(prev => ({ ...prev,\n                edit: true,\n                editId: index,\n                deleteId: \"\"\n              }));\n            },\n            className: \"edit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 452,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            onClick: e => {\n              e.preventDefault();\n              setItemData(prev => ({ ...prev,\n                editId: \"\",\n                deleteId: index\n              }));\n            },\n            className: \"delete\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 465,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 451,\n          columnNumber: 15\n        }, this) : \"\", /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"checkbox_wrap agree_check\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            checked: editItem[index],\n            onClick: e => {\n              if ([0, 4, 5, -1].includes(status)) {\n                checkOnClick(e, index);\n              } else {\n                e.preventDefault();\n              }\n            },\n            className: \"filter-type filled-in\",\n            type: \"checkbox\",\n            id: `milestone${index}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 481,\n            columnNumber: 15\n          }, this), console.log({\n            custom_index,\n            index\n          }), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: `milestone${index}`,\n            children: `${custom_index}. ${milestoneName}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 498,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"info\",\n            children: [isPhotoevidence ? /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Photo evidence required\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 503,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 505,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: renderTimeIfExist(fromDate, toDate)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 507,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: recommendedHours\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 508,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 501,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 480,\n          columnNumber: 13\n        }, this)]\n      }, index, true, {\n        fileName: _jsxFileName,\n        lineNumber: 438,\n        columnNumber: 11\n      }, this)\n    }, `${index}-${milestoneName}`, false, {\n      fileName: _jsxFileName,\n      lineNumber: 431,\n      columnNumber: 7\n    }, this);\n  };\n\n  const stateItemsEdit = stateItems.filter(item => (item === null || item === void 0 ? void 0 : item.isDeleteRequest) == false);\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Dialog, {\n      open: toggleItem,\n      \"aria-labelledby\": \"alert-dialog-title\",\n      \"aria-describedby\": \"alert-dialog-description\",\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        id: \"alert-dialog-title\",\n        className: \"xs_alert_dialog_title\",\n        children: \"Heads Up\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 527,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n        children: /*#__PURE__*/_jsxDEV(DialogContentText, {\n          children: \"If you go back, you will lose all your changes.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 531,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 530,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => {\n            setToggleItem(prev => !prev);\n          },\n          color: \"primary\",\n          children: \"Yes\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 536,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => {\n            setToggleItem(prev => !prev);\n            props.backTab(\"edit\");\n          },\n          color: \"primary\",\n          autoFocus: true,\n          children: \"No\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 544,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 535,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 522,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: (itemData === null || itemData === void 0 ? void 0 : itemData.deleteId) !== \"\" ? true : false,\n      onClose: resetItems,\n      \"aria-labelledby\": \"alert-dialog-title\",\n      \"aria-describedby\": \"alert-dialog-description\",\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        id: \"alert-dialog-title\",\n        children: \"Are you sure you want to delete the milestone ?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 563,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => {\n            removeMilestoneByIndex(itemData === null || itemData === void 0 ? void 0 : itemData.deleteId);\n          },\n          color: \"primary\",\n          autoFocus: true,\n          children: \"Yes\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 567,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => {\n            resetItems();\n          },\n          color: \"primary\",\n          children: \"No\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 576,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 566,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 557,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex_row\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex_col_sm_8\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relate\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => {\n              if (checkIfChange()) {\n                setToggleItem(prev => !prev);\n                return;\n              }\n\n              props.backTab(\"edit\");\n            },\n            className: \"back\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 590,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"xs_sub_title\",\n            children: jobName || \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 600,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 589,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"sub_title\",\n          children: \"Change Request\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 602,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"commn_para\",\n          children: \"You can add/remove/change a milestones here. The changes will be sent to the tradesperson to accept before being implemented\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 603,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 588,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 587,\n      columnNumber: 7\n    }, this), console.log({\n      stateItems,\n      stateItemsEdit\n    }), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex_row\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex_col_sm_7\",\n        children: [/*#__PURE__*/_jsxDEV(DragDropContext, {\n          onDragEnd: onDragEnd,\n          children: /*#__PURE__*/_jsxDEV(Droppable, {\n            droppableId: \"milestones\",\n            children: (provided, snapshot) => /*#__PURE__*/_jsxDEV(\"ul\", {\n              ref: provided.innerRef,\n              className: `milestones${snapshot.isDraggingOver ? \" dragging-over\" : \"\"}`,\n              children: [(stateItems === null || stateItems === void 0 ? void 0 : stateItems.length) > 0 && stateItems.map(({\n                milestoneName,\n                isPhotoevidence,\n                recommendedHours,\n                isDeleteRequest,\n                fromDate,\n                toDate,\n                status,\n                count\n              }, index) => !!isDeleteRequest == false && customRenderElements({\n                milestoneName,\n                isPhotoevidence,\n                recommendedHours,\n                isDeleteRequest,\n                fromDate,\n                toDate,\n                status,\n                index,\n                custom_index: count\n              })), provided.placeholder, (stateItems === null || stateItems === void 0 ? void 0 : stateItems.length) === 0 && /*#__PURE__*/_jsxDEV(\"figure\", {\n                className: \"placeholder_img\",\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: milestonesPlaceholder,\n                  alt: \"milestones-placeholder\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 662,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 661,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 616,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 614,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 613,\n          columnNumber: 11\n        }, this), !(stateItems === null || stateItems === void 0 ? void 0 : stateItems.length) ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form_field\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"fill_btn full_btn btn-effect\",\n              onClick: () => {\n                setItemData({\n                  add: true,\n                  editId: \"\",\n                  edit: false,\n                  deleteId: \"\"\n                });\n              },\n              children: \"+ Add milestone\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 675,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 674,\n            columnNumber: 15\n          }, this)\n        }, void 0, false) : /*#__PURE__*/_jsxDEV(React.Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form_field\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"fill_btn fill_grey_btn full_btn btn-effect\",\n              onClick: () => {\n                setItemData({\n                  add: true,\n                  editId: \"\",\n                  edit: false,\n                  deleteId: \"\"\n                });\n              },\n              children: \"+ Add milestone\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 693,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 692,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form_field\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                let checkIfItem = checkIfDatesValid();\n                console.log({\n                  checkIfItem\n                });\n\n                if (!checkIfItem) {\n                  let check = checkIfValidDates(stateItems);\n                  console.log({\n                    check\n                  });\n\n                  if (check) {\n                    submitData();\n                  } else {\n                    setShowToast(true, \"Please arrange milestone date wise\");\n                  }\n                }\n              },\n              className: `fill_btn full_btn btn-effect ${checkIfChange() ? \"disable_btn\" : \"\"}`,\n              children: \"Send to tradesperson\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 709,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 708,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 691,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 612,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 611,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 521,\n    columnNumber: 5\n  }, this);\n};\n\n_s(EditMilestone, \"DYho/Nxuow7DFIIW6hueA+2zUbQ=\");\n\n_c = EditMilestone;\nexport default _c2 = withRouter(EditMilestone);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"EditMilestone\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/home/appinventiv/Documents/Project/tickt/web/src/pages/builderJobDasboard/components/editMilestones/index.tsx"],"names":["React","useState","useEffect","DragDropContext","Droppable","Draggable","renderTimeWithCustomFormat","milestonesPlaceholder","moment","setShowToast","Button","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","moengage","mixPanel","MoEConstants","changeRequest","AddEditMile","withRouter","EditMilestone","props","item","jobName","details","milestones","jobDetail","Object","freeze","stateData","setStateData","stateItems","setItems","editItem","setEditItems","itemData","setItemData","add","edit","editId","deleteId","sortedItems","setSortedItems","toggleItem","setToggleItem","description","setDescription","length","filtered","map","index","reorder","list","source","destination","startIndex","endIndex","findItem","find","console","log","includes","status","result","Array","from","removed","splice","prev","onDragEnd","reOrderItems","checkIfValidDates","isfilter","filter","item_","hasOwnProperty","fromDate","isValid","startOf","toDate","newarr","sort","a","b","start_a","end_a","start_b","end_b","filteredItem","item_reorder","JSON","stringify","checkIfDatesValid","data","start_selection","end_selection","isSame","item_find","forEach","item_date","start","end","isAfter","isSameOrAfter","isSameOrBefore","checkOnClick","e","edit_item_clone","target","checked","resetItems","addNewMile","state_data","parseInt","prev_count","count","isPhotoevidence","milestoneName","recommendedHours","order","toISOString","isDeleteRequest","removeMilestoneByIndex","concat","Items","checkIfChange","isTrue","dt","submitData","description_string","deletedItems","uniqueValues","milestoneId","undefined","push","filteredItems","milestone_name","from_date","format","to_date","recommended_hours","jobId","tradieId","Set","response","success","moE_SendEvent","EDIT_MILESTONES","timeStamp","getCurrentTimeStamp","mixP_SendEvent","history","renderTimeIfExist","time","customRenderElements","custom_index","provided","innerRef","draggableProps","dragHandleProps","style","preventDefault","stateItemsEdit","backTab","snapshot","isDraggingOver","placeholder","checkIfItem","check"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\n// @ts-ignore\nimport {\n  DragDropContext,\n  Droppable,\n  Draggable,\n  DropResult,\n} from \"react-beautiful-dnd\";\nimport { renderTimeWithCustomFormat } from \"../../../../utils/common\";\nimport milestonesPlaceholder from \"../../../../assets/images/Job milestones-preview.png\";\nimport moment from \"moment\";\nimport { setShowToast } from \"../../../../redux/common/actions\";\n\nimport Button from \"@material-ui/core/Button\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport { moengage, mixPanel } from \"../../../../services/analyticsTools\";\nimport { MoEConstants } from \"../../../../utils/constants\";\nimport { changeRequest } from \"../../../../redux/jobs/actions\";\n\nimport AddEditMile from \"./addEditMile\";\n\nimport { withRouter } from \"react-router-dom\";\n\nconst EditMilestone = (props: any) => {\n  const {\n    item,\n    item: { jobName },\n    details: { milestones },\n  } = props;\n  const jobDetail: any = Object.freeze(props?.details);\n  const [stateData, setStateData] = useState<any>([]);\n  const [stateItems, setItems] = useState<any>([]);\n  const [editItem, setEditItems] = useState<{ [index: string]: any }>({});\n  const [itemData, setItemData] = useState({\n    add: false,\n    edit: false,\n    editId: \"\",\n    deleteId: \"\",\n  });\n  const [sortedItems, setSortedItems] = React.useState([]);\n  const [toggleItem, setToggleItem] = useState(false);\n\n  const [description, setDescription] = useState<any>([]);\n\n  useEffect(() => {\n    if (!stateData?.length) {\n      let filtered = milestones.map((item: any, index: any) => {\n        item[\"count\"] = index + 1;\n        return item;\n      });\n      setStateData(filtered);\n      setItems(filtered);\n    }\n  }, []);\n\n  const reorder = (list: Array<any>, source: any, destination: any) => {\n    let startIndex = source.index;\n    let endIndex = destination.index;\n\n    let findItem = list.find((index: any) => index === endIndex);\n    console.log({ findItem, list, destination, endIndex });\n    if (findItem) {\n      if ([1, 2].includes(findItem.status)) {\n        return list;\n      }\n    }\n\n    const result = Array.from(list);\n    const [removed] = result.splice(startIndex, 1);\n    result.splice(endIndex, 0, removed);\n    console.log({ result });\n    setDescription((prev: any) => [...prev, ...[\"Milestones are rearranged.\"]]);\n    return result;\n  };\n\n  const onDragEnd = (result: DropResult) => {\n    const { source, destination } = result;\n    // dropped outside the list\n    if (!destination) {\n      return;\n    }\n\n    // if (source.droppableId === destination.droppableId) {\n    const reOrderItems = reorder(stateItems, source, destination);\n    setItems((prev: any) => reOrderItems);\n  };\n\n  const checkIfValidDates = (item: any) => {\n    let isfilter = stateItems.filter((item_: any) => {\n      if (item_.hasOwnProperty(\"fromDate\")) {\n        if (moment(item_?.fromDate).isValid()) {\n          item_[\"fromDate\"] = moment(item_.fromDate).startOf(\"day\").toDate();\n          item_[\"toDate\"] =\n            item_.toDate === \"\"\n              ? moment(item_.fromDate).startOf(\"day\").toDate()\n              : moment(item_.toDate).startOf(\"day\").toDate();\n          return item_;\n        }\n      }\n    });\n\n    if (!isfilter?.length) {\n      return true;\n    } else {\n      const newarr: any = isfilter.sort((a: any, b: any) => {\n        let start_a = a.fromDate;\n        let end_a = a.toDate;\n\n        let start_b = b.fromDate;\n        let end_b = b.toDate;\n\n        if (start_a === start_b) {\n          return end_a - end_b;\n        }\n        return start_a - start_b;\n      });\n\n      let filteredItem: any = item.filter((item_reorder: any) => {\n        if (item_reorder.hasOwnProperty(\"fromDate\")) {\n          if (moment(item_reorder?.fromDate).isValid()) {\n            return item_reorder;\n          }\n        }\n      });\n      setSortedItems(newarr);\n      console.log({ newarr, filteredItem });\n      return JSON.stringify(newarr) === JSON.stringify(filteredItem);\n    }\n  };\n\n  const checkIfDatesValid = () => {\n    let data = item;\n\n    let start_selection: any = data?.fromDate;\n    let end_selection: any = null;\n    if (moment(data?.toDate).isValid()) {\n      if (!moment(data?.toDate).isSame(moment(data?.fromDate))) {\n        end_selection = data?.toDate;\n      }\n    }\n\n    let item_find: any = false;\n    let filteredItem = stateItems;\n\n    if (filteredItem?.length) {\n      filteredItem.forEach((item_date: any) => {\n        if (item_date.fromDate) {\n          let start: any = moment(item_date.fromDate).isValid()\n            ? item_date.fromDate\n            : null;\n          let end: any = moment(item_date.toDate).isValid()\n            ? item_date.toDate\n            : null;\n\n          if (start && !end) {\n            if (moment(start_selection).isAfter(moment(start))) {\n              item_find = true; // true;\n            }\n          }\n\n          if (start_selection && end_selection && !end) {\n            if (\n              moment(start).isSameOrAfter(moment(start_selection)) &&\n              moment(start).isSameOrBefore(moment(end_selection))\n            ) {\n              item_find = false;\n            } else {\n              item_find = true;\n            }\n          }\n        }\n      });\n    }\n\n    if (item_find) {\n      setShowToast(true, \"Please check the milestone dates\");\n      return item_find;\n    }\n\n    return item_find;\n  };\n\n  const checkOnClick = (e: any, index: any) => {\n    let edit_item_clone: any = editItem;\n    edit_item_clone[index] = e.target.checked;\n    setEditItems((prev) => ({ ...prev, ...edit_item_clone }));\n  };\n\n  const resetItems = () => {\n    setItemData((prev: any) => ({\n      ...prev,\n      add: false,\n      edit: false,\n      editId: \"\",\n      deleteId: \"\",\n    }));\n    setEditItems({});\n  };\n\n  const addNewMile = (item: any) => {\n    let state_data: any = stateItems;\n    if (itemData?.edit) {\n      // edit\n      let index = parseInt(itemData.editId);\n      let prev_count = null;\n\n      if (state_data?.length > 1 && index > 0) {\n        prev_count = state_data[index - 1].count + 1;\n      } else {\n        prev_count = state_data[index].count;\n      }\n\n      console.log({ item, prev_count }, \"---->\");\n      state_data[itemData.editId][\"isPhotoevidence\"] = item.isPhotoevidence;\n      state_data[itemData.editId][\"milestoneName\"] = item.milestoneName;\n      state_data[itemData.editId][\"recommendedHours\"] = item.recommendedHours;\n      state_data[itemData.editId][\"description\"] = item.description;\n      state_data[itemData.editId][\"status\"] = item.status;\n      state_data[itemData.editId][\"order\"] = item.order;\n\n      state_data[index][\"count\"] = prev_count;\n\n      state_data[index][\"fromDate\"] = moment(item.fromDate).isValid()\n        ? moment(item.fromDate).toISOString()\n        : \"\";\n      state_data[index][\"toDate\"] = moment(item.toDate).isValid()\n        ? moment(item.toDate).toISOString()\n        : \"\";\n      // setStateData(state_data);\n      setItems(state_data);\n    } else {\n      item[\"count\"] = state_data?.length + 1;\n      setItems((prev: any) => [...prev, item]);\n      // setStateData((prev: any) => ([...prev, item]));\n    }\n  };\n\n  if (itemData?.add || itemData?.edit) {\n    let filtered = stateData.filter((item: any) => {\n      if (!item?.isDeleteRequest) {\n        return item;\n      }\n    });\n    return (\n      <AddEditMile\n        item={item}\n        milestones={stateItems}\n        // filtered={filtered}\n        jobDetail={jobDetail}\n        isSame={JSON.stringify(filtered) === JSON.stringify(stateData)}\n        editMile={itemData.editId}\n        addNewMile={addNewMile}\n        resetItems={resetItems}\n      />\n    );\n  }\n\n  const removeMilestoneByIndex = (index: any) => {\n    let state_data: any = stateItems;\n    state_data[index][\"isDeleteRequest\"] = true;\n    let count = 0;\n    if (state_data?.length) {\n      let filtered = state_data.map((item: any) => {\n        if (!item?.isDeleteRequest) {\n          count++;\n          item[\"count\"] = count;\n        }\n        return item;\n      });\n      setStateData(filtered.concat(stateItems));\n\n      let Items = filtered.filter((item: any) => {\n        if (!item?.isDeleteRequest) {\n          return item;\n        }\n      });\n\n      resetItems();\n      // removed length check to update the items.\n      // if (Items?.length) {\n      setItems(Items);\n      // }\n    }\n  };\n\n  const checkIfChange = () => {\n    let isTrue = true;\n    if (!stateItems?.length) {\n      isTrue = false;\n    } else {\n      stateItems?.forEach((dt: any) => {\n        if (dt?.description?.length) {\n          isTrue = false;\n        }\n      });\n\n      stateData?.forEach((dt: any) => {\n        if (dt?.isDeleteRequest) {\n          isTrue = false;\n        }\n      });\n    }\n    return isTrue;\n  };\n\n  const submitData = async () => {\n    let description_string = description;\n\n    let deletedItems: any = [];\n    let uniqueValues: any = {};\n    stateData.forEach((item: any) => {\n      if (item?.isDeleteRequest) {\n        if (item?.milestoneId) {\n          if (uniqueValues[item?.milestoneId] == undefined) {\n            uniqueValues[item?.milestoneId] = 1;\n            deletedItems.push(item);\n          }\n        }\n        //  else {\n        //     deletedItems.push(item);\n        // }\n      }\n    });\n\n    let filteredItems: any = deletedItems.concat(stateItems);\n\n    console.log({\n      deletedItems,\n      filteredItems,\n    });\n\n    let filtered = filteredItems\n      .map((item: any, index: any) => {\n        let data: any = {\n          milestoneId: item?.milestoneId || \"\",\n          milestone_name: item?.milestoneName,\n          isPhotoevidence: item?.isPhotoevidence,\n          from_date: moment(item?.fromDate).isValid()\n            ? moment(item?.fromDate).format(\"YYYY-MM-DD\")\n            : \"\",\n          to_date: moment(item?.toDate).isValid()\n            ? moment(item?.toDate).format(\"YYYY-MM-DD\")\n            : \"\",\n          recommended_hours: item?.recommendedHours,\n          description: item?.description,\n          status: item?.status,\n        };\n\n        if (item.description?.length) {\n          description_string.push(item.description);\n        }\n\n        if (!data?.to_date?.length) {\n          delete data.to_date;\n        }\n\n        if (item?.isDeleteRequest && item?.status > -1) {\n          data[\"isDeleteRequest\"] = true;\n          data[\"description\"] = `${item?.milestoneName} was deleted.`;\n          description_string.push(`${item?.milestoneName} was deleted.`);\n        }\n\n        if (!item?.milestoneId) {\n          delete data.milestoneId;\n        }\n        data[\"order\"] = index + 1;\n        return data;\n      })\n      .filter((item: any) => {\n        if (![1, 2, 3].includes(item?.status)) {\n          delete item.status;\n\n          if (item?.description?.length) {\n            delete item.description;\n          }\n\n          return item;\n        }\n      });\n\n    let data = {\n      jobId: item.jobId,\n      tradieId: props?.details?.tradieId,\n      milestones: filtered,\n      description: Array.from(new Set(description_string)),\n    };\n\n    console.log({ data });\n\n    let response: any = await changeRequest(data);\n    if (response?.success) {\n      moengage.moE_SendEvent(MoEConstants.EDIT_MILESTONES, {\n        timeStamp: moengage.getCurrentTimeStamp(),\n      });\n      mixPanel.mixP_SendEvent(MoEConstants.EDIT_MILESTONES, {\n        timeStamp: moengage.getCurrentTimeStamp(),\n      });\n      props.history.push(\"/milestone-request-sent-success\");\n    }\n  };\n\n  const renderTimeIfExist = (fromDate: string, toDate: string) => {\n    const time = renderTimeWithCustomFormat(\n      fromDate,\n      moment(fromDate).isSame(moment(toDate)) ? \"\" : toDate,\n      \"\",\n      [\"DD MMM\", \"DD MMM YY\"]\n    );\n    return time === \"Choose\" ? \"\" : time;\n  };\n\n  const customRenderElements = ({\n    milestoneName,\n    isPhotoevidence,\n    recommendedHours,\n    fromDate,\n    toDate,\n    status,\n    index,\n    custom_index,\n  }: any) => {\n    console.log({\n      index,\n      custom_index,\n    });\n    return (\n      <Draggable\n        key={`${index}-${milestoneName}`}\n        draggableId={`${milestoneName}-${index}`}\n        index={index}\n        isDragDisabled={![0, 4, 5, -1].includes(status) ? true : false}\n      >\n        {(provided: any) => (\n          <li\n            key={index}\n            className={\n              ![0, 4, 5, -1].includes(status) ? \"disable_milstone\" : \"\"\n            }\n            ref={provided.innerRef}\n            {...provided.draggableProps}\n            {...provided.dragHandleProps}\n            style={{\n              ...provided.draggableProps.style,\n            }}\n          >\n            {editItem[index] ? (\n              <div className=\"edit_delete\">\n                <span\n                  onClick={(e) => {\n                    e.preventDefault();\n                    console.log({ index });\n                    setItemData((prev: any) => ({\n                      ...prev,\n                      edit: true,\n                      editId: index,\n                      deleteId: \"\",\n                    }));\n                  }}\n                  className=\"edit\"\n                ></span>\n                <span\n                  onClick={(e) => {\n                    e.preventDefault();\n                    setItemData((prev: any) => ({\n                      ...prev,\n                      editId: \"\",\n                      deleteId: index,\n                    }));\n                  }}\n                  className=\"delete\"\n                ></span>\n              </div>\n            ) : (\n              \"\"\n            )}\n            <div className=\"checkbox_wrap agree_check\">\n              <input\n                checked={editItem[index]}\n                onClick={(e: any) => {\n                  if ([0, 4, 5, -1].includes(status)) {\n                    checkOnClick(e, index);\n                  } else {\n                    e.preventDefault();\n                  }\n                }}\n                className=\"filter-type filled-in\"\n                type=\"checkbox\"\n                id={`milestone${index}`}\n              />\n              {console.log({\n                custom_index,\n                index,\n              })}\n              <label\n                htmlFor={`milestone${index}`}\n              >{`${custom_index}. ${milestoneName}`}</label>\n              <div className=\"info\">\n                {isPhotoevidence ? (\n                  <span>{\"Photo evidence required\"}</span>\n                ) : (\n                  <span></span>\n                )}\n                <span>{renderTimeIfExist(fromDate, toDate)}</span>\n                <span>{recommendedHours}</span>\n              </div>\n            </div>\n          </li>\n        )}\n      </Draggable>\n    );\n  };\n\n  const stateItemsEdit = stateItems.filter(\n    (item: any) => item?.isDeleteRequest == false\n  );\n  return (\n    <React.Fragment>\n      <Dialog\n        open={toggleItem}\n        aria-labelledby=\"alert-dialog-title\"\n        aria-describedby=\"alert-dialog-description\"\n      >\n        <DialogTitle id=\"alert-dialog-title\" className=\"xs_alert_dialog_title\">\n          {\"Heads Up\"}\n        </DialogTitle>\n        <DialogContent>\n          <DialogContentText>\n            {\"If you go back, you will lose all your changes.\"}\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button\n            onClick={() => {\n              setToggleItem((prev: any) => !prev);\n            }}\n            color=\"primary\"\n          >\n            {\"Yes\"}\n          </Button>\n          <Button\n            onClick={() => {\n              setToggleItem((prev: any) => !prev);\n              props.backTab(\"edit\");\n            }}\n            color=\"primary\"\n            autoFocus\n          >\n            {\"No\"}\n          </Button>\n        </DialogActions>\n      </Dialog>\n\n      <Dialog\n        open={itemData?.deleteId !== \"\" ? true : false}\n        onClose={resetItems}\n        aria-labelledby=\"alert-dialog-title\"\n        aria-describedby=\"alert-dialog-description\"\n      >\n        <DialogTitle id=\"alert-dialog-title\">\n          {\"Are you sure you want to delete the milestone ?\"}\n        </DialogTitle>\n        <DialogActions>\n          <Button\n            onClick={() => {\n              removeMilestoneByIndex(itemData?.deleteId);\n            }}\n            color=\"primary\"\n            autoFocus\n          >\n            {\"Yes\"}\n          </Button>\n          <Button\n            onClick={() => {\n              resetItems();\n            }}\n            color=\"primary\"\n          >\n            {\"No\"}\n          </Button>\n        </DialogActions>\n      </Dialog>\n\n      <div className=\"flex_row\">\n        <div className=\"flex_col_sm_8\">\n          <div className=\"relate\">\n            <button\n              onClick={() => {\n                if (checkIfChange()) {\n                  setToggleItem((prev: any) => !prev);\n                  return;\n                }\n                props.backTab(\"edit\");\n              }}\n              className=\"back\"\n            ></button>\n            <span className=\"xs_sub_title\">{jobName || \"\"}</span>\n          </div>\n          <span className=\"sub_title\">{\"Change Request\"}</span>\n          <p className=\"commn_para\">\n            {\n              \"You can add/remove/change a milestones here. The changes will be sent to the tradesperson to accept before being implemented\"\n            }\n          </p>\n        </div>\n      </div>\n      {console.log({ stateItems, stateItemsEdit })}\n      <div className=\"flex_row\">\n        <div className=\"flex_col_sm_7\">\n          <DragDropContext onDragEnd={onDragEnd}>\n            <Droppable droppableId=\"milestones\">\n              {(provided, snapshot) => (\n                <ul\n                  ref={provided.innerRef}\n                  className={`milestones${\n                    snapshot.isDraggingOver ? \" dragging-over\" : \"\"\n                  }`}\n                >\n                  {stateItems?.length > 0 &&\n                    stateItems.map(\n                      (\n                        {\n                          milestoneName,\n                          isPhotoevidence,\n                          recommendedHours,\n                          isDeleteRequest,\n                          fromDate,\n                          toDate,\n                          status,\n                          count,\n                        }: {\n                          milestoneName: string;\n                          isPhotoevidence: boolean;\n                          fromDate: string;\n                          toDate: string;\n                          status: number;\n                          recommendedHours: any;\n                          isDeleteRequest?: boolean;\n                          count?: any;\n                        },\n                        index: any\n                      ) =>\n                        !!isDeleteRequest == false &&\n                        customRenderElements({\n                          milestoneName,\n                          isPhotoevidence,\n                          recommendedHours,\n                          isDeleteRequest,\n                          fromDate,\n                          toDate,\n                          status,\n                          index,\n                          custom_index: count,\n                        })\n                    )}\n                  {provided.placeholder}\n                  {stateItems?.length === 0 && (\n                    <figure className=\"placeholder_img\">\n                      <img\n                        src={milestonesPlaceholder}\n                        alt=\"milestones-placeholder\"\n                      />\n                    </figure>\n                  )}\n                </ul>\n              )}\n            </Droppable>\n          </DragDropContext>\n          {!stateItems?.length ? (\n            <>\n              <div className=\"form_field\">\n                <button\n                  className=\"fill_btn full_btn btn-effect\"\n                  onClick={() => {\n                    setItemData({\n                      add: true,\n                      editId: \"\",\n                      edit: false,\n                      deleteId: \"\",\n                    });\n                  }}\n                >\n                  {\"+ Add milestone\"}\n                </button>\n              </div>\n            </>\n          ) : (\n            <React.Fragment>\n              <div className=\"form_field\">\n                <button\n                  className=\"fill_btn fill_grey_btn full_btn btn-effect\"\n                  onClick={() => {\n                    setItemData({\n                      add: true,\n                      editId: \"\",\n                      edit: false,\n                      deleteId: \"\",\n                    });\n                  }}\n                >\n                  {\"+ Add milestone\"}\n                </button>\n              </div>\n\n              <div className=\"form_field\">\n                <button\n                  onClick={() => {\n                    let checkIfItem: boolean = checkIfDatesValid();\n                    console.log({ checkIfItem });\n                    if (!checkIfItem) {\n                      let check: boolean = checkIfValidDates(stateItems);\n                      console.log({ check });\n                      if (check) {\n                        submitData();\n                      } else {\n                        setShowToast(\n                          true,\n                          \"Please arrange milestone date wise\"\n                        );\n                      }\n                    }\n                  }}\n                  className={`fill_btn full_btn btn-effect ${\n                    checkIfChange() ? \"disable_btn\" : \"\"\n                  }`}\n                >\n                  {\"Send to tradesperson\"}\n                </button>\n              </div>\n            </React.Fragment>\n          )}\n        </div>\n      </div>\n    </React.Fragment>\n  );\n};\n\nexport default withRouter(EditMilestone);\n"]},"metadata":{},"sourceType":"module"}