{"ast":null,"code":"var _jsxFileName = \"/home/appinventiv/Documents/Project/tickt/web/src/pages/jobDashboard/components/reviewBuilder/reviewBuilder.tsx\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from \"react\"; // @ts-ignore\n\nimport ReactStars from \"react-rating-stars-component\";\nimport { reviewBuilder, getJobDetails } from \"../../../../redux/jobs/actions\";\nimport { setShowToast } from \"../../../../redux/common/actions\";\nimport { renderTime } from \"../../../../utils/common\";\nimport dummy from \"../../../../assets/images/u_placeholder.jpg\";\nimport more from \"../../../../assets/images/icon-direction-right.png\";\nimport { moengage, mixPanel } from \"../../../../services/analyticsTools\";\nimport { MoEConstants } from \"../../../../utils/constants\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst ReviewBuilder = props => {\n  _s();\n\n  var _item$postedBy3, _item$builderData3, _item$builderData4, _item$builderData5, _item$postedBy4;\n\n  const [reviewBuilderData, setReviewBuilderData] = useState({\n    rating: 0,\n    review: \"\"\n  });\n  const [item, setItem] = useState(\"\");\n  const [isParam, setIsParam] = useState(false);\n  useEffect(() => {\n    var _URLSearchParams, _props$location;\n\n    const jobId = (_URLSearchParams = new URLSearchParams((_props$location = props.location) === null || _props$location === void 0 ? void 0 : _props$location.search)) === null || _URLSearchParams === void 0 ? void 0 : _URLSearchParams.get(\"jobId\");\n\n    (async () => {\n      var _props$location2, _props$location2$stat;\n\n      if (jobId) {\n        const res = await getJobDetails(jobId);\n\n        if (res.success) {\n          setItem(res.data);\n          setIsParam(true);\n        }\n      } else if (props === null || props === void 0 ? void 0 : (_props$location2 = props.location) === null || _props$location2 === void 0 ? void 0 : (_props$location2$stat = _props$location2.state) === null || _props$location2$stat === void 0 ? void 0 : _props$location2$stat.item) {\n        var _props$location3, _props$location3$stat;\n\n        setItem(props === null || props === void 0 ? void 0 : (_props$location3 = props.location) === null || _props$location3 === void 0 ? void 0 : (_props$location3$stat = _props$location3.state) === null || _props$location3$stat === void 0 ? void 0 : _props$location3$stat.item);\n      }\n    })();\n  }, []);\n  console.log(props, \"props data\", item, \"item\");\n\n  const ratingChanged = newRating => {\n    console.log(newRating);\n    setReviewBuilderData(prevdata => ({ ...prevdata,\n      rating: newRating\n    }));\n  };\n\n  const handleChange = e => {\n    if (e.target.value.trim().length <= 1000) {\n      setReviewBuilderData(prevdata => ({ ...prevdata,\n        review: e.target.value\n      }));\n    }\n  };\n\n  const submitReviewClicked = async () => {\n    if (reviewBuilderData.rating === 0) {\n      setShowToast(true, \"Star rating is required\");\n      return;\n    }\n\n    if (reviewBuilderData.rating > 0) {\n      var _item$postedBy, _item$builderData;\n\n      let data = {\n        jobId: item === null || item === void 0 ? void 0 : item.jobId,\n        builderId: isParam ? item === null || item === void 0 ? void 0 : (_item$postedBy = item.postedBy) === null || _item$postedBy === void 0 ? void 0 : _item$postedBy.builderId : item === null || item === void 0 ? void 0 : (_item$builderData = item.builderData) === null || _item$builderData === void 0 ? void 0 : _item$builderData.builderId,\n        rating: reviewBuilderData.rating,\n        review: reviewBuilderData.review.trim()\n      };\n      if (!data.review) delete data.review;\n      const response = await reviewBuilder(data);\n\n      if (response === null || response === void 0 ? void 0 : response.success) {\n        var _props$history;\n\n        const mData = {\n          timeStamp: moengage.getCurrentTimeStamp()\n        };\n        moengage.moE_SendEvent(MoEConstants.ADDED_REVIEW, mData);\n        mixPanel.mixP_SendEvent(MoEConstants.ADDED_REVIEW, mData);\n        props === null || props === void 0 ? void 0 : (_props$history = props.history) === null || _props$history === void 0 ? void 0 : _props$history.push(\"/builder-review-submitted\");\n      }\n    }\n  };\n\n  const jobClickHandler = () => {\n    props.history.push(`/job-details-page?jobId=${item === null || item === void 0 ? void 0 : item.jobId}&redirect_from=jobs`);\n  };\n\n  const builderClicked = () => {\n    var _item$postedBy2, _item$builderData2;\n\n    props.history.push(`/builder-info?builderId=${isParam ? (_item$postedBy2 = item.postedBy) === null || _item$postedBy2 === void 0 ? void 0 : _item$postedBy2.builderId : (_item$builderData2 = item.builderData) === null || _item$builderData2 === void 0 ? void 0 : _item$builderData2.builderId}`);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"detail_col\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex_row\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex_col_sm_6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relate\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"back\",\n            onClick: () => {\n              var _props$history2;\n\n              return props === null || props === void 0 ? void 0 : (_props$history2 = props.history) === null || _props$history2 === void 0 ? void 0 : _props$history2.goBack();\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"xs_sub_title\",\n            children: item === null || item === void 0 ? void 0 : item.jobName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form_field\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"sub_title\",\n            children: \"Review completed job\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"inner_title\",\n          children: \"Rate this builder\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form_field\",\n          children: /*#__PURE__*/_jsxDEV(ReactStars, {\n            count: 5,\n            onChange: ratingChanged,\n            size: 55,\n            isHalf: true,\n            emptyIcon: /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"far fa-star\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 122,\n              columnNumber: 26\n            }, this),\n            halfIcon: /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-star-half-alt\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 25\n            }, this),\n            fullIcon: /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-star\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 124,\n              columnNumber: 25\n            }, this),\n            activeColor: \"#fee600\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form_field\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"form_label\",\n            children: \"Comment (optional)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text_field\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              placeholder: \"Thanks..\",\n              maxLength: 1000,\n              onChange: handleChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 131,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form_field\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"fill_btn full_btn btn-effect\",\n            onClick: submitReviewClicked,\n            children: \"Leave review\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex_col_sm_6 col_ruler\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relate\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"sub_title\",\n            children: \"Job details\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"edit_icon\",\n            title: \"More\",\n            onClick: jobClickHandler,\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: more,\n              alt: \"more\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 152,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"tradie_card posted_by \",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"user_wrap\",\n            onClick: () => builderClicked(),\n            children: [/*#__PURE__*/_jsxDEV(\"figure\", {\n              className: \"u_img\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: isParam ? (_item$postedBy3 = item.postedBy) === null || _item$postedBy3 === void 0 ? void 0 : _item$postedBy3.builderImage : ((_item$builderData3 = item.builderData) === null || _item$builderData3 === void 0 ? void 0 : _item$builderData3.builderImage) ? (_item$builderData4 = item.builderData) === null || _item$builderData4 === void 0 ? void 0 : _item$builderData4.builderImage : dummy,\n                alt: \"traide-img\",\n                onError: e => {\n                  var _e$target, _e$target2;\n\n                  if (e === null || e === void 0 ? void 0 : (_e$target = e.target) === null || _e$target === void 0 ? void 0 : _e$target.onerror) {\n                    e.target.onerror = null;\n                  }\n\n                  if (e === null || e === void 0 ? void 0 : (_e$target2 = e.target) === null || _e$target2 === void 0 ? void 0 : _e$target2.src) {\n                    e.target.src = dummy;\n                  }\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 158,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 157,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"details\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"name\",\n                children: ((_item$builderData5 = item.builderData) === null || _item$builderData5 === void 0 ? void 0 : _item$builderData5.builderName) || ((_item$postedBy4 = item.postedBy) === null || _item$postedBy4 === void 0 ? void 0 : _item$postedBy4.builderName)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 178,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"prof\",\n                children: item === null || item === void 0 ? void 0 : item.jobName\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 181,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"prof\",\n                children: renderTime(item === null || item === void 0 ? void 0 : item.fromDate, item === null || item === void 0 ? void 0 : item.toDate)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 182,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 177,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 156,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 102,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ReviewBuilder, \"Hz5GJOl8PFnnGxVarB2a4qNpIXA=\");\n\n_c = ReviewBuilder;\nexport default ReviewBuilder;\n\nvar _c;\n\n$RefreshReg$(_c, \"ReviewBuilder\");","map":{"version":3,"sources":["/home/appinventiv/Documents/Project/tickt/web/src/pages/jobDashboard/components/reviewBuilder/reviewBuilder.tsx"],"names":["useState","useEffect","ReactStars","reviewBuilder","getJobDetails","setShowToast","renderTime","dummy","more","moengage","mixPanel","MoEConstants","ReviewBuilder","props","reviewBuilderData","setReviewBuilderData","rating","review","item","setItem","isParam","setIsParam","jobId","URLSearchParams","location","search","get","res","success","data","state","console","log","ratingChanged","newRating","prevdata","handleChange","e","target","value","trim","length","submitReviewClicked","builderId","postedBy","builderData","response","mData","timeStamp","getCurrentTimeStamp","moE_SendEvent","ADDED_REVIEW","mixP_SendEvent","history","push","jobClickHandler","builderClicked","goBack","jobName","builderImage","onerror","src","builderName","fromDate","toDate"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\n// @ts-ignore\nimport ReactStars from \"react-rating-stars-component\";\nimport { reviewBuilder, getJobDetails } from \"../../../../redux/jobs/actions\";\nimport { setShowToast } from \"../../../../redux/common/actions\";\nimport { renderTime } from \"../../../../utils/common\";\n\nimport dummy from \"../../../../assets/images/u_placeholder.jpg\";\nimport more from \"../../../../assets/images/icon-direction-right.png\";\nimport { moengage, mixPanel } from \"../../../../services/analyticsTools\";\nimport { MoEConstants } from \"../../../../utils/constants\";\n\ninterface Proptypes {\n  history: any;\n  location: any;\n}\nconst ReviewBuilder = (props: Proptypes) => {\n  const [reviewBuilderData, setReviewBuilderData] = useState({\n    rating: 0,\n    review: \"\",\n  });\n  const [item, setItem] = useState<any>(\"\");\n  const [isParam, setIsParam] = useState<boolean>(false);\n\n  useEffect(() => {\n    const jobId: any = new URLSearchParams(props.location?.search)?.get(\n      \"jobId\"\n    );\n    (async () => {\n      if (jobId) {\n        const res = await getJobDetails(jobId);\n        if (res.success) {\n          setItem(res.data);\n          setIsParam(true);\n        }\n      } else if (props?.location?.state?.item) {\n        setItem(props?.location?.state?.item);\n      }\n    })();\n  }, []);\n  console.log(props, \"props data\", item, \"item\");\n\n  const ratingChanged = (newRating: number) => {\n    console.log(newRating);\n    setReviewBuilderData((prevdata: any) => ({\n      ...prevdata,\n      rating: newRating,\n    }));\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.value.trim().length <= 1000) {\n      setReviewBuilderData((prevdata: any) => ({\n        ...prevdata,\n        review: e.target.value,\n      }));\n    }\n  };\n\n  const submitReviewClicked = async () => {\n    if (reviewBuilderData.rating === 0) {\n      setShowToast(true, \"Star rating is required\");\n      return;\n    }\n    if (reviewBuilderData.rating > 0) {\n      let data: any = {\n        jobId: item?.jobId,\n        builderId: isParam\n          ? item?.postedBy?.builderId\n          : item?.builderData?.builderId,\n        rating: reviewBuilderData.rating,\n        review: reviewBuilderData.review.trim(),\n      };\n      if (!data.review) delete data.review;\n      const response = await reviewBuilder(data);\n      if (response?.success) {\n        const mData = {\n          timeStamp: moengage.getCurrentTimeStamp(),\n        };\n        moengage.moE_SendEvent(MoEConstants.ADDED_REVIEW, mData);\n        mixPanel.mixP_SendEvent(MoEConstants.ADDED_REVIEW, mData);\n        props?.history?.push(\"/builder-review-submitted\");\n      }\n    }\n  };\n\n  const jobClickHandler = () => {\n    props.history.push(\n      `/job-details-page?jobId=${item?.jobId}&redirect_from=jobs`\n    );\n  };\n\n  const builderClicked = () => {\n    props.history.push(\n      `/builder-info?builderId=${\n        isParam ? item.postedBy?.builderId : item.builderData?.builderId\n      }`\n    );\n  };\n\n  return (\n    <div className=\"detail_col\">\n      <div className=\"flex_row\">\n        <div className=\"flex_col_sm_6\">\n          <div className=\"relate\">\n            <button\n              className=\"back\"\n              onClick={() => props?.history?.goBack()}\n            ></button>\n            <span className=\"xs_sub_title\">{item?.jobName}</span>\n          </div>\n          <div className=\"form_field\">\n            <span className=\"sub_title\">Review completed job</span>\n          </div>\n          <span className=\"inner_title\">Rate this builder</span>\n          <div className=\"form_field\">\n            <ReactStars\n              count={5}\n              onChange={ratingChanged}\n              size={55}\n              isHalf={true}\n              emptyIcon={<i className=\"far fa-star\"></i>}\n              halfIcon={<i className=\"fa fa-star-half-alt\"></i>}\n              fullIcon={<i className=\"fa fa-star\"></i>}\n              activeColor=\"#fee600\"\n            />\n          </div>\n          <div className=\"form_field\">\n            <label className=\"form_label\">Comment (optional)</label>\n            <div className=\"text_field\">\n              <input\n                type=\"text\"\n                placeholder=\"Thanks..\"\n                maxLength={1000}\n                onChange={handleChange}\n              />\n            </div>\n          </div>\n          <div className=\"form_field\">\n            <button\n              className=\"fill_btn full_btn btn-effect\"\n              onClick={submitReviewClicked}\n            >\n              Leave review\n            </button>\n          </div>\n        </div>\n        <div className=\"flex_col_sm_6 col_ruler\">\n          <div className=\"relate\">\n            <span className=\"sub_title\">Job details</span>\n            <span className=\"edit_icon\" title=\"More\" onClick={jobClickHandler}>\n              <img src={more} alt=\"more\" />\n            </span>\n          </div>\n          <div className=\"tradie_card posted_by \">\n            <div className=\"user_wrap\" onClick={() => builderClicked()}>\n              <figure className=\"u_img\">\n                <img\n                  src={\n                    isParam\n                      ? item.postedBy?.builderImage\n                      : item.builderData?.builderImage\n                      ? item.builderData?.builderImage\n                      : dummy\n                  }\n                  alt=\"traide-img\"\n                  onError={(e: any) => {\n                    if (e?.target?.onerror) {\n                      e.target.onerror = null;\n                    }\n                    if (e?.target?.src) {\n                      e.target.src = dummy;\n                    }\n                  }}\n                />\n              </figure>\n              <div className=\"details\">\n                <span className=\"name\">\n                  {item.builderData?.builderName || item.postedBy?.builderName}\n                </span>\n                <span className=\"prof\">{item?.jobName}</span>\n                <span className=\"prof\">\n                  {renderTime(item?.fromDate, item?.toDate)}\n                </span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ReviewBuilder;\n"]},"metadata":{},"sourceType":"module"}