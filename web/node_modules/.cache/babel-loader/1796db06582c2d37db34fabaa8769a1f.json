{"ast":null,"code":"var _jsxFileName = \"/home/appinventiv/Documents/Project/tickt/web/src/pages/builderJobDasboard/components/markMilestones.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport dummy from '../../../assets/images/u_placeholder.jpg';\nimport editIconBlue from '../../../assets/images/ic-edit-blue.png';\nimport more from '../../../assets/images/icon-direction-right.png';\nimport MilestoneApprove from './milestoneApprove';\nimport { withRouter } from 'react-router-dom';\nimport { getMilestoneList, getMilestoneDetails } from '../../../redux/homeSearch/actions';\nimport { renderTime } from '../../../utils/common';\nimport EditMilestones from './editMilestones/index';\nimport CancelJobs from './cancelJobs/cancelJob';\nimport LodgeDispute from './lodgeDispute/lodgeDispute';\nimport storageService from '../../../utils/storageService';\nimport SeeDetailsComponents from './seeDetails';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst MarkMilestones = props => {\n  _s();\n\n  var _item_details$milesto, _item_details$milesto2, _dataItems, _item_details$tradie, _item_details$tradie2, _item_details$tradie3, _item_details$tradie4;\n\n  let resetStateLocal = props === null || props === void 0 ? void 0 : props.resetStateLocal;\n  let listData = props === null || props === void 0 ? void 0 : props.listData;\n  let selectedIndex = props === null || props === void 0 ? void 0 : props.selectedIndex;\n  let enableEditMilestone = props === null || props === void 0 ? void 0 : props.enableEditMilestone;\n  let enableLodgeDispute = props === null || props === void 0 ? void 0 : props.enableLodgeDispute;\n  let enableCancelJob = props === null || props === void 0 ? void 0 : props.enableCancelJob;\n  const [enableApprove, setEnableApprove] = useState(false);\n  const [itemDetails, setDetails] = useState(null);\n  const [selectedMilestoneIndex, setMilestoneIndex] = useState(null);\n  const [selectedMile, setMilestone] = useState(null);\n  const [expandItem, setExpandItem] = useState({});\n  const [toggleSeeDetails, setSeeDetails] = useState(false);\n  const [toggleItem, setToggleItem] = useState({\n    edit: false,\n    cancel: false,\n    lodge: false\n  });\n\n  const backToScreen = () => {\n    preFetch();\n    setEnableApprove(false);\n    setSeeDetails(false);\n  };\n\n  let selectedItem = null;\n\n  if (listData === null || listData === void 0 ? void 0 : listData.length) {\n    selectedItem = listData[selectedIndex];\n  }\n\n  useEffect(() => {\n    fetchMilestoneDetail();\n  }, [selectedMilestoneIndex]);\n\n  const fetchMilestoneDetail = async () => {\n    if (selectedMilestoneIndex && Object.keys(selectedMilestoneIndex).length) {\n      const {\n        milestoneId,\n        jobId\n      } = selectedMilestoneIndex;\n\n      if (milestoneId && jobId) {\n        let response = await getMilestoneDetails({\n          milestoneId,\n          jobId\n        });\n\n        if (response.success) {\n          setMilestone(response.data);\n\n          if ((selectedMilestoneIndex === null || selectedMilestoneIndex === void 0 ? void 0 : selectedMilestoneIndex.type) === \"detail\") {\n            setSeeDetails(true);\n          } else {\n            setEnableApprove(true);\n          }\n        }\n      }\n    }\n  };\n\n  useEffect(() => {\n    console.log({\n      props\n    }, '-----??');\n    preFetch();\n  }, []);\n  useEffect(() => {\n    console.log({\n      expandItem\n    });\n\n    if (Object.keys(expandItem).length === 0) {\n      preFetch();\n    }\n  }, [expandItem]);\n  useEffect(() => {\n    if (enableEditMilestone) {\n      setToggleItem({\n        edit: true,\n        cancel: false,\n        lodge: false\n      });\n    }\n\n    if (enableLodgeDispute) {\n      setToggleItem({\n        edit: false,\n        cancel: false,\n        lodge: true\n      });\n    }\n\n    if (enableCancelJob) {\n      setToggleItem({\n        edit: false,\n        cancel: true,\n        lodge: false\n      });\n    }\n  }, [enableEditMilestone, enableLodgeDispute, enableCancelJob]);\n\n  const classChecks = (isActive, isPrevDone) => {\n    if (isActive === 1 && isPrevDone === false) {\n      return 'active';\n    } else if (isActive === 2 && isPrevDone === false) {\n      return 'check';\n    } else if (isActive === 1 && isPrevDone === 2) {\n      return 'active';\n    } else if (isActive === 2 && isPrevDone === 2) {\n      return 'check';\n    } else {\n      return 'disable';\n    }\n  };\n\n  const preFetch = async () => {\n    let {\n      jobId\n    } = selectedItem;\n\n    if (getMilestoneList) {\n      const res = await getMilestoneList(jobId);\n\n      if (res.success) {\n        var _res$data, _res$data$milestones;\n\n        console.log({\n          res\n        }, '---->');\n\n        if (res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : (_res$data$milestones = _res$data.milestones) === null || _res$data$milestones === void 0 ? void 0 : _res$data$milestones.length) {\n          var _res$data2, _res$data2$milestones;\n\n          res === null || res === void 0 ? void 0 : (_res$data2 = res.data) === null || _res$data2 === void 0 ? void 0 : (_res$data2$milestones = _res$data2.milestones) === null || _res$data2$milestones === void 0 ? void 0 : _res$data2$milestones.forEach((item, index) => {\n            if (index === 0) {\n              const isActive = item === null || item === void 0 ? void 0 : item.status;\n              let isPrevDone = false;\n              isPrevDone = false;\n              let result = classChecks(isActive, isPrevDone);\n              console.log({\n                result\n              }, '====>');\n\n              if ([\"check\", \"active\"].includes(result)) {\n                setExpandItem({\n                  [item === null || item === void 0 ? void 0 : item.milestoneId]: true\n                });\n              }\n            }\n          });\n        }\n\n        setDetails(res.data);\n      }\n    }\n  };\n\n  const redirectToInfo = ({\n    jobId,\n    status,\n    tradieId\n  }) => {\n    console.log({\n      jobId\n    });\n    let props_ = props; // let urlEncode: any = window.btoa(`?jobId=${jobId}&status=${status}&tradieId=${tradieId}&edit=true&activeType=active&hide_dipute=${item_detail?.dispute}`)\n\n    let urlEncode = `?jobId=${jobId}&status=${status}&tradieId=${tradieId}&edit=true&activeType=active&hide_dipute=${item_detail === null || item_detail === void 0 ? void 0 : item_detail.dispute}`;\n    props_.history.push(`/job-detail?${urlEncode}`);\n  };\n\n  let item_details = itemDetails;\n\n  if (enableApprove) {\n    return /*#__PURE__*/_jsxDEV(MilestoneApprove, {\n      resetStateLocal: resetStateLocal,\n      backToScreen: backToScreen,\n      data: {\n        selectedMile,\n        selectedMilestoneIndex,\n        selectedItem,\n        itemDetails\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 13\n    }, this);\n  }\n\n  if (toggleSeeDetails) {\n    return /*#__PURE__*/_jsxDEV(SeeDetailsComponents, {\n      resetStateLocal: resetStateLocal,\n      backToScreen: backToScreen,\n      data: {\n        selectedMile,\n        selectedMilestoneIndex,\n        selectedItem,\n        itemDetails\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 13\n    }, this);\n  }\n\n  const backTab = name => {\n    setToggleItem(prev => ({ ...prev,\n      [name]: false\n    }));\n    setExpandItem({});\n  };\n\n  if (toggleItem === null || toggleItem === void 0 ? void 0 : toggleItem.edit) {\n    let details = itemDetails;\n\n    if (details && selectedItem) {\n      var _Object$keys;\n\n      if (details && ((_Object$keys = Object.keys(details)) === null || _Object$keys === void 0 ? void 0 : _Object$keys.length) && Object.keys(selectedItem).length) {\n        return /*#__PURE__*/_jsxDEV(EditMilestones, {\n          details: details,\n          item: selectedItem,\n          backTab: backTab\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 21\n        }, this);\n      }\n    }\n  }\n\n  if (toggleItem === null || toggleItem === void 0 ? void 0 : toggleItem.lodge) {\n    return /*#__PURE__*/_jsxDEV(LodgeDispute, {\n      item: selectedItem,\n      backTab: backTab\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 13\n    }, this);\n  }\n\n  if (toggleItem === null || toggleItem === void 0 ? void 0 : toggleItem.cancel) {\n    return /*#__PURE__*/_jsxDEV(CancelJobs, {\n      item: selectedItem,\n      backTab: backTab\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 13\n    }, this);\n  }\n\n  let item_detail = itemDetails;\n  let item_status = false;\n\n  if (item_details === null || item_details === void 0 ? void 0 : (_item_details$milesto = item_details.milestones) === null || _item_details$milesto === void 0 ? void 0 : _item_details$milesto.length) {\n    let isExist = item_details === null || item_details === void 0 ? void 0 : item_details.milestones.find(item => item.status === 1);\n\n    if (isExist) {\n      item_status = true;\n    }\n  }\n\n  let dataItems = [];\n\n  if (item_details === null || item_details === void 0 ? void 0 : (_item_details$milesto2 = item_details.milestones) === null || _item_details$milesto2 === void 0 ? void 0 : _item_details$milesto2.length) {\n    dataItems = item_details === null || item_details === void 0 ? void 0 : item_details.milestones;\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex_row\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex_col_sm_6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relate\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"back\",\n          onClick: () => {\n            // times\n            resetStateLocal();\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"xs_sub_title\",\n          children: item_detail && Object.keys(item_detail).length ? item_detail.jobName : ''\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"dot_menu\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: editIconBlue,\n            alt: \"edit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"edit_menu\",\n            children: /*#__PURE__*/_jsxDEV(\"ul\", {\n              children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                onClick: () => {\n                  setToggleItem({\n                    edit: true,\n                    lodge: false,\n                    cancel: false\n                  });\n                },\n                className: \"icon edit_line\",\n                children: 'Edit Milestone'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 262,\n                columnNumber: 33\n              }, this), !(item_detail === null || item_detail === void 0 ? void 0 : item_detail.dispute) && /*#__PURE__*/_jsxDEV(\"li\", {\n                onClick: () => {\n                  setToggleItem(prev => ({ ...prev,\n                    lodge: true\n                  }));\n                },\n                className: \"icon lodge\",\n                children: 'Lodge dispute'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 268,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                onClick: () => {\n                  setToggleItem(prev => ({ ...prev,\n                    cancel: true\n                  }));\n                },\n                className: \"icon delete\",\n                children: \"Cancel job\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 275,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"sub_title\",\n        children: 'Job Milestones'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"commn_para\",\n        children: \"Your job point of contact has indicated they want to be notified when you reach the following milestones. Tap the milestone and Submit when a milestone is completed\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"milestones_check\",\n        children: (_dataItems = dataItems) === null || _dataItems === void 0 ? void 0 : _dataItems.map(({\n          milestoneId,\n          milestoneName,\n          isPhotoevidence,\n          status,\n          fromDate,\n          toDate\n        }, index) => {\n          const isActive = status;\n          let isPrevDone = false;\n\n          if (index === 0) {\n            isPrevDone = false;\n          } else {\n            isPrevDone = dataItems[index - 1].status;\n          }\n\n          console.log({\n            isActive,\n            isPrevDone,\n            index,\n            expandItem\n          });\n          return /*#__PURE__*/_jsxDEV(\"li\", {\n            className: classChecks(isActive, isPrevDone),\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              onClick: () => {\n                setExpandItem(prev => ({ ...prev,\n                  [milestoneId]: prev[milestoneId] === undefined ? true : !prev[milestoneId]\n                }));\n              },\n              className: \"circle_stepper\",\n              children: /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 322,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 314,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"info\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: milestoneName\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 325,\n                columnNumber: 37\n              }, this), isPhotoevidence && /*#__PURE__*/_jsxDEV(\"span\", {\n                children: 'Photo evidence required'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 327,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: renderTime(fromDate, toDate)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 329,\n                columnNumber: 37\n              }, this), [\"check\"].includes(classChecks(isActive, isPrevDone)) && expandItem[milestoneId] ? /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"fill_btn full_btn btn-effect\",\n                style: {\n                  backgroundColor: '#DFE5EF'\n                },\n                onClick: e => {\n                  e.stopPropagation();\n                  setMilestoneIndex({\n                    index,\n                    milestoneId,\n                    type: 'detail',\n                    jobId: item_details === null || item_details === void 0 ? void 0 : item_details.jobId\n                  });\n                },\n                children: 'See Details'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 334,\n                columnNumber: 41\n              }, this) : null]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 324,\n              columnNumber: 33\n            }, this), [\"active\"].includes(classChecks(isActive, isPrevDone)) && expandItem[milestoneId] ? /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"fill_btn full_btn btn-effect\",\n              onClick: () => {\n                setMilestoneIndex({\n                  index,\n                  milestoneId,\n                  type: 'approve',\n                  jobId: item_details === null || item_details === void 0 ? void 0 : item_details.jobId\n                });\n              },\n              children: 'Check and Approve'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 352,\n              columnNumber: 37\n            }, this) : null]\n          }, milestoneId, true, {\n            fileName: _jsxFileName,\n            lineNumber: 311,\n            columnNumber: 29\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex_col_sm_6 col_ruler\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"sub_title\",\n        children: \"Tradie\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        onClick: () => {\n          var _props$history;\n\n          console.log({\n            item_details\n          });\n          props === null || props === void 0 ? void 0 : (_props$history = props.history) === null || _props$history === void 0 ? void 0 : _props$history.push(`tradie-info?tradeId=${item_details === null || item_details === void 0 ? void 0 : item_details.tradieId}&hideInvite=true&active=true`);\n        },\n        className: \"tradie_card posted_by view_more \",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          onClick: e => {\n            var _storageService$getIt;\n\n            e.stopPropagation();\n            props.history.push({\n              pathname: `/chat`,\n              state: {\n                tradieId: item_details === null || item_details === void 0 ? void 0 : item_details.tradieId,\n                builderId: (_storageService$getIt = storageService.getItem('userInfo')) === null || _storageService$getIt === void 0 ? void 0 : _storageService$getIt._id,\n                jobId: item_details === null || item_details === void 0 ? void 0 : item_details.jobId,\n                jobName: item_details === null || item_details === void 0 ? void 0 : item_details.jobName\n              }\n            });\n          },\n          className: \"chat circle\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 380,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"user_wrap\",\n          children: [/*#__PURE__*/_jsxDEV(\"figure\", {\n            className: \"u_img\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: (item_details === null || item_details === void 0 ? void 0 : (_item_details$tradie = item_details.tradie) === null || _item_details$tradie === void 0 ? void 0 : _item_details$tradie.tradieImage) || dummy,\n              alt: \"traide-img\",\n              onError: e => {\n                var _e$target, _e$target2;\n\n                if (e === null || e === void 0 ? void 0 : (_e$target = e.target) === null || _e$target === void 0 ? void 0 : _e$target.onerror) {\n                  e.target.onerror = null;\n                }\n\n                if (e === null || e === void 0 ? void 0 : (_e$target2 = e.target) === null || _e$target2 === void 0 ? void 0 : _e$target2.src) {\n                  e.target.src = dummy;\n                }\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 396,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 395,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"details\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"name\",\n              children: (item_details === null || item_details === void 0 ? void 0 : (_item_details$tradie2 = item_details.tradie) === null || _item_details$tradie2 === void 0 ? void 0 : _item_details$tradie2.tradieName) || ''\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 410,\n              columnNumber: 29\n            }, this), (item_details === null || item_details === void 0 ? void 0 : item_details.tradie) && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"rating\",\n              children: [(item_details === null || item_details === void 0 ? void 0 : (_item_details$tradie3 = item_details.tradie) === null || _item_details$tradie3 === void 0 ? void 0 : _item_details$tradie3.ratings) || 0, \" , \", (item_details === null || item_details === void 0 ? void 0 : (_item_details$tradie4 = item_details.tradie) === null || _item_details$tradie4 === void 0 ? void 0 : _item_details$tradie4.reviews) || 0, \" reviews\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 413,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 409,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 394,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 374,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relate\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"sub_title\",\n          children: 'Job details'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 422,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"edit_icon\",\n          title: \"More\",\n          onClick: () => {\n            let {\n              jobId,\n              tradeId,\n              specializationId,\n              tradieId,\n              status\n            } = selectedItem;\n            redirectToInfo({\n              jobId,\n              status,\n              tradieId\n            });\n          },\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: more,\n            alt: \"more\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 432,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 421,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 371,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 243,\n    columnNumber: 9\n  }, this);\n}; // const mapProps = (dispatch: any) => {\n//     return bindActionCreators({\n//         getHomeJobDetails\n//     }, dispatch)\n// }\n// const mapState = () => ({\n// })\n// export default connect(mapState, mapProps)(withRouter(MarkMilestones));\n\n\n_s(MarkMilestones, \"p97TU4gPYdunTjsj6qiWe1Cairs=\");\n\n_c = MarkMilestones;\nexport default _c2 = withRouter(MarkMilestones);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"MarkMilestones\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/home/appinventiv/Documents/Project/tickt/web/src/pages/builderJobDasboard/components/markMilestones.tsx"],"names":["React","useState","useEffect","dummy","editIconBlue","more","MilestoneApprove","withRouter","getMilestoneList","getMilestoneDetails","renderTime","EditMilestones","CancelJobs","LodgeDispute","storageService","SeeDetailsComponents","MarkMilestones","props","resetStateLocal","listData","selectedIndex","enableEditMilestone","enableLodgeDispute","enableCancelJob","enableApprove","setEnableApprove","itemDetails","setDetails","selectedMilestoneIndex","setMilestoneIndex","selectedMile","setMilestone","expandItem","setExpandItem","toggleSeeDetails","setSeeDetails","toggleItem","setToggleItem","edit","cancel","lodge","backToScreen","preFetch","selectedItem","length","fetchMilestoneDetail","Object","keys","milestoneId","jobId","response","success","data","type","console","log","classChecks","isActive","isPrevDone","res","milestones","forEach","item","index","status","result","includes","redirectToInfo","tradieId","props_","urlEncode","item_detail","dispute","history","push","item_details","backTab","name","prev","details","item_status","isExist","find","dataItems","jobName","map","milestoneName","isPhotoevidence","fromDate","toDate","undefined","backgroundColor","e","stopPropagation","pathname","state","builderId","getItem","_id","tradie","tradieImage","target","onerror","src","tradieName","ratings","reviews","tradeId","specializationId"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport UploadMedia from '../../postJob/components/uploadMedia';\nimport dummy from '../../../assets/images/u_placeholder.jpg';\nimport editIconBlue from '../../../assets/images/ic-edit-blue.png';\nimport more from '../../../assets/images/icon-direction-right.png';\nimport check from '../../../assets/images/checked-2.png';\nimport { format } from 'date-fns';\nimport MilestoneApprove from './milestoneApprove';\nimport { withRouter } from 'react-router-dom';\nimport { connect } from 'react-redux'\nimport { bindActionCreators } from 'redux';\nimport {\n    getHomeJobDetails,\n    getMilestoneList,\n    getMilestoneDetails\n} from '../../../redux/homeSearch/actions';\nimport { setShowToast } from '../../../redux/common/actions';\nimport { renderTime } from '../../../utils/common';\n\nimport EditMilestones from './editMilestones/index';\nimport CancelJobs from './cancelJobs/cancelJob'\nimport LodgeDispute from './lodgeDispute/lodgeDispute';\nimport { CancelJob } from '../../../redux/jobs/actions';\nimport storageService from '../../../utils/storageService';\n\nimport SeeDetailsComponents from './seeDetails';\n\ninterface Mile {\n    milestoneId: any,\n    milestoneName: any,\n    isPhotoevidence: any,\n    status: any,\n    fromDate: any,\n    toDate: any,\n    enableEditMilestone: boolean,\n    enableLodgeDispute: boolean,\n    enableCancelJob: boolean\n}\n\nconst MarkMilestones = (props: any) => {\n\n    let resetStateLocal = props?.resetStateLocal;\n    let listData = props?.listData;\n    let selectedIndex = props?.selectedIndex;\n    let enableEditMilestone = props?.enableEditMilestone;\n    let enableLodgeDispute = props?.enableLodgeDispute;\n    let enableCancelJob = props?.enableCancelJob;\n\n    const [enableApprove, setEnableApprove] = useState(false);\n    const [itemDetails, setDetails] = useState(null);\n    const [selectedMilestoneIndex, setMilestoneIndex] = useState<any>(null);\n    const [selectedMile, setMilestone] = useState(null);\n    const [expandItem, setExpandItem] = useState<any>({});\n\n    const [toggleSeeDetails, setSeeDetails] = useState(false);\n\n    const [toggleItem, setToggleItem] = useState<{ [index: string]: boolean }>({ edit: false, cancel: false, lodge: false });\n\n    const backToScreen = () => {\n        preFetch();\n        setEnableApprove(false);\n        setSeeDetails(false);\n    }\n\n    let selectedItem: any = null;\n    if (listData?.length) {\n        selectedItem = listData[selectedIndex];\n\n    }\n    useEffect(() => {\n        fetchMilestoneDetail();\n    }, [selectedMilestoneIndex]);\n\n\n\n    const fetchMilestoneDetail = async () => {\n        if (selectedMilestoneIndex && Object.keys(selectedMilestoneIndex).length) {\n            const { milestoneId, jobId } = selectedMilestoneIndex;\n            if (milestoneId && jobId) {\n                let response: any = await getMilestoneDetails({ milestoneId, jobId });\n                if (response.success) {\n                    setMilestone(response.data);\n                    if (selectedMilestoneIndex?.type === \"detail\") {\n                        setSeeDetails(true);\n                    } else {\n                        setEnableApprove(true);\n                    }\n                }\n            }\n        }\n    }\n\n    useEffect(() => {\n        console.log({ props }, '-----??')\n        preFetch();\n    }, []);\n\n    useEffect(() => {\n        console.log({ expandItem })\n        if (Object.keys(expandItem).length === 0) {\n            preFetch();\n        }\n    }, [expandItem]);\n\n    useEffect(() => {\n        if (enableEditMilestone) {\n            setToggleItem({\n                edit: true, cancel: false, lodge: false\n            })\n        }\n\n        if (enableLodgeDispute) {\n            setToggleItem({\n                edit: false, cancel: false, lodge: true\n            })\n        }\n\n        if (enableCancelJob) {\n            setToggleItem({\n                edit: false, cancel: true, lodge: false\n            })\n        }\n    }, [enableEditMilestone, enableLodgeDispute, enableCancelJob])\n\n\n    const classChecks = (isActive: any, isPrevDone: any) => {\n        if (isActive === 1 && isPrevDone === false) {\n            return 'active';\n        } else if (isActive === 2 && isPrevDone === false) {\n            return 'check';\n        } else if (isActive === 1 && isPrevDone === 2) {\n            return 'active';\n        } else if (isActive === 2 && isPrevDone === 2) {\n            return 'check';\n        } else {\n            return 'disable'\n        }\n    }\n\n    const preFetch = async () => {\n        let { jobId } = selectedItem;\n        if (getMilestoneList) {\n            const res: any = await getMilestoneList(jobId);\n            if (res.success) {\n                console.log({ res }, '---->')\n                if (res?.data?.milestones?.length) {\n                    res?.data?.milestones?.forEach((item: any, index: any) => {\n                        if (index === 0) {\n                            const isActive = item?.status;\n                            let isPrevDone: any = false;\n                            isPrevDone = false;\n                            let result = classChecks(isActive, isPrevDone);\n                            console.log({ result }, '====>')\n                            if ([\"check\", \"active\"].includes(result)) {\n                                setExpandItem({\n                                    [item?.milestoneId]: true\n                                });\n                            }\n                        }\n                    })\n                }\n                setDetails(res.data);\n            }\n        }\n    }\n\n    const redirectToInfo = ({ jobId, status, tradieId }: any) => {\n        console.log({ jobId });\n        let props_: any = props;\n        // let urlEncode: any = window.btoa(`?jobId=${jobId}&status=${status}&tradieId=${tradieId}&edit=true&activeType=active&hide_dipute=${item_detail?.dispute}`)\n        let urlEncode: any = `?jobId=${jobId}&status=${status}&tradieId=${tradieId}&edit=true&activeType=active&hide_dipute=${item_detail?.dispute}`;\n        props_.history.push(`/job-detail?${urlEncode}`);\n    }\n\n    let item_details: any = itemDetails;\n    if (enableApprove) {\n        return (\n            <MilestoneApprove\n                resetStateLocal={resetStateLocal}\n                backToScreen={backToScreen}\n                data={{ selectedMile, selectedMilestoneIndex, selectedItem, itemDetails }}\n            />)\n    }\n\n    if (toggleSeeDetails) {\n        return (\n            <SeeDetailsComponents\n                resetStateLocal={resetStateLocal}\n                backToScreen={backToScreen}\n                data={{ selectedMile, selectedMilestoneIndex, selectedItem, itemDetails }}\n            />\n        )\n    }\n\n    const backTab = (name: string) => {\n        setToggleItem((prev: any) => ({ ...prev, [name]: false }));\n        setExpandItem({});\n    }\n\n\n\n    if (toggleItem?.edit) {\n        let details: any = itemDetails;\n        if (details && selectedItem) {\n            if (details && Object.keys(details)?.length && Object.keys(selectedItem).length) {\n                return (\n                    <EditMilestones\n                        details={details}\n                        item={selectedItem}\n                        backTab={backTab}\n                    />\n                )\n            }\n        }\n    }\n\n    if (toggleItem?.lodge) {\n        return (\n            <LodgeDispute item={selectedItem} backTab={backTab} />\n        )\n    }\n\n    if (toggleItem?.cancel) {\n        return (\n            <CancelJobs item={selectedItem} backTab={backTab} />\n        )\n    }\n\n    let item_detail: any = itemDetails;\n    let item_status = false;\n    if (item_details?.milestones?.length) {\n        let isExist = item_details?.milestones.find((item: any) => item.status === 1);\n        if (isExist) {\n            item_status = true;\n        }\n    }\n    let dataItems: any = [];\n    if (item_details?.milestones?.length) {\n        dataItems = item_details?.milestones;\n    }\n\n    return (\n        <div className=\"flex_row\">\n            <div className=\"flex_col_sm_6\">\n                <div className=\"relate\">\n                    <button\n                        className=\"back\"\n                        onClick={() => {\n                            // times\n                            resetStateLocal();\n                        }}\n                    ></button>\n                    <span className=\"xs_sub_title\">\n                        {item_detail && Object.keys(item_detail).length ? item_detail.jobName : ''}\n                    </span>\n\n                    <span className=\"dot_menu\">\n                        <img src={editIconBlue} alt=\"edit\" />\n                        <div className=\"edit_menu\">\n                            <ul>\n                                {/* {item_status && ( )} */}\n                                <li\n                                    onClick={() => { setToggleItem({ edit: true, lodge: false, cancel: false }) }}\n                                    className=\"icon edit_line\">\n                                    {'Edit Milestone'}\n                                </li>\n                                {!item_detail?.dispute && (\n                                    <li\n                                        onClick={() => { setToggleItem((prev: any) => ({ ...prev, lodge: true })) }}\n                                        className=\"icon lodge\">\n                                        {'Lodge dispute'}\n                                    </li>\n                                )}\n\n                                <li\n                                    onClick={() => { setToggleItem((prev: any) => ({ ...prev, cancel: true })) }}\n                                    className=\"icon delete\">Cancel job</li>\n                            </ul>\n                        </div>\n                    </span>\n\n\n                </div>\n                <span className=\"sub_title\">\n                    {'Job Milestones'}\n                </span>\n                <p className=\"commn_para\">\n                    {\"Your job point of contact has indicated they want to be notified when you reach the following milestones. Tap the milestone and Submit when a milestone is completed\"}\n                </p>\n\n                <ul className=\"milestones_check\">\n                    {dataItems?.map(({\n                        milestoneId,\n                        milestoneName,\n                        isPhotoevidence,\n                        status,\n                        fromDate,\n                        toDate,\n                    }: Mile,\n                        index: number\n                    ) => {\n                        const isActive = status;\n                        let isPrevDone: any = false;\n                        if (index === 0) {\n                            isPrevDone = false;\n                        } else {\n                            isPrevDone = dataItems[index - 1].status;\n                        }\n                        console.log({ isActive, isPrevDone, index, expandItem })\n                        return (\n                            <li\n                                key={milestoneId}\n                                className={classChecks(isActive, isPrevDone)}>\n                                <div\n                                    onClick={() => {\n                                        setExpandItem((prev: any) => ({\n                                            ...prev,\n                                            [milestoneId]: prev[milestoneId] === undefined ? true : !prev[milestoneId]\n                                        }));\n                                    }}\n                                    className=\"circle_stepper\">\n                                    <span></span>\n                                </div>\n                                <div className=\"info\">\n                                    <label>{milestoneName}</label>\n                                    {isPhotoevidence && (\n                                        <span>{'Photo evidence required'}</span>\n                                    )}\n                                    <span>\n                                        {renderTime(fromDate, toDate)}\n                                    </span>\n\n                                    {[\"check\"].includes(classChecks(isActive, isPrevDone)) && expandItem[milestoneId] ? (\n                                        <button\n                                            className=\"fill_btn full_btn btn-effect\"\n                                            style={{ backgroundColor: '#DFE5EF' }}\n                                            onClick={(e) => {\n                                                e.stopPropagation();\n                                                setMilestoneIndex({\n                                                    index,\n                                                    milestoneId,\n                                                    type: 'detail',\n                                                    jobId: item_details?.jobId\n                                                });\n                                            }}>\n                                            {'See Details'}\n                                        </button>\n                                    ) : null}\n                                </div>\n\n                                {[\"active\"].includes(classChecks(isActive, isPrevDone)) && expandItem[milestoneId] ? (\n                                    <button\n                                        className=\"fill_btn full_btn btn-effect\"\n                                        onClick={() => {\n                                            setMilestoneIndex({\n                                                index,\n                                                milestoneId,\n                                                type: 'approve',\n                                                jobId: item_details?.jobId\n                                            });\n                                        }}>\n                                        {'Check and Approve'}\n                                    </button>\n                                ) : null}\n                            </li>\n                        );\n                    }\n                    )}\n                </ul>\n            </div>\n            <div className=\"flex_col_sm_6 col_ruler\">\n                <span className=\"sub_title\">Tradie</span>\n\n                <div\n                    onClick={() => {\n                        console.log({ item_details })\n                        props?.history?.push(`tradie-info?tradeId=${item_details?.tradieId}&hideInvite=true&active=true`);\n                    }}\n                    className=\"tradie_card posted_by view_more \">\n                    <span\n                        onClick={(e) => {\n                            e.stopPropagation();\n                            props.history.push({\n                                pathname: `/chat`,\n                                state: {\n                                    tradieId: item_details?.tradieId,\n                                    builderId: storageService.getItem('userInfo')?._id,\n                                    jobId: item_details?.jobId,\n                                    jobName: item_details?.jobName\n                                }\n                            })\n                        }}\n                        className=\"chat circle\" />\n                    <div className=\"user_wrap\">\n                        <figure className=\"u_img\">\n                            <img\n                                src={item_details?.tradie?.tradieImage || dummy}\n                                alt=\"traide-img\"\n                                onError={(e: any) => {\n                                    if (e?.target?.onerror) {\n                                        e.target.onerror = null;\n                                    }\n                                    if (e?.target?.src) {\n                                        e.target.src = dummy;\n                                    }\n                                }}\n                            />\n                        </figure>\n                        <div className=\"details\">\n                            <span className=\"name\">{item_details?.tradie?.tradieName || ''}</span>\n                            {/* <span className=\"prof\">Project Manager</span> */}\n                            {item_details?.tradie && (\n                                <span className=\"rating\">\n                                    {item_details?.tradie?.ratings || 0} , {item_details?.tradie?.reviews || 0} reviews\n                                </span>\n                            )}\n                        </div>\n                    </div>\n                </div>\n\n                <div className=\"relate\">\n                    <span className=\"sub_title\">\n                        {'Job details'}\n                    </span>\n                    <span\n                        className=\"edit_icon\"\n                        title=\"More\"\n                        onClick={() => {\n                            let { jobId, tradeId, specializationId, tradieId, status } = selectedItem;\n                            redirectToInfo({ jobId, status, tradieId })\n                        }}>\n                        <img src={more} alt=\"more\" />\n                    </span>\n                </div>\n            </div>\n        </div>\n\n    )\n}\n\n// const mapProps = (dispatch: any) => {\n//     return bindActionCreators({\n//         getHomeJobDetails\n//     }, dispatch)\n// }\n\n// const mapState = () => ({\n\n// })\n\n// export default connect(mapState, mapProps)(withRouter(MarkMilestones));\nexport default withRouter(MarkMilestones)\n"]},"metadata":{},"sourceType":"module"}