{"ast":null,"code":"import _objectSpread from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import dummy from'../../assets/images/u_placeholder.jpg';import vouch from'../../assets/images/ic-template.png';import{withRouter}from'react-router-dom';import{getVouchers}from'../../redux/jobs/actions';import storageService from'../../utils/storageService';import AddVoucherModal from'./addVoucher';import VoucherDetailModal from'./voucherDetail';import InfiniteScroll from\"react-infinite-scroll-component\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Vouchers=function Vouchers(props){var _props$location,_props$location$state,_props$location2,_props$location2$stat,_props$location3;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),stateData=_useState2[0],setStateData=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),errors=_useState4[0],setErrors=_useState4[1];var _useState5=useState({isTrue:false,item:{}}),_useState6=_slicedToArray(_useState5,2),toggleRecommendation=_useState6[0],setToggleRecommendation=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),jobsList=_useState8[0],setJobsList=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),toggle=_useState10[0],setToggle=_useState10[1];var _useState11=useState({}),_useState12=_slicedToArray(_useState11,2),selectedItem=_useState12[0],setSelectedItem=_useState12[1];var _useState13=useState(1),_useState14=_slicedToArray(_useState13,2),currentPage=_useState14[0],setCurrentPage=_useState14[1];var _useState15=useState(true),_useState16=_slicedToArray(_useState15,2),hasMore=_useState16[0],setHasMore=_useState16[1];var id=props===null||props===void 0?void 0:(_props$location=props.location)===null||_props$location===void 0?void 0:(_props$location$state=_props$location.state)===null||_props$location$state===void 0?void 0:_props$location$state.id;var path=props===null||props===void 0?void 0:(_props$location2=props.location)===null||_props$location2===void 0?void 0:(_props$location2$stat=_props$location2.state)===null||_props$location2$stat===void 0?void 0:_props$location2$stat.path;var search=(props===null||props===void 0?void 0:(_props$location3=props.location)===null||_props$location3===void 0?void 0:_props$location3.search)||'';if(search===null||search===void 0?void 0:search.length){var urlParams=new URLSearchParams(search);var tradieId=urlParams.get('tradieId');if(tradieId===null||tradieId===void 0?void 0:tradieId.length){id=tradieId;}}var closeToggle=function closeToggle(isRecall){setToggleRecommendation({isTrue:false,item:{}});setSelectedItem({});setToggle(function(prev){return false;});if(isRecall==='isRecall'){prefetch();}};useEffect(function(){prefetch();},[id,path]);var prefetch=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res_profile,_res_profile$data,completeItems;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getVouchers({tradieId:id,page:1});case 2:res_profile=_context.sent;if(res_profile.success){completeItems=(res_profile===null||res_profile===void 0?void 0:(_res_profile$data=res_profile.data)===null||_res_profile$data===void 0?void 0:_res_profile$data.voucher)||(res_profile===null||res_profile===void 0?void 0:res_profile.data);//[]\nsetStateData(completeItems);}case 4:case\"end\":return _context.stop();}}},_callee);}));return function prefetch(){return _ref.apply(this,arguments);};}();var state_data=stateData;return/*#__PURE__*/_jsx(\"div\",{className:\"app_wrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"section_wrapper\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"custom_container\",children:[/*#__PURE__*/_jsx(VoucherDetailModal,{toggleProps:toggleRecommendation.isTrue,item:toggleRecommendation.item,id:id,closeToggle:closeToggle}),storageService.getItem('userType')===2&&/*#__PURE__*/_jsx(AddVoucherModal,{toggleProps:toggle,id:id,closeToggle:closeToggle}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex_row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex_col_sm_6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relate\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){// let path: any = props.location.state.path;\nif(!path){props.history.push('/');}else{props.history.push(\"tradie-info\".concat(path));}},className:\"back\"}),/*#__PURE__*/_jsx(\"span\",{className:\"title\",children:\"\".concat(stateData.length,\" \").concat(stateData.length===1?'Vouch':'Vouches')})]})}),storageService.getItem('userType')===2&&/*#__PURE__*/_jsx(\"div\",{className:\"flex_col_sm_6 text-right\",children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){setToggle(function(prev){return true;});},className:\"fill_btn btn-effect add_vouch\",children:'+ Leave a Vouch'})})]}),(state_data===null||state_data===void 0?void 0:state_data.length)?/*#__PURE__*/_jsx(\"div\",{className:\"section_wrapper\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"custom_container\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"sub_title\",children:'Vouches'}),/*#__PURE__*/_jsx(InfiniteScroll,{dataLength:state_data===null||state_data===void 0?void 0:state_data.length,next:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var cp,response,_response$data,completeItems;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log('Here!!!');cp=currentPage+1;setCurrentPage(function(prev){return prev+1;});_context2.next=5;return getVouchers({tradieId:id,page:cp});case 5:response=_context2.sent;if(response.success){completeItems=(response===null||response===void 0?void 0:(_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.voucher)||(response===null||response===void 0?void 0:response.data);//[]\nif(completeItems===null||completeItems===void 0?void 0:completeItems.length){setStateData(function(prev){return[].concat(_toConsumableArray(prev),_toConsumableArray(completeItems));});}else{setHasMore(false);}}case 7:case\"end\":return _context2.stop();}}},_callee2);})),hasMore:hasMore,loader:/*#__PURE__*/_jsx(_Fragment,{}),className:\"flex_row\",children:state_data.map(function(item){return/*#__PURE__*/_jsx(\"div\",{className:\"flex_col_sm_3\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"review_card vouchers\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"pic_shot_dtl\",children:[/*#__PURE__*/_jsx(\"figure\",{className:\"u_img\",children:/*#__PURE__*/_jsx(\"img\",{src:(item===null||item===void 0?void 0:item.builderImage)||dummy,alt:\"user-img\",onError:function onError(e){var _e$target,_e$target2;if(e===null||e===void 0?void 0:(_e$target=e.target)===null||_e$target===void 0?void 0:_e$target.onerror){e.target.onerror=null;}if(e===null||e===void 0?void 0:(_e$target2=e.target)===null||_e$target2===void 0?void 0:_e$target2.src){e.target.src=dummy;}}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"name_wrap\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"user_name\",title:(item===null||item===void 0?void 0:item.builderName)||'',children:(item===null||item===void 0?void 0:item.builderName)||''}),/*#__PURE__*/_jsx(\"span\",{className:\"date\",children:item===null||item===void 0?void 0:item.date})]})]}),/*#__PURE__*/_jsx(\"span\",{className:\"xs_head\",children:item===null||item===void 0?void 0:item.jobName}),/*#__PURE__*/_jsx(\"p\",{className:\"commn_para\",title:\"\",children:(item===null||item===void 0?void 0:item.vouchDescription)||''}),/*#__PURE__*/_jsxs(\"div\",{className:\"vouch\",children:[/*#__PURE__*/_jsx(\"figure\",{className:\"vouch_icon\",children:/*#__PURE__*/_jsx(\"img\",{src:vouch,alt:\"vouch\"})}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(e){e.preventDefault();setToggleRecommendation(function(prev){return _objectSpread(_objectSpread({},prev),{isTrue:true,item:item});});},className:\"link\",children:\"Vouch for \".concat(item===null||item===void 0?void 0:item.tradieName)})]})]})});})})]})}):null]})})});};export default withRouter(Vouchers);","map":{"version":3,"sources":["/home/appinventiv/Documents/Project/tickt/web/src/pages/tradieInfo/vouchers.tsx"],"names":["React","useState","useEffect","dummy","vouch","withRouter","getVouchers","storageService","AddVoucherModal","VoucherDetailModal","InfiniteScroll","Vouchers","props","stateData","setStateData","errors","setErrors","isTrue","item","toggleRecommendation","setToggleRecommendation","jobsList","setJobsList","toggle","setToggle","selectedItem","setSelectedItem","currentPage","setCurrentPage","hasMore","setHasMore","id","location","state","path","search","length","urlParams","URLSearchParams","tradieId","get","closeToggle","isRecall","prev","prefetch","page","res_profile","success","completeItems","data","voucher","state_data","getItem","history","push","console","log","cp","response","map","builderImage","e","target","onerror","src","builderName","date","jobName","vouchDescription","preventDefault","tradieName"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport dummy from '../../assets/images/u_placeholder.jpg';\nimport vouch from '../../assets/images/ic-template.png';\nimport { withRouter } from 'react-router-dom';\nimport {\n    getVouchers\n} from '../../redux/jobs/actions';\nimport storageService from '../../utils/storageService';\n\nimport AddVoucherModal from './addVoucher';\nimport VoucherDetailModal from './voucherDetail';\n\nimport InfiniteScroll from \"react-infinite-scroll-component\";\n\n\nconst Vouchers = (props: any) => {\n    const [stateData, setStateData] = useState<any>([]);\n    const [errors, setErrors] = useState({});\n    const [toggleRecommendation, setToggleRecommendation] = useState({ isTrue: false, item: {} });\n    const [jobsList, setJobsList] = useState([]);\n    const [toggle, setToggle] = useState(false);\n    const [selectedItem, setSelectedItem] = useState({});\n    const [currentPage, setCurrentPage] = useState(1);\n    const [hasMore, setHasMore] = useState(true);\n\n    let id = props?.location?.state?.id;\n    let path = props?.location?.state?.path;\n    let search: any = props?.location?.search || '';\n\n    if (search?.length) {\n        const urlParams = new URLSearchParams(search);\n        let tradieId: any = urlParams.get('tradieId');\n        if (tradieId?.length) {\n            id = tradieId;\n        }\n    }\n    const closeToggle = (isRecall?: string) => {\n        setToggleRecommendation({ isTrue: false, item: {} });\n        setSelectedItem({});\n        setToggle((prev: any) => false);\n        if (isRecall === 'isRecall') {\n            prefetch();\n        }\n    }\n\n\n\n    useEffect(() => {\n        prefetch();\n    }, [id, path])\n\n\n    const prefetch = async () => {\n        let res_profile: any = await getVouchers({ tradieId: id, page: 1 })\n        if (res_profile.success) {\n            let completeItems = res_profile?.data?.voucher || res_profile?.data;  //[]\n            setStateData(completeItems);\n        }\n    }\n\n\n    let state_data: any = stateData;\n\n    return (\n        <div className=\"app_wrapper\">\n            <div className=\"section_wrapper\">\n                <div className=\"custom_container\">\n\n                    <VoucherDetailModal\n                        toggleProps={toggleRecommendation.isTrue}\n                        item={toggleRecommendation.item}\n                        id={id}\n                        closeToggle={closeToggle}\n                    />\n                    {storageService.getItem('userType') === 2 &&\n                        <AddVoucherModal\n                            toggleProps={toggle}\n                            id={id}\n                            closeToggle={closeToggle}\n                        />}\n\n                    <div className=\"flex_row\">\n                        <div className=\"flex_col_sm_6\">\n                            <div className=\"relate\">\n                                <button\n                                    onClick={() => {\n                                        // let path: any = props.location.state.path;\n                                        if (!path) {\n                                            props.history.push('/');\n                                        } else {\n                                            props.history.push(`tradie-info${path}`);\n                                        }\n                                    }}\n                                    className=\"back\"></button>\n                                <span className=\"title\">\n                                    {`${stateData.length} ${stateData.length === 1 ? 'Vouch' : 'Vouches'}`}\n                                </span>\n                            </div>\n                        </div>\n                        {storageService.getItem('userType') === 2 && <div className=\"flex_col_sm_6 text-right\">\n                            <button\n                                onClick={() => { setToggle((prev: any) => true) }}\n                                className=\"fill_btn btn-effect add_vouch\">\n                                {'+ Leave a Vouch'}\n                            </button>\n                        </div>}\n                    </div>\n\n                    {state_data?.length ?\n                        <div className=\"section_wrapper\">\n                            <div className=\"custom_container\">\n                                <span className=\"sub_title\">\n                                    {'Vouches'}\n                                </span>\n\n                                <InfiniteScroll\n                                    dataLength={state_data?.length}\n                                    next={async () => {\n                                        console.log('Here!!!');\n                                        let cp: any = currentPage + 1;\n                                        setCurrentPage((prev: any) => prev + 1);\n                                        let response = await getVouchers({ tradieId: id, page: cp });\n                                        if (response.success) {\n                                            let completeItems = response?.data?.voucher || response?.data;  //[]\n                                            if (completeItems?.length) {\n                                                setStateData((prev: any) => ([...prev, ...completeItems]));\n                                            } else {\n                                                setHasMore(false);\n                                            }\n                                        }\n                                    }}\n                                    hasMore={hasMore}\n                                    loader={<></>}\n                                    className=\"flex_row\">\n                                    {state_data.map((item: any) => (\n                                        <div className=\"flex_col_sm_3\">\n                                            <div className=\"review_card vouchers\">\n                                                <div className=\"pic_shot_dtl\">\n                                                    <figure className=\"u_img\">\n                                                        <img\n                                                            src={item?.builderImage || dummy}\n                                                            alt=\"user-img\"\n                                                            onError={(e: any) => {\n                                                                if (e?.target?.onerror) {\n                                                                    e.target.onerror = null;\n                                                                }\n                                                                if (e?.target?.src) {\n                                                                    e.target.src = dummy;\n                                                                }\n                                                            }}\n                                                        />\n                                                    </figure>\n                                                    <div className=\"name_wrap\">\n                                                        <span className=\"user_name\" title={item?.builderName || ''}>\n                                                            {item?.builderName || ''}\n                                                        </span>\n                                                        <span className=\"date\">\n                                                            {item?.date}\n                                                        </span>\n                                                    </div>\n                                                </div>\n\n                                                <span className=\"xs_head\">\n                                                    {item?.jobName}\n                                                </span>\n\n                                                <p className=\"commn_para\" title=\"\">\n                                                    {item?.vouchDescription || ''}\n                                                </p>\n                                                <div className=\"vouch\">\n                                                    <figure className=\"vouch_icon\">\n                                                        <img src={vouch} alt=\"vouch\" />\n                                                    </figure>\n                                                    <span\n                                                        onClick={(e) => {\n                                                            e.preventDefault();\n                                                            setToggleRecommendation((prev: any) => ({ ...prev, ...{ isTrue: true, item: item } }));\n                                                        }}\n                                                        className=\"link\">\n                                                        {`Vouch for ${item?.tradieName}`}\n                                                    </span>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    ))}\n                                </InfiniteScroll>\n\n                            </div>\n                        </div>\n                        : null}\n                </div>\n            </div>\n        </div >\n    )\n}\n\nexport default withRouter(Vouchers);"]},"metadata":{},"sourceType":"module"}