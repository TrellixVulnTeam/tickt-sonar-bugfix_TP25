{"ast":null,"code":"import _objectSpread from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from\"react\";// @ts-ignore\nimport ReactStars from\"react-rating-stars-component\";import{reviewBuilder,getJobDetails}from\"../../../../redux/jobs/actions\";import{setShowToast}from\"../../../../redux/common/actions\";import{renderTime}from\"../../../../utils/common\";import dummy from\"../../../../assets/images/u_placeholder.jpg\";import more from\"../../../../assets/images/icon-direction-right.png\";import{moengage,mixPanel}from\"../../../../services/analyticsTools\";import{MoEConstants}from\"../../../../utils/constants\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ReviewBuilder=function ReviewBuilder(props){var _item$postedBy3,_item$builderData3,_item$builderData4,_item$builderData5,_item$postedBy4;var _useState=useState({rating:0,review:\"\"}),_useState2=_slicedToArray(_useState,2),reviewBuilderData=_useState2[0],setReviewBuilderData=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),item=_useState4[0],setItem=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isParam=_useState6[0],setIsParam=_useState6[1];useEffect(function(){var _URLSearchParams,_props$location;var jobId=(_URLSearchParams=new URLSearchParams((_props$location=props.location)===null||_props$location===void 0?void 0:_props$location.search))===null||_URLSearchParams===void 0?void 0:_URLSearchParams.get(\"jobId\");_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _props$location2,_props$location2$stat;var res,_props$location3,_props$location3$stat;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!jobId){_context.next=7;break;}_context.next=3;return getJobDetails(jobId);case 3:res=_context.sent;if(res.success){setItem(res.data);setIsParam(true);}_context.next=8;break;case 7:if(props===null||props===void 0?void 0:(_props$location2=props.location)===null||_props$location2===void 0?void 0:(_props$location2$stat=_props$location2.state)===null||_props$location2$stat===void 0?void 0:_props$location2$stat.item){setItem(props===null||props===void 0?void 0:(_props$location3=props.location)===null||_props$location3===void 0?void 0:(_props$location3$stat=_props$location3.state)===null||_props$location3$stat===void 0?void 0:_props$location3$stat.item);}case 8:case\"end\":return _context.stop();}}},_callee);}))();},[]);console.log(props,\"props data\",item,\"item\");var ratingChanged=function ratingChanged(newRating){console.log(newRating);setReviewBuilderData(function(prevdata){return _objectSpread(_objectSpread({},prevdata),{},{rating:newRating});});};var handleChange=function handleChange(e){if(e.target.value.trim().length<=1000){setReviewBuilderData(function(prevdata){return _objectSpread(_objectSpread({},prevdata),{},{review:e.target.value});});}};var submitReviewClicked=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _item$postedBy,_item$builderData,data,response,_props$history,mData;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(reviewBuilderData.rating===0)){_context2.next=3;break;}setShowToast(true,\"Star rating is required\");return _context2.abrupt(\"return\");case 3:if(!(reviewBuilderData.rating>0)){_context2.next=10;break;}data={jobId:item===null||item===void 0?void 0:item.jobId,builderId:isParam?item===null||item===void 0?void 0:(_item$postedBy=item.postedBy)===null||_item$postedBy===void 0?void 0:_item$postedBy.builderId:item===null||item===void 0?void 0:(_item$builderData=item.builderData)===null||_item$builderData===void 0?void 0:_item$builderData.builderId,rating:reviewBuilderData.rating,review:reviewBuilderData.review.trim()};if(!data.review)delete data.review;_context2.next=8;return reviewBuilder(data);case 8:response=_context2.sent;if(response===null||response===void 0?void 0:response.success){mData={timeStamp:moengage.getCurrentTimeStamp()};moengage.moE_SendEvent(MoEConstants.ADDED_REVIEW,mData);mixPanel.mixP_SendEvent(MoEConstants.ADDED_REVIEW,mData);props===null||props===void 0?void 0:(_props$history=props.history)===null||_props$history===void 0?void 0:_props$history.push(\"/builder-review-submitted\");}case 10:case\"end\":return _context2.stop();}}},_callee2);}));return function submitReviewClicked(){return _ref2.apply(this,arguments);};}();var jobClickHandler=function jobClickHandler(){// props.history.push(`/job-details-page?jobId=${item?.jobId}&tradeId=${item?.tradeId}&specializationId=${item?.specializationId}`);\nprops.history.push(\"/job-details-page?jobId=\".concat(item===null||item===void 0?void 0:item.jobId,\"&redirect_from=jobs\"));};var builderClicked=function builderClicked(){var _item$postedBy2,_item$builderData2;props.history.push(\"/builder-info?builderId=\".concat(isParam?(_item$postedBy2=item.postedBy)===null||_item$postedBy2===void 0?void 0:_item$postedBy2.builderId:(_item$builderData2=item.builderData)===null||_item$builderData2===void 0?void 0:_item$builderData2.builderId));};return/*#__PURE__*/_jsx(\"div\",{className:\"detail_col\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex_row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex_col_sm_6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relate\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back\",onClick:function onClick(){var _props$history2;return props===null||props===void 0?void 0:(_props$history2=props.history)===null||_props$history2===void 0?void 0:_props$history2.goBack();}}),/*#__PURE__*/_jsx(\"span\",{className:\"xs_sub_title\",children:item===null||item===void 0?void 0:item.jobName})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(\"span\",{className:\"sub_title\",children:\"Review completed job\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"inner_title\",children:\"Rate this builder\"}),/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(ReactStars,{count:5,onChange:ratingChanged,size:55,isHalf:true,emptyIcon:/*#__PURE__*/_jsx(\"i\",{className:\"far fa-star\"}),halfIcon:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star-half-alt\"}),fullIcon:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star\"}),activeColor:\"#fee600\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"form_field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form_label\",children:\"Comment (optional)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text_field\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Thanks..\",maxLength:1000,onChange:handleChange})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(\"button\",{className:\"fill_btn full_btn btn-effect\",onClick:submitReviewClicked,children:\"Leave review\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex_col_sm_6 col_ruler\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relate\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"sub_title\",children:\"Job details\"}),/*#__PURE__*/_jsx(\"span\",{className:\"edit_icon\",title:\"More\",onClick:jobClickHandler,children:/*#__PURE__*/_jsx(\"img\",{src:more,alt:\"more\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"tradie_card posted_by \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"user_wrap\",onClick:function onClick(){return builderClicked();},children:[/*#__PURE__*/_jsx(\"figure\",{className:\"u_img\",children:/*#__PURE__*/_jsx(\"img\",{src:isParam?(_item$postedBy3=item.postedBy)===null||_item$postedBy3===void 0?void 0:_item$postedBy3.builderImage:((_item$builderData3=item.builderData)===null||_item$builderData3===void 0?void 0:_item$builderData3.builderImage)?(_item$builderData4=item.builderData)===null||_item$builderData4===void 0?void 0:_item$builderData4.builderImage:dummy,alt:\"traide-img\",onError:function onError(e){var _e$target,_e$target2;if(e===null||e===void 0?void 0:(_e$target=e.target)===null||_e$target===void 0?void 0:_e$target.onerror){e.target.onerror=null;}if(e===null||e===void 0?void 0:(_e$target2=e.target)===null||_e$target2===void 0?void 0:_e$target2.src){e.target.src=dummy;}}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"details\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"name\",children:((_item$builderData5=item.builderData)===null||_item$builderData5===void 0?void 0:_item$builderData5.builderName)||((_item$postedBy4=item.postedBy)===null||_item$postedBy4===void 0?void 0:_item$postedBy4.builderName)}),/*#__PURE__*/_jsx(\"span\",{className:\"prof\",children:item===null||item===void 0?void 0:item.jobName}),/*#__PURE__*/_jsx(\"span\",{className:\"prof\",children:renderTime(item===null||item===void 0?void 0:item.fromDate,item===null||item===void 0?void 0:item.toDate)})]})]})})]})]})});};export default ReviewBuilder;","map":{"version":3,"sources":["/home/appinventiv/Documents/Project/tickt/web/src/pages/jobDashboard/components/reviewBuilder/reviewBuilder.tsx"],"names":["useState","useEffect","ReactStars","reviewBuilder","getJobDetails","setShowToast","renderTime","dummy","more","moengage","mixPanel","MoEConstants","ReviewBuilder","props","rating","review","reviewBuilderData","setReviewBuilderData","item","setItem","isParam","setIsParam","jobId","URLSearchParams","location","search","get","res","success","data","state","console","log","ratingChanged","newRating","prevdata","handleChange","e","target","value","trim","length","submitReviewClicked","builderId","postedBy","builderData","response","mData","timeStamp","getCurrentTimeStamp","moE_SendEvent","ADDED_REVIEW","mixP_SendEvent","history","push","jobClickHandler","builderClicked","goBack","jobName","builderImage","onerror","src","builderName","fromDate","toDate"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\n// @ts-ignore\nimport ReactStars from \"react-rating-stars-component\";\nimport { reviewBuilder, getJobDetails } from \"../../../../redux/jobs/actions\";\nimport { setShowToast } from \"../../../../redux/common/actions\";\nimport { renderTime } from \"../../../../utils/common\";\n\nimport dummy from \"../../../../assets/images/u_placeholder.jpg\";\nimport more from \"../../../../assets/images/icon-direction-right.png\";\nimport { moengage, mixPanel } from \"../../../../services/analyticsTools\";\nimport { MoEConstants } from \"../../../../utils/constants\";\n\ninterface Proptypes {\n  history: any;\n  location: any;\n}\nconst ReviewBuilder = (props: Proptypes) => {\n  const [reviewBuilderData, setReviewBuilderData] = useState({\n    rating: 0,\n    review: \"\",\n  });\n  const [item, setItem] = useState<any>(\"\");\n  const [isParam, setIsParam] = useState<boolean>(false);\n\n  useEffect(() => {\n    const jobId: any = new URLSearchParams(props.location?.search)?.get(\n      \"jobId\"\n    );\n    (async () => {\n      if (jobId) {\n        const res = await getJobDetails(jobId);\n        if (res.success) {\n          setItem(res.data);\n          setIsParam(true);\n        }\n      } else if (props?.location?.state?.item) {\n        setItem(props?.location?.state?.item);\n      }\n    })();\n  }, []);\n  console.log(props, \"props data\", item, \"item\");\n\n  const ratingChanged = (newRating: number) => {\n    console.log(newRating);\n    setReviewBuilderData((prevdata: any) => ({\n      ...prevdata,\n      rating: newRating,\n    }));\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.value.trim().length <= 1000) {\n      setReviewBuilderData((prevdata: any) => ({\n        ...prevdata,\n        review: e.target.value,\n      }));\n    }\n  };\n\n  const submitReviewClicked = async () => {\n    if (reviewBuilderData.rating === 0) {\n      setShowToast(true, \"Star rating is required\");\n      return;\n    }\n    if (reviewBuilderData.rating > 0) {\n      let data: any = {\n        jobId: item?.jobId,\n        builderId: isParam\n          ? item?.postedBy?.builderId\n          : item?.builderData?.builderId,\n        rating: reviewBuilderData.rating,\n        review: reviewBuilderData.review.trim(),\n      };\n      if (!data.review) delete data.review;\n      const response = await reviewBuilder(data);\n      if (response?.success) {\n        const mData = {\n          timeStamp: moengage.getCurrentTimeStamp(),\n        };\n        moengage.moE_SendEvent(MoEConstants.ADDED_REVIEW, mData);\n        mixPanel.mixP_SendEvent(MoEConstants.ADDED_REVIEW, mData);\n        props?.history?.push(\"/builder-review-submitted\");\n      }\n    }\n  };\n\n  const jobClickHandler = () => {\n    // props.history.push(`/job-details-page?jobId=${item?.jobId}&tradeId=${item?.tradeId}&specializationId=${item?.specializationId}`);\n    props.history.push(\n      `/job-details-page?jobId=${item?.jobId}&redirect_from=jobs`\n    );\n  };\n\n  const builderClicked = () => {\n    props.history.push(\n      `/builder-info?builderId=${\n        isParam ? item.postedBy?.builderId : item.builderData?.builderId\n      }`\n    );\n  };\n\n  return (\n    <div className=\"detail_col\">\n      <div className=\"flex_row\">\n        <div className=\"flex_col_sm_6\">\n          <div className=\"relate\">\n            <button\n              className=\"back\"\n              onClick={() => props?.history?.goBack()}\n            ></button>\n            <span className=\"xs_sub_title\">{item?.jobName}</span>\n          </div>\n          <div className=\"form_field\">\n            <span className=\"sub_title\">Review completed job</span>\n          </div>\n          <span className=\"inner_title\">Rate this builder</span>\n          <div className=\"form_field\">\n            <ReactStars\n              count={5}\n              onChange={ratingChanged}\n              size={55}\n              isHalf={true}\n              emptyIcon={<i className=\"far fa-star\"></i>}\n              halfIcon={<i className=\"fa fa-star-half-alt\"></i>}\n              fullIcon={<i className=\"fa fa-star\"></i>}\n              activeColor=\"#fee600\"\n            />\n          </div>\n          <div className=\"form_field\">\n            <label className=\"form_label\">Comment (optional)</label>\n            <div className=\"text_field\">\n              <input\n                type=\"text\"\n                placeholder=\"Thanks..\"\n                maxLength={1000}\n                onChange={handleChange}\n              />\n            </div>\n          </div>\n          <div className=\"form_field\">\n            <button\n              className=\"fill_btn full_btn btn-effect\"\n              onClick={submitReviewClicked}\n            >\n              Leave review\n            </button>\n          </div>\n        </div>\n        <div className=\"flex_col_sm_6 col_ruler\">\n          <div className=\"relate\">\n            <span className=\"sub_title\">Job details</span>\n            <span className=\"edit_icon\" title=\"More\" onClick={jobClickHandler}>\n              <img src={more} alt=\"more\" />\n            </span>\n          </div>\n          <div className=\"tradie_card posted_by \">\n            <div className=\"user_wrap\" onClick={() => builderClicked()}>\n              <figure className=\"u_img\">\n                <img\n                  src={\n                    isParam\n                      ? item.postedBy?.builderImage\n                      : item.builderData?.builderImage\n                      ? item.builderData?.builderImage\n                      : dummy\n                  }\n                  alt=\"traide-img\"\n                  onError={(e: any) => {\n                    if (e?.target?.onerror) {\n                      e.target.onerror = null;\n                    }\n                    if (e?.target?.src) {\n                      e.target.src = dummy;\n                    }\n                  }}\n                />\n              </figure>\n              <div className=\"details\">\n                <span className=\"name\">\n                  {item.builderData?.builderName || item.postedBy?.builderName}\n                </span>\n                <span className=\"prof\">{item?.jobName}</span>\n                <span className=\"prof\">\n                  {renderTime(item?.fromDate, item?.toDate)}\n                </span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ReviewBuilder;\n"]},"metadata":{},"sourceType":"module"}