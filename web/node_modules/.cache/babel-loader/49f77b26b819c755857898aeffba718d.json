{"ast":null,"code":"import _objectSpread from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from\"react\";// @ts-ignore\nimport{DateRangePicker}from\"react-date-range\";import\"react-date-range/dist/styles.css\";// main style file\nimport\"react-date-range/dist/theme/default.css\";// theme css file\nimport moment from\"moment\";import{setShowToast}from\"../../../redux/common/actions\";import{useLocation}from\"react-router-dom\";import _ from\"lodash\";import Button from\"@material-ui/core/Button\";import Dialog from\"@material-ui/core/Dialog\";import DialogActions from\"@material-ui/core/DialogActions\";import DialogTitle from\"@material-ui/core/DialogTitle\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var default_format=\"YYYY-MM-DD\";var ChooseTiming=function ChooseTiming(_ref){var data=_ref.data,milestones=_ref.milestones,stepCompleted=_ref.stepCompleted,handleStepComplete=_ref.handleStepComplete,handleStepBack=_ref.handleStepBack;var location=useLocation();var jobId=null;if(location.search){var urlParams=new URLSearchParams(location.search);jobId=urlParams.get(\"jobId\");}var setCurrentDateWithoutTime=function setCurrentDateWithoutTime(){var date=new Date();date.setHours(0,0,0,0);return date;};var _useState=useState({//startDate: '', //new Date(), // ''\nstartDate:setCurrentDateWithoutTime(),// ''\nendDate:setCurrentDateWithoutTime(),key:\"selection\"}),_useState2=_slicedToArray(_useState,2),range=_useState2[0],setRange=_useState2[1];var _useState3=useState(data.isSingleDayJob?2:1),_useState4=_slicedToArray(_useState3,2),singleDayRange=_useState4[0],setSingleDayRange=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),singleDayModal=_useState6[0],setSingleDayModal=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),formattedDates=_useState8[0],setFormattedDates=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),error=_useState10[0],setError=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),localChanges=_useState12[0],setLocalChanges=_useState12[1];useEffect(function(){if(stepCompleted){if(jobId){var startDt=moment(data.from_date,\"YYYY-MM-DD\").isSameOrAfter(moment().format(\"YYYY-MM-DD\"))?moment(data.from_date).toDate():\"\";var endDt=moment(data.to_date,\"YYYY-MM-DD\").isSameOrAfter(moment().format(\"YYYY-MM-DD\"))?moment(data.to_date).toDate():\"\";if(data.isJobRepublish){if(!startDt){startDt=new Date();}if(!endDt){endDt=new Date();}}setRange({startDate:startDt,endDate:endDt,key:\"selection\"});handleCheck({startDate:startDt,endDate:endDt});}else{setRange({startDate:data.from_date?moment(data.from_date).toDate():new Date(),endDate:data.to_date?moment(data.to_date).toDate():\"\",key:\"selection\"});}setLocalChanges(true);}},[data,stepCompleted]);useEffect(function(){if(singleDayRange===2){if(!data.isSingleDayJob){setSingleDayModal(true);}}else if(singleDayRange===1){handleCheck(range);}},[singleDayRange,range]);var handleChange=function handleChange(item){var mile=milestones;// console.log({ mile, item });\nif(mile===null||mile===void 0?void 0:mile.length){var start_selection=moment(item.selection.startDate).format(\"MM-DD-YYYY\");var end_selection=moment(item.selection.endDate).isValid()?moment(item.selection.endDate).format(\"MM-DD-YYYY\"):null;var item_find=false;mile.forEach(function(item_date){var start=item_date.from_date;var end=moment(item_date.to_date).isValid()?item_date.to_date:null;if(start&&end){if(moment(start_selection).isAfter(start)||moment(end_selection).isBefore(end)){item_find=true;}}if(start&&!end){if(moment(start_selection).isAfter(start)){item_find=true;// true;\n}}if(start_selection&&end_selection&&!end){if(moment(start).isSameOrAfter(start_selection)&&moment(start).isSameOrBefore(end_selection)){item_find=false;}else{item_find=true;}}});if(item_find&&!jobId){setShowToast(true,\"Please check the milestone dates\");return;}}setRange(item.selection);handleCheck(item.selection);console.log(_.isEqual(item.selection.startDate,item.selection.endDate),\"val\",_.isEqual(item.selection,range),singleDayRange);if(_.isEqual(item.selection.startDate,item.selection.endDate)&&singleDayRange===null||!_.isEqual(item.selection,range)){setSingleDayRange(1);return;}if(_.isEqual(item.selection.startDate,item.selection.endDate)&&_.isEqual(item.selection,range)&&singleDayRange===1){setSingleDayRange(2);return;}if(_.isEqual(item.selection.startDate,item.selection.endDate)&&_.isEqual(item.selection,range)&&singleDayRange===2)return;if(singleDayRange===1||singleDayRange===2)setSingleDayRange(null);};var handleCheck=function handleCheck(item){var from_date=moment(item.startDate).format(default_format);var to_date=moment(item.endDate).format(default_format);setFormattedDates({from_date:from_date,to_date:to_date});if(moment(from_date,default_format).isAfter(moment(to_date,default_format))){// isAfter\nsetError(\"finish date is greater then the start date.\");}else{setError(\"\");}};var handleContinue=function handleContinue(){handleStepComplete(_objectSpread(_objectSpread({},formattedDates),singleDayRange===2?{isSingleDayJob:true}:{isSingleDayJob:false}));};var checkDisable=function checkDisable(){if((range===null||range===void 0?void 0:range.startDate)&&(range===null||range===void 0?void 0:range.startDate)!==\"Invalid date\"){return false;}return true;};return/*#__PURE__*/_jsx(\"div\",{className:\"app_wrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"section_wrapper\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"custom_container\",children:[/*#__PURE__*/_jsxs(Dialog,{open:singleDayModal// onClose={handleClose}\n,\"aria-labelledby\":\"alert-dialog-title\",\"aria-describedby\":\"alert-dialog-description\",children:[/*#__PURE__*/_jsx(DialogTitle,{id:\"alert-dialog-title\",children:\"Are you sure you want to create single day job?\"}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:function onClick(){setSingleDayModal(false);},color:\"primary\",children:\"Yes\"}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){setSingleDayModal(false);setSingleDayRange(1);},color:\"primary\",autoFocus:true,children:\"No\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex_row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex_col_sm_5\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relate\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back\",onClick:handleStepBack}),/*#__PURE__*/_jsx(\"span\",{className:\"title\",children:\"Timing\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"commn_para\",children:\"Choose the start and finish day of your job\"})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex_row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex_col_sm_8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(DateRangePicker,{ranges:[range],onChange:handleChange,months:2,direction:\"horizontal\",moveRangeOnFirstSelection:false,rangeColors:[\"#fee600\",\"#b5b5b5\"],showDateDisplay:false,showSelectionPreview:true,showPreview:true,minDate:new Date(),maxDate:moment().add(2,\"years\").toDate(),fixedHeight:true})}),/*#__PURE__*/_jsx(\"span\",{className:\"error_msg mtb-15\",children:error}),/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(\"button\",{className:\"fill_btn full_btn btn-effect \".concat(checkDisable()?\"disable_btn\":\"\"),onClick:handleContinue,children:\"Continue\"})})]})})]})})});};export default ChooseTiming;","map":{"version":3,"sources":["/home/appinventiv/Documents/Project/tickt/web/src/pages/postJob/components/chooseTiming.tsx"],"names":["useState","useEffect","DateRangePicker","moment","setShowToast","useLocation","_","Button","Dialog","DialogActions","DialogTitle","default_format","ChooseTiming","data","milestones","stepCompleted","handleStepComplete","handleStepBack","location","jobId","search","urlParams","URLSearchParams","get","setCurrentDateWithoutTime","date","Date","setHours","startDate","endDate","key","range","setRange","isSingleDayJob","singleDayRange","setSingleDayRange","singleDayModal","setSingleDayModal","formattedDates","setFormattedDates","error","setError","localChanges","setLocalChanges","startDt","from_date","isSameOrAfter","format","toDate","endDt","to_date","isJobRepublish","handleCheck","handleChange","item","mile","length","start_selection","selection","end_selection","isValid","item_find","forEach","item_date","start","end","isAfter","isBefore","isSameOrBefore","console","log","isEqual","handleContinue","checkDisable","add"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\n// @ts-ignore\nimport { DateRangePicker } from \"react-date-range\";\nimport \"react-date-range/dist/styles.css\"; // main style file\nimport \"react-date-range/dist/theme/default.css\"; // theme css file\nimport moment from \"moment\";\nimport { setShowToast } from \"../../../redux/common/actions\";\nimport { useLocation } from \"react-router-dom\";\nimport _ from \"lodash\";\nimport Button from \"@material-ui/core/Button\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\n\ninterface Proptypes {\n  data: any;\n  milestones: any;\n  stepCompleted: Boolean;\n  handleStepComplete: (data: any) => void;\n  handleStepBack: () => void;\n}\n\nconst default_format = \"YYYY-MM-DD\";\nconst ChooseTiming = ({\n  data,\n  milestones,\n  stepCompleted,\n  handleStepComplete,\n  handleStepBack,\n}: Proptypes) => {\n  let location = useLocation();\n  let jobId: any = null;\n\n  if (location.search) {\n    let urlParams = new URLSearchParams(location.search);\n    jobId = urlParams.get(\"jobId\");\n  }\n\n  const setCurrentDateWithoutTime = () => {\n    const date = new Date();\n    date.setHours(0, 0, 0, 0);\n    return date;\n  };\n  const [range, setRange] = useState<{ [index: string]: any }>({\n    //startDate: '', //new Date(), // ''\n    startDate: setCurrentDateWithoutTime(), // ''\n    endDate: setCurrentDateWithoutTime(),\n    key: \"selection\",\n  });\n  const [singleDayRange, setSingleDayRange] = useState<number | null>(\n    data.isSingleDayJob ? 2 : 1\n  );\n  const [singleDayModal, setSingleDayModal] = useState<boolean>(false);\n  const [formattedDates, setFormattedDates] = useState({});\n  const [error, setError] = useState(\"\");\n  const [localChanges, setLocalChanges] = useState(false);\n\n  useEffect(() => {\n    if (stepCompleted) {\n      if (jobId) {\n        let startDt = moment(data.from_date, \"YYYY-MM-DD\").isSameOrAfter(\n          moment().format(\"YYYY-MM-DD\")\n        )\n          ? moment(data.from_date).toDate()\n          : \"\";\n        let endDt = moment(data.to_date, \"YYYY-MM-DD\").isSameOrAfter(\n          moment().format(\"YYYY-MM-DD\")\n        )\n          ? moment(data.to_date).toDate()\n          : \"\";\n        if (data.isJobRepublish) {\n          if (!startDt) {\n            startDt = new Date();\n          }\n          if (!endDt) {\n            endDt = new Date();\n          }\n        }\n        setRange({\n          startDate: startDt,\n          endDate: endDt,\n          key: \"selection\",\n        });\n        handleCheck({ startDate: startDt, endDate: endDt });\n      } else {\n        setRange({\n          startDate: data.from_date\n            ? moment(data.from_date).toDate()\n            : new Date(),\n          endDate: data.to_date ? moment(data.to_date).toDate() : \"\",\n          key: \"selection\",\n        });\n      }\n      setLocalChanges(true);\n    }\n  }, [data, stepCompleted]);\n\n  useEffect(() => {\n    if (singleDayRange === 2) {\n      if (!data.isSingleDayJob) {\n        setSingleDayModal(true);\n      }\n    } else if (singleDayRange === 1) {\n      handleCheck(range);\n    }\n  }, [singleDayRange, range]);\n\n  const handleChange = (item: any) => {\n    let mile: any = milestones;\n    // console.log({ mile, item });\n    if (mile?.length) {\n      let start_selection: any = moment(item.selection.startDate).format(\n        \"MM-DD-YYYY\"\n      );\n      let end_selection: any = moment(item.selection.endDate).isValid()\n        ? moment(item.selection.endDate).format(\"MM-DD-YYYY\")\n        : null;\n      let item_find: any = false;\n\n      mile.forEach((item_date: any) => {\n        let start: any = item_date.from_date;\n        let end: any = moment(item_date.to_date).isValid()\n          ? item_date.to_date\n          : null;\n\n        if (start && end) {\n          if (\n            moment(start_selection).isAfter(start) ||\n            moment(end_selection).isBefore(end)\n          ) {\n            item_find = true;\n          }\n        }\n\n        if (start && !end) {\n          if (moment(start_selection).isAfter(start)) {\n            item_find = true; // true;\n          }\n        }\n\n        if (start_selection && end_selection && !end) {\n          if (\n            moment(start).isSameOrAfter(start_selection) &&\n            moment(start).isSameOrBefore(end_selection)\n          ) {\n            item_find = false;\n          } else {\n            item_find = true;\n          }\n        }\n      });\n\n      if (item_find && !jobId) {\n        setShowToast(true, \"Please check the milestone dates\");\n        return;\n      }\n    }\n    setRange(item.selection);\n    handleCheck(item.selection);\n    console.log(\n      _.isEqual(item.selection.startDate, item.selection.endDate),\n      \"val\",\n      _.isEqual(item.selection, range),\n      singleDayRange\n    );\n    if (\n      (_.isEqual(item.selection.startDate, item.selection.endDate) &&\n        singleDayRange === null) ||\n      !_.isEqual(item.selection, range)\n    ) {\n      setSingleDayRange(1);\n      return;\n    }\n    if (\n      _.isEqual(item.selection.startDate, item.selection.endDate) &&\n      _.isEqual(item.selection, range) &&\n      singleDayRange === 1\n    ) {\n      setSingleDayRange(2);\n      return;\n    }\n    if (\n      _.isEqual(item.selection.startDate, item.selection.endDate) &&\n      _.isEqual(item.selection, range) &&\n      singleDayRange === 2\n    )\n      return;\n    if (singleDayRange === 1 || singleDayRange === 2) setSingleDayRange(null);\n  };\n\n  const handleCheck = (item: any) => {\n    let from_date = moment(item.startDate).format(default_format);\n    let to_date = moment(item.endDate).format(default_format);\n    setFormattedDates({ from_date, to_date });\n    if (\n      moment(from_date, default_format).isAfter(moment(to_date, default_format))\n    ) {\n      // isAfter\n      setError(\"finish date is greater then the start date.\");\n    } else {\n      setError(\"\");\n    }\n  };\n\n  const handleContinue = () => {\n    handleStepComplete({\n      ...formattedDates,\n      ...(singleDayRange === 2\n        ? { isSingleDayJob: true }\n        : { isSingleDayJob: false }),\n    });\n  };\n\n  const checkDisable = () => {\n    if (range?.startDate && range?.startDate !== \"Invalid date\") {\n      return false;\n    }\n    return true;\n  };\n\n  return (\n    <div className=\"app_wrapper\">\n      <div className=\"section_wrapper\">\n        <div className=\"custom_container\">\n          <Dialog\n            open={singleDayModal}\n            // onClose={handleClose}\n            aria-labelledby=\"alert-dialog-title\"\n            aria-describedby=\"alert-dialog-description\"\n          >\n            <DialogTitle id=\"alert-dialog-title\">\n              {\"Are you sure you want to create single day job?\"}\n            </DialogTitle>\n            <DialogActions>\n              <Button\n                onClick={() => {\n                  setSingleDayModal(false);\n                }}\n                color=\"primary\"\n              >\n                {\"Yes\"}\n              </Button>\n              <Button\n                onClick={() => {\n                  setSingleDayModal(false);\n                  setSingleDayRange(1);\n                }}\n                color=\"primary\"\n                autoFocus\n              >\n                {\"No\"}\n              </Button>\n            </DialogActions>\n          </Dialog>\n\n          <div className=\"form_field\">\n            <div className=\"flex_row\">\n              <div className=\"flex_col_sm_5\">\n                <div className=\"relate\">\n                  <button className=\"back\" onClick={handleStepBack}></button>\n                  <span className=\"title\">Timing</span>\n                </div>\n                <p className=\"commn_para\">\n                  {\"Choose the start and finish day of your job\"}\n                </p>\n              </div>\n            </div>\n          </div>\n          <div className=\"flex_row\">\n            <div className=\"flex_col_sm_8\">\n              <div className=\"form_field\">\n                <DateRangePicker\n                  ranges={[range]}\n                  onChange={handleChange}\n                  months={2}\n                  direction=\"horizontal\"\n                  moveRangeOnFirstSelection={false}\n                  rangeColors={[\"#fee600\", \"#b5b5b5\"]}\n                  showDateDisplay={false}\n                  showSelectionPreview={true}\n                  showPreview={true}\n                  minDate={new Date()}\n                  maxDate={moment().add(2, \"years\").toDate()}\n                  fixedHeight={true}\n                />\n              </div>\n              <span className=\"error_msg mtb-15\">{error}</span>\n              <div className=\"form_field\">\n                <button\n                  className={`fill_btn full_btn btn-effect ${\n                    checkDisable() ? \"disable_btn\" : \"\"\n                  }`}\n                  onClick={handleContinue}\n                >\n                  {\"Continue\"}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ChooseTiming;\n"]},"metadata":{},"sourceType":"module"}