{"ast":null,"code":"import _slicedToArray from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';// @ts-ignore\nimport{DateRangePicker}from'../../../plugins/react-date-range/dist/index';import'../../../plugins/react-date-range/dist/styles.css';import'../../../plugins/react-date-range/dist/theme/default.css';import moment from'moment';import{setShowToast}from'../../../redux/common/actions';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var default_format='YYYY-MM-DD';var STRING_ERROR='Selected data is fully engage';var ChooseTimingMileStone=function ChooseTimingMileStone(_ref){var _data$from_date;var data=_ref.data,stepCompleted=_ref.stepCompleted,randomColors=_ref.randomColors,handleStepForward=_ref.handleStepForward,updateMileStoneTimings=_ref.updateMileStoneTimings,editMileStone=_ref.editMileStone,addTimeToMileStone=_ref.addTimeToMileStone,milestones=_ref.milestones,handleStepComplete=_ref.handleStepComplete,handleStepMileStone=_ref.handleStepMileStone,handleStepBack=_ref.handleStepBack;var _useState=useState({startDate:'',//new Date(),\nendDate:'',//new Date(),\nkey:'selection'}),_useState2=_slicedToArray(_useState,2),range=_useState2[0],setRange=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),formattedDates=_useState4[0],setFormattedDates=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),localChanges=_useState8[0],setLocalChanges=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isToggle=_useState10[0],setIsToggle=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),force=_useState12[0],forceUpdate=_useState12[1];var onMountCallable=function onMountCallable(){var count_times={};// console.log({ randomColors })\nvar filteredItems=milestones.filter(function(item){var to_date=item===null||item===void 0?void 0:item.to_date;var from_date=item===null||item===void 0?void 0:item.from_date;if(from_date){count_times[from_date]=0;}if(to_date){count_times[to_date]=0;}if(Object.keys(item).length&&(item===null||item===void 0?void 0:item.from_date)){return item;}var ifMatch=milestones.find(function(item_){if(item_.to_date===to_date&&from_date===item_.from_date){return item_;}});return ifMatch;});if(filteredItems===null||filteredItems===void 0?void 0:filteredItems.length){filteredItems.forEach(function(item,index){var to_date=item===null||item===void 0?void 0:item.to_date;var from_date=item===null||item===void 0?void 0:item.from_date;var color_index=index;if(index>500){// make random index from the limit 0 to 500.\n// if the index is greater than 500.\ncolor_index=Math.floor(Math.random()*500+1);}if(!to_date&&from_date){if(count_times[from_date]>-1){count_times[from_date]++;}var from_element=document.getElementsByClassName(\"color_\".concat(count_times[from_date],\"_\").concat(from_date));if(from_element){var element_from=from_element[0];if((from_element===null||from_element===void 0?void 0:from_element.length)>1){element_from=from_element[1];}if(element_from){element_from.classList.add(\"color_\".concat(color_index));}}}if(to_date&&from_date){if(count_times[from_date]>-1){count_times[from_date]++;}if(count_times[to_date]>-1){count_times[to_date]++;}// let colorbyIndex = randomColors[index];\nvar _from_element=document.getElementsByClassName(\"color_\".concat(count_times[from_date],\"_\").concat(from_date));if(_from_element){var _element_from=null;if((_from_element===null||_from_element===void 0?void 0:_from_element.length)>1){if(!_from_element[0].parentElement.parentElement.classList.contains('rdrDayPassive')){_element_from=_from_element[0];}else{_element_from=_from_element[1];}}else{_element_from=_from_element[0];}if(_element_from){_element_from.classList.add(\"color_\".concat(color_index));}}var to_element=document.getElementsByClassName(\"color_\".concat(count_times[to_date],\"_\").concat(to_date));if(to_element){var element_to=null;if((to_element===null||to_element===void 0?void 0:to_element.length)>1){if(!to_element[0].parentElement.parentElement.classList.contains('rdrDayPassive')){element_to=to_element[0];}else{element_to=to_element[1];}}else{element_to=to_element[0];}if(element_to){element_to.classList.add(\"color_\".concat(color_index));}}}});}};useEffect(function(){var interval=setInterval(function(){onMountCallable();},1500);return function(){console.log(\"clearing interval\");clearInterval(interval);};},[]);var handleChange=function handleChange(item){setRange(item.selection);handleCheck(item.selection);onMountCallable();};var handleCheck=function handleCheck(item){var from_date=moment(item.startDate).format(default_format);var to_date=moment(item.endDate).format(default_format);setFormattedDates({from_date:from_date,to_date:to_date});if(moment(from_date,default_format).isAfter(moment(to_date,default_format))){// isAfter\nsetError('finish date is greater then the start date.');}else{setError('');}};var checkBeforeExist=function checkBeforeExist(time,milestones_){var count_times={};var catch_boolean=true;var milestoneItems=milestones;if(milestones_){milestoneItems=milestones_;}milestoneItems.forEach(function(mile){var mile_start=mile.from_date;var mile_end=mile.to_date;var time_start=time.from_date;var time_end=time.to_date;if(count_times[mile_start]==undefined){count_times[mile_start]=1;}else{count_times[mile_start]=count_times[mile_start]+1;}if(count_times[mile_end]==undefined){count_times[mile_end]=1;}else{count_times[mile_end]=count_times[mile_end]+1;}if(count_times[mile_start]===4){if(mile_start==time_start||mile_start==time_end){setShowToast(true,STRING_ERROR);catch_boolean=false;}}else{if(count_times[time_start]===4){setShowToast(true,STRING_ERROR);catch_boolean=false;}}if(count_times[mile_end]===4){if(mile_end==time_start||mile_end==time_end){setShowToast(true,STRING_ERROR);catch_boolean=false;}}else{if(count_times[time_end]===4){setShowToast(true,STRING_ERROR);catch_boolean=false;}}});return catch_boolean;};var handleContinue=function handleContinue(){var moment_start=moment(range.startDate).format('MM-DD-YYYY');var moment_end=moment(range.endDate).format('MM-DD-YYYY');var timings={from_date:range.startDate!==''?moment_start:'',to_date:moment_start===moment_end||range.endDate===''?'':moment_end};var item_index=null;item_index=milestones.length?milestones.length-1:0;var isChecked=checkBeforeExist(timings);if(isChecked){if(editMileStone==null){addTimeToMileStone(timings,item_index);handleStepBack();}else{updateMileStoneTimings(timings);addTimeToMileStone(timings,editMileStone);handleStepForward(15);}}// handleStepComplete(formattedDates);\n};var checkDisable=function checkDisable(){if((range===null||range===void 0?void 0:range.startDate)&&(range===null||range===void 0?void 0:range.startDate)!=='Invalid date'){return false;}return true;};return/*#__PURE__*/_jsx(\"div\",{className:\"app_wrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"section_wrapper\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"custom_container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex_row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex_col_sm_5\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relate\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back\",onClick:handleStepBack}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){onMountCallable();console.table({randomColors:randomColors});},className:\"title\",children:\"Timing\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"commn_para\",children:'Select a start and end date, or a due date.'})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex_row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex_col_sm_8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(DateRangePicker,{ranges:[range],onChange:handleChange,months:2,direction:\"horizontal\",moveRangeOnFirstSelection:false,rangeColors:[\"#fee600\",\"#b5b5b5\"],showDateDisplay:false,showSelectionPreview:true,showPreview:true,minDate:(data===null||data===void 0?void 0:(_data$from_date=data.from_date)===null||_data$from_date===void 0?void 0:_data$from_date.length)?moment(data===null||data===void 0?void 0:data.from_date,'YYYY-MM-DD').toDate():new Date(),maxDate:moment().add(2,'years').toDate()// maxDate={data?.to_date?.length && data?.from_date !== data?.to_date ? moment(data?.to_date, 'YYYY-MM-DD').toDate() : moment().add(2, 'years').toDate()}\n,fixedHeight:true})}),/*#__PURE__*/_jsx(\"span\",{className:\"error_msg mtb-15\",children:error}),/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(\"button\",{className:\"fill_btn full_btn btn-effect \".concat(checkDisable()?'disable_btn':''),onClick:handleContinue,children:'Continue'})})]})})]})})});};export default ChooseTimingMileStone;","map":{"version":3,"sources":["/home/appinventiv/Documents/Project/tickt/web/src/pages/postJob/components/chooseTimingMileStone.tsx"],"names":["React","useState","useEffect","DateRangePicker","moment","setShowToast","default_format","STRING_ERROR","ChooseTimingMileStone","data","stepCompleted","randomColors","handleStepForward","updateMileStoneTimings","editMileStone","addTimeToMileStone","milestones","handleStepComplete","handleStepMileStone","handleStepBack","startDate","endDate","key","range","setRange","formattedDates","setFormattedDates","error","setError","localChanges","setLocalChanges","isToggle","setIsToggle","force","forceUpdate","onMountCallable","count_times","filteredItems","filter","item","to_date","from_date","Object","keys","length","ifMatch","find","item_","forEach","index","color_index","Math","floor","random","from_element","document","getElementsByClassName","element_from","classList","add","parentElement","contains","to_element","element_to","interval","setInterval","console","log","clearInterval","handleChange","selection","handleCheck","format","isAfter","checkBeforeExist","time","milestones_","catch_boolean","milestoneItems","mile","mile_start","mile_end","time_start","time_end","undefined","handleContinue","moment_start","moment_end","timings","item_index","isChecked","checkDisable","table","toDate","Date"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\n// @ts-ignore\nimport { DateRangePicker } from '../../../plugins/react-date-range/dist/index';\nimport '../../../plugins/react-date-range/dist/styles.css';\nimport '../../../plugins/react-date-range/dist/theme/default.css';\n\nimport moment from 'moment';\nimport { setShowToast } from '../../../redux/common/actions';\n\ninterface Proptypes {\n    data: any;\n    stepCompleted: Boolean;\n    milestones: any,\n    randomColors: any,\n    editMilestoneTiming: any;\n    editMileStone: any;\n    handleStepForward: (data: any) => void;\n    handleStepComplete: (data: any) => void;\n    handleStepMileStone: (data: any, index: any) => void;\n    handleStepBack: () => void;\n    addTimeToMileStone: (time: any, index: number, skip?: any) => void;\n    updateMileStoneTimings: (data: any) => void;\n}\n\nconst default_format = 'YYYY-MM-DD';\nconst STRING_ERROR = 'Selected data is fully engage';\nconst ChooseTimingMileStone = ({\n    data,\n    stepCompleted,\n    randomColors,\n    handleStepForward,\n    updateMileStoneTimings,\n    editMileStone,\n    addTimeToMileStone,\n    milestones,\n    handleStepComplete,\n    handleStepMileStone,\n    handleStepBack }: Proptypes) => {\n    const [range, setRange] = useState<{ [index: string]: string | Date }>({\n        startDate: '', //new Date(),\n        endDate: '',//new Date(),\n        key: 'selection',\n    });\n    const [formattedDates, setFormattedDates] = useState({});\n    const [error, setError] = useState('');\n    const [localChanges, setLocalChanges] = useState(false);\n\n    const [isToggle, setIsToggle] = useState(false);\n\n    const [force, forceUpdate] = useState<any>([]);\n\n    const onMountCallable = () => {\n        let count_times: any = {};\n        // console.log({ randomColors })\n        let filteredItems = milestones.filter((item: any) => {\n            let to_date = item?.to_date;\n            let from_date = item?.from_date;\n\n            if (from_date) {\n                count_times[from_date] = 0;\n            }\n\n            if (to_date) {\n                count_times[to_date] = 0;\n            }\n\n            if (Object.keys(item).length && item?.from_date) {\n                return item;\n            }\n\n            let ifMatch = milestones.find((item_: any) => {\n                if (item_.to_date === to_date && from_date === item_.from_date) {\n                    return item_;\n                }\n            })\n\n            return ifMatch\n        });\n\n\n        if (filteredItems?.length) {\n            filteredItems.forEach((item: any, index: any) => {\n                let to_date = item?.to_date;\n                let from_date = item?.from_date;\n                let color_index = index;\n                if(index > 500){\n                    // make random index from the limit 0 to 500.\n                    // if the index is greater than 500.\n                    color_index = Math.floor((Math.random()*500) + 1);\n                }\n\n                if (!to_date && from_date) {\n                    if (count_times[from_date] > -1) {\n                        count_times[from_date]++;\n                    }\n\n                    let from_element: any = document.getElementsByClassName(`color_${count_times[from_date]}_${from_date}`);\n                    if (from_element) {\n                        let element_from = from_element[0];\n                        if (from_element?.length > 1) {\n                            element_from = from_element[1];\n                        }\n\n                        if (element_from) {\n                            element_from.classList.add(`color_${color_index}`);\n                        }\n                    }\n                }\n\n                if (to_date && from_date) {\n                    if (count_times[from_date] > -1) {\n                        count_times[from_date]++;\n                    }\n\n                    if (count_times[to_date] > -1) {\n                        count_times[to_date]++;\n                    }\n\n                    // let colorbyIndex = randomColors[index];\n                    let from_element: any = document.getElementsByClassName(`color_${count_times[from_date]}_${from_date}`);\n                    if (from_element) {\n                        let element_from = null;\n\n                        if (from_element?.length > 1) {\n                            if (!from_element[0].parentElement.parentElement.classList.contains('rdrDayPassive')) {\n                                element_from = from_element[0];\n                            } else {\n                                element_from = from_element[1];\n                            }\n                        } else {\n                            element_from = from_element[0];\n                        }\n\n                        if (element_from) {\n                            element_from.classList.add(`color_${color_index}`)\n                        }\n                    }\n\n                    let to_element: any = document.getElementsByClassName(`color_${count_times[to_date]}_${to_date}`);\n                    if (to_element) {\n                        let element_to = null;\n                        if (to_element?.length > 1) {\n                            if (!to_element[0].parentElement.parentElement.classList.contains('rdrDayPassive')) {\n                                element_to = to_element[0];\n                            } else {\n                                element_to = to_element[1];\n                            }\n                        } else {\n                            element_to = to_element[0];\n                        }\n                        if (element_to) {\n                            element_to.classList.add(`color_${color_index}`);\n                        }\n                    }\n                }\n            });\n        }\n    }\n\n    useEffect(() => {\n        const interval = setInterval(() => {\n            onMountCallable();\n        }, 1500);\n\n        return () => {\n            console.log(`clearing interval`);\n            clearInterval(interval);\n        };\n    }, []);\n\n    const handleChange = (item: any) => {\n        setRange(item.selection);\n        handleCheck(item.selection);\n        onMountCallable();\n    };\n\n    const handleCheck = (item: any) => {\n        let from_date = moment(item.startDate).format(default_format);\n        let to_date = moment(item.endDate).format(default_format);\n        setFormattedDates({ from_date, to_date });\n        if (moment(from_date, default_format).isAfter(moment(to_date, default_format))) { // isAfter\n            setError('finish date is greater then the start date.');\n        } else {\n            setError('');\n        }\n    }\n\n    const checkBeforeExist = (time: any, milestones_?: any) => {\n        let count_times: any = {};\n        let catch_boolean: boolean = true;\n        let milestoneItems: any = milestones;\n\n        if (milestones_) {\n            milestoneItems = milestones_;\n        }\n\n        milestoneItems.forEach((mile: any) => {\n\n            let mile_start = mile.from_date;\n            let mile_end = mile.to_date;\n\n            let time_start = time.from_date;\n            let time_end = time.to_date;\n\n\n            if (count_times[mile_start] == undefined) {\n                count_times[mile_start] = 1\n            } else {\n                count_times[mile_start] = count_times[mile_start] + 1;\n            }\n\n\n            if (count_times[mile_end] == undefined) {\n                count_times[mile_end] = 1\n            } else {\n                count_times[mile_end] = count_times[mile_end] + 1;\n            }\n\n            if (count_times[mile_start] === 4) {\n                if (mile_start == time_start || mile_start == time_end) {\n                    setShowToast(true, STRING_ERROR);\n                    catch_boolean = false;\n                }\n            } else {\n                if (count_times[time_start] === 4) {\n                    setShowToast(true, STRING_ERROR);\n                    catch_boolean = false;\n                }\n            }\n\n            if (count_times[mile_end] === 4) {\n                if (mile_end == time_start || mile_end == time_end) {\n                    setShowToast(true, STRING_ERROR);\n                    catch_boolean = false;\n                }\n            } else {\n                if (count_times[time_end] === 4) {\n                    setShowToast(true, STRING_ERROR);\n                    catch_boolean = false;\n                }\n            }\n\n\n        });\n\n        return catch_boolean;\n    }\n\n    const handleContinue = () => {\n        let moment_start = moment(range.startDate).format('MM-DD-YYYY')\n        let moment_end = moment(range.endDate).format('MM-DD-YYYY')\n        let timings = {\n            from_date: range.startDate !== '' ? moment_start : '',\n            to_date: (moment_start === moment_end || range.endDate === '') ? '' : moment_end\n        }\n\n        let item_index = null;\n        item_index = milestones.length ? milestones.length - 1 : 0;\n\n        let isChecked = checkBeforeExist(timings);\n\n        if (isChecked) {\n            if (editMileStone == null) {\n                addTimeToMileStone(timings, item_index);\n                handleStepBack();\n            } else {\n                updateMileStoneTimings(timings);\n                addTimeToMileStone(timings, editMileStone);\n                handleStepForward(15);\n            }\n        }\n        // handleStepComplete(formattedDates);\n    }\n\n    const checkDisable = () => {\n        if (range?.startDate && range?.startDate !== 'Invalid date') {\n            return false;\n        }\n        return true;\n    }\n\n    return (\n        <div className=\"app_wrapper\">\n            <div className=\"section_wrapper\">\n                <div className=\"custom_container\">\n\n                    <div className=\"form_field\">\n                        <div className=\"flex_row\">\n                            <div className=\"flex_col_sm_5\">\n                                <div className=\"relate\">\n                                    <button className=\"back\" onClick={handleStepBack}></button>\n                                    <span\n                                        onClick={() => {\n                                            onMountCallable();\n                                            console.table({ randomColors })\n                                        }}\n                                        className=\"title\">Timing</span>\n                                </div>\n                                <p className=\"commn_para\">\n                                    {'Select a start and end date, or a due date.'}\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                    <div className=\"flex_row\">\n                        <div className=\"flex_col_sm_8\">\n                            <div className=\"form_field\">\n                                <DateRangePicker\n                                    ranges={[range]}\n                                    onChange={handleChange}\n                                    months={2}\n                                    direction=\"horizontal\"\n                                    moveRangeOnFirstSelection={false}\n                                    rangeColors={[\"#fee600\", \"#b5b5b5\"]}\n                                    showDateDisplay={false}\n                                    showSelectionPreview={true}\n                                    showPreview={true}\n                                    minDate={data?.from_date?.length ? moment(data?.from_date, 'YYYY-MM-DD').toDate() : new Date()}\n                                    maxDate={moment().add(2, 'years').toDate()}\n                                    // maxDate={data?.to_date?.length && data?.from_date !== data?.to_date ? moment(data?.to_date, 'YYYY-MM-DD').toDate() : moment().add(2, 'years').toDate()}\n                                    fixedHeight={true}\n                                />\n                            </div>\n                            <span className=\"error_msg mtb-15\">{error}</span>\n                            <div className=\"form_field\">\n                                <button\n                                    className={`fill_btn full_btn btn-effect ${checkDisable() ? 'disable_btn' : ''}`}\n                                    onClick={handleContinue}>\n                                    {'Continue'}\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n    )\n}\n\nexport default ChooseTimingMileStone\n"]},"metadata":{},"sourceType":"module"}