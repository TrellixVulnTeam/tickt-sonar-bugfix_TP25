{"ast":null,"code":"import _defineProperty from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from'react';import{useHistory}from'react-router';import{setShowToast}from'../../../redux/common/actions';import UploadMedia from'../../postJob/components/uploadMedia';import{renderTime}from'../../../utils/common';import LodgeDispute from'./lodgeDispute/lodgeDispute';import CancelJobs from'./cancelJobs/cancelJob';import DigitalIdVerification from'../../tradieEditProfile/components/digitalIdVerification';import Modal from'@material-ui/core/Modal';//@ts-ignore\nimport FsLightbox from'fslightbox-react';import storageService from'../../../utils/storageService';import Carousel from'react-multi-carousel';import\"react-multi-carousel/lib/styles.css\";import dummy from'../../../assets/images/u_placeholder.jpg';import editIconBlue from'../../../assets/images/ic-edit-blue.png';import more from'../../../assets/images/icon-direction-right.png';import check from'../../../assets/images/checked-2.png';import pendingIcon from'../../../assets/images/exclamation-icon.png';import noDataFound from'../../../assets/images/no-search-data.png';import verifiedIcon from'../../../assets/images/checked-2.png';import cancel from\"../../../assets/images/ic-cancel.png\";import{moengage,mixPanel}from'../../../services/analyticsTools';import{MoEConstants}from'../../../utils/constants';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var digitalInfoPoints=['Passport','Driver Licence (Driver\\'s license) - scans of front and back are required','Photo Card - scans of front and back are required','New South Wales Driving Instructor Licence - scans of front and back are required','Tasmanian Government Personal Information Card - scans of front and back are required','ImmiCard - scans of front and back are required','Proof of Age card - scans of front and back are required','Australian Defence Force (ADF) identification card (Military ID) - scans of front and back are required'];var declinedImages={desktop:{breakpoint:{max:3000,min:1200},items:2,slidesToSlide:1// optional, default to 1.\n},tablet:{breakpoint:{max:1024,min:768},items:1},mobile:{breakpoint:{max:650,min:0},items:1}};var MarkMilestone=function MarkMilestone(props){var _history$location,_data$actualHours,_isMilestoneList$;var getMilestoneList=props.getMilestoneList,milestoneList=props.milestoneList,showJobCompletePage=props.showJobCompletePage,showMilestoneCompletePage=props.showMilestoneCompletePage,getBankDetails=props.getBankDetails,addBankDetails=props.addBankDetails,updateBankDetails=props.updateBankDetails,removeBankDetails=props.removeBankDetails,markMilestoneComplete=props.markMilestoneComplete,bankDetails=props.bankDetails;var history=useHistory();var params=new URLSearchParams((_history$location=history.location)===null||_history$location===void 0?void 0:_history$location.search);params={jobId:params.get('jobId'),tradeId:params.get('tradeId'),specializationId:params.get('specializationId')};var defaultData={urls:[],description:'',actualHours:'',totalAmount:'0',account_name:'',account_number:'',bsb_number:'',accountVerified:false,stripeAccountId:''};var _useState=useState(defaultData),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState({actualHours:'',account_name:'',account_number:'',bsb_number:''}),_useState4=_slicedToArray(_useState3,2),errors=_useState4[0],setErrors=_useState4[1];var _useState5=useState(1),_useState6=_slicedToArray(_useState5,2),step=_useState6[0],setStep=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),stepCompleted=_useState8[0],setStepCompleted=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isLastMilestone=_useState10[0],setIsLastMilestone=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),milestoneIndex=_useState12[0],setMilestoneIndex=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),readOnly=_useState14[0],setReadOnly=_useState14[1];var _useState15=useState({edit:false,cancel:false,lodge:false}),_useState16=_slicedToArray(_useState15,2),toggleItem=_useState16[0],setToggleItem=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),isQuoteScreen=_useState18[0],setQuoteScreen=_useState18[1];var _useState19=useState({multipleDeclineListCount:0,prevMilestoneDeclineId:'',currentMilestoneDeclineId:''}),_useState20=_slicedToArray(_useState19,2),milestoneDeclineData=_useState20[0],setMilestoneDeclineData=_useState20[1];var _useState21=useState([]),_useState22=_slicedToArray(_useState21,2),mediaList=_useState22[0],setMediaList=_useState22[1];var _useState23=useState(false),_useState24=_slicedToArray(_useState23,2),toggler=_useState24[0],setToggler=_useState24[1];var _useState25=useState(1),_useState26=_slicedToArray(_useState25,2),selectedSlide=_useState26[0],setSelectSlide=_useState26[1];var _useState27=useState(false),_useState28=_slicedToArray(_useState27,2),digitalIDInfo=_useState28[0],setDigitalIDInfo=_useState28[1];useEffect(function(){var _history$location2;var params=new URLSearchParams((_history$location2=history.location)===null||_history$location2===void 0?void 0:_history$location2.search);var jobActionType=params.get('jobAction');if(jobActionType==='dispute'){setToggleItem(function(prev){return _objectSpread(_objectSpread({},prev),{},{lodge:true});});}else if(jobActionType==='cancel'){setToggleItem(function(prev){return _objectSpread(_objectSpread({},prev),{},{cancel:true});});}},[]);useEffect(function(){getMilestoneList(params.jobId);getBankDetails();},[params.jobId,getMilestoneList,getBankDetails]);useEffect(function(){setData(function(prevData){return _objectSpread(_objectSpread({},prevData),bankDetails);});setReadOnly(!!(bankDetails===null||bankDetails===void 0?void 0:bankDetails.userId));},[bankDetails]);var validateActualHours=function validateActualHours(value){if(!value){return'Time Spent is required.';}var pattern=\"^([0-9]?[0-9]?[0-9]?[0-9]?[0-9]):[0-5][0-9]$\";if(value.match(pattern)!==null){if(!(+value.split(':')[1]%5===0)){return'Time should be in mutiples of 5 like 10:05, 10:10';}return'';}return'Please enter a valid pattern like : 10:05';// '([0-9]?[0-9]{1}|2[0-9]{1}|3[0-9]{1}|4[0-9]{1}|5[0-9]{1}|6[0-9]{1}):[0-5]{1}[0-9]{1}';\n// return 'Hours should be in hh:mm format.';\n};var errorLabel={'account_number':'Account Number','account_name':'Account Name','bsb_number':'BSB Number'};var validateBankDetails=function validateBankDetails(name,value){if(!value){return\"\".concat(errorLabel[name],\" is required\");}switch(name){case'account_number':return value.length>10?'Maximum 10 digits are allowed':value.length<6?'Minimum 6 digits are required':'';case'bsb_number':return!/^\\d{3}-\\d{3}$/.test(value)?'Please enter valid BSB Number like 123-444':'';}return'';};var handleChange=function handleChange(_ref){var _ref$target=_ref.target,name=_ref$target.name,value=_ref$target.value;var newVal;value=value.trimLeft();if(name==='actualHours'){var _value;var tim=(_value=value)===null||_value===void 0?void 0:_value.split(':')[0];if(value.includes(':')&&(tim===null||tim===void 0?void 0:tim.length)<3){if((tim===null||tim===void 0?void 0:tim.length)===2){newVal=value;}else{newVal=value.split(':')[0]<10&&value.split(':')[0]>0?\"0\".concat(value):value;}}else{newVal=value;}}setData(function(prevData){return _objectSpread(_objectSpread({},prevData),{},_defineProperty({},name,name==='actualHours'?newVal:value));});if(step===3&&stepCompleted.includes(3)){setErrors(function(prevErrors){return _objectSpread(_objectSpread({},prevErrors),{},_defineProperty({},name,validateActualHours(value)));});}if(step===5&&stepCompleted.includes(5)){setErrors(function(prevErrors){return _objectSpread(_objectSpread({},prevErrors),{},_defineProperty({},name,validateBankDetails(name,value)));});}};var _ref2=milestoneList||{},jobId=_ref2.jobId,jobName=_ref2.jobName,milestones=_ref2.milestones,postedBy=_ref2.postedBy;var _ref3=postedBy||{},builderId=_ref3.builderId,builderImage=_ref3.builderImage,builderName=_ref3.builderName,reviews=_ref3.reviews,ratings=_ref3.ratings;var hoursMinutes=(_data$actualHours=data.actualHours)===null||_data$actualHours===void 0?void 0:_data$actualHours.split(':').map(function(key){return parseInt(key);});var totalAmount=(milestones===null||milestones===void 0?void 0:milestones[milestoneIndex].amount)*((milestones===null||milestones===void 0?void 0:milestones[milestoneIndex].pay_type)==='Fixed price'?1:(hoursMinutes===null||hoursMinutes===void 0?void 0:hoursMinutes[0])+(hoursMinutes===null||hoursMinutes===void 0?void 0:hoursMinutes[1])/60);useEffect(function(){var multipleList=milestones===null||milestones===void 0?void 0:milestones.filter(function(_ref4){var status=_ref4.status;return status===3;});if((multipleList===null||multipleList===void 0?void 0:multipleList.length)>1){var _list$declinedReason;var list=milestones===null||milestones===void 0?void 0:milestones.find(function(_ref5){var status=_ref5.status;return status===3;});setMilestoneDeclineData(function(prevData){return _objectSpread(_objectSpread({},prevData),{},{multipleDeclineListCount:multipleList===null||multipleList===void 0?void 0:multipleList.length,prevMilestoneDeclineId:list===null||list===void 0?void 0:list.milestoneId,currentMilestoneDeclineId:list===null||list===void 0?void 0:list.milestoneId});});setMediaList(list===null||list===void 0?void 0:(_list$declinedReason=list.declinedReason)===null||_list$declinedReason===void 0?void 0:_list$declinedReason.url);}else if((multipleList===null||multipleList===void 0?void 0:multipleList.length)===1){var _list$declinedReason2;var _list=milestones===null||milestones===void 0?void 0:milestones.find(function(_ref6){var status=_ref6.status;return status===3;});setMilestoneDeclineData(function(prevData){return _objectSpread(_objectSpread({},prevData),{},{multipleDeclineListCount:multipleList===null||multipleList===void 0?void 0:multipleList.length,prevMilestoneDeclineId:_list===null||_list===void 0?void 0:_list.milestoneId,currentMilestoneDeclineId:_list===null||_list===void 0?void 0:_list.milestoneId});});setMediaList(_list===null||_list===void 0?void 0:(_list$declinedReason2=_list.declinedReason)===null||_list$declinedReason2===void 0?void 0:_list$declinedReason2.url);}},[milestones]);console.log(milestoneDeclineData,\"milestoneDeclineData\");var setItemToggle=function setItemToggle(index){setToggler(function(prev){return!prev;});setSelectSlide(index+1);};var renderFilteredItems=function renderFilteredItems(){var sources=[];var types=[];if(mediaList===null||mediaList===void 0?void 0:mediaList.length){mediaList.forEach(function(item){if((item===null||item===void 0?void 0:item.mediaType)===2){sources.push(item.link);types.push('video');}else if((item===null||item===void 0?void 0:item.mediaType)===1){sources.push(item.link);types.push('image');}else{sources.push(item);types.push('image');}});}return{sources:sources,types:types};};var backTab=function backTab(name){var _history$location3;var params=new URLSearchParams((_history$location3=history.location)===null||_history$location3===void 0?void 0:_history$location3.search);var jobActionType=params.get('jobAction');if(jobActionType){history.goBack();return;}setToggleItem(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},name,false));});};if(toggleItem===null||toggleItem===void 0?void 0:toggleItem.lodge){return/*#__PURE__*/_jsx(LodgeDispute,{item:{jobId:jobId,jobName:jobName},backTab:backTab,history:history});}if(toggleItem===null||toggleItem===void 0?void 0:toggleItem.cancel){return/*#__PURE__*/_jsx(CancelJobs,{item:{jobId:jobId,jobName:jobName},backTab:backTab,history:history});}var markMilestoneVerif=function markMilestoneVerif(val){if(val==='backStep')setStep(5);if(val==='verifSuccess'){setData(function(prevData){return _objectSpread(_objectSpread({},prevData),{},{accountVerified:true});});setStep(5);}};var _renderFilteredItems=renderFilteredItems(),sources=_renderFilteredItems.sources,types=_renderFilteredItems.types;var page=null;var isMilestoneList=(props===null||props===void 0?void 0:props.milestoneList)||false;var isShowError=false;if(isMilestoneList&&isMilestoneList[0]&&((_isMilestoneList$=isMilestoneList[0])===null||_isMilestoneList$===void 0?void 0:_isMilestoneList$.status)===404){isShowError=true;}var renderSteps=function renderSteps(){var _milestones$sort;switch(step){case 1:return page=!isShowError?/*#__PURE__*/_jsxs(\"div\",{className:\"flex_row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex_col_sm_6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relate\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back\",onClick:function onClick(){return history.push('/active-jobs');}}),/*#__PURE__*/_jsx(\"span\",{className:\"xs_sub_title\",children:jobName}),/*#__PURE__*/_jsxs(\"span\",{className:\"dot_menu\",children:[/*#__PURE__*/_jsx(\"img\",{src:editIconBlue,alt:\"edit\"}),/*#__PURE__*/_jsx(\"div\",{className:\"edit_menu\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{onClick:function onClick(){setToggleItem(function(prev){return _objectSpread(_objectSpread({},prev),{},{lodge:true});});},className:\"icon lodge\",children:\"Lodge dispute\"}),/*#__PURE__*/_jsx(\"li\",{onClick:function onClick(){setToggleItem(function(prev){return _objectSpread(_objectSpread({},prev),{},{cancel:true});});},className:\"icon delete\",children:\"Cancel job\"})]})})]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"commn_para\",children:\"Your job point of contact has indicated they want to be notified when you reach the following milestones. Tap the milestone and Submit when a milestone is completed\"}),milestoneDeclineData.multipleDeclineListCount>1&&/*#__PURE__*/_jsx(\"button\",{className:\"fill_grey_btn full_btn pending_info\",children:/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"img\",{src:pendingIcon,alt:\"icon\"}),\"\".concat(milestoneDeclineData.multipleDeclineListCount,\" Milestones were declined\")]})}),/*#__PURE__*/_jsx(\"ul\",{className:\"milestones_check\",children:milestones===null||milestones===void 0?void 0:(_milestones$sort=milestones.sort(function(_ref7,_ref8){var prevOrder=_ref7.order;var order=_ref8.order;return prevOrder-order;}))===null||_milestones$sort===void 0?void 0:_milestones$sort.map(function(_ref9,index){var _milestones,_Object$keys,_declinedReason$url,_declinedReason$url2;var milestoneId=_ref9.milestoneId,milestoneName=_ref9.milestoneName,isPhotoevidence=_ref9.isPhotoevidence,status=_ref9.status,fromDate=_ref9.fromDate,toDate=_ref9.toDate,declinedReason=_ref9.declinedReason,declinedCount=_ref9.declinedCount;// As discussed now we take this status 4 as status 0 bacause after the decline on the change-request the status becomes 4.\nvar prevMilestoneStatus=(_milestones=milestones[index-1])===null||_milestones===void 0?void 0:_milestones.status;var isActive=(status===0||status===4||status===5)&&([1,2].includes(prevMilestoneStatus)||prevMilestoneStatus===undefined);var isDeclined=status===3;return/*#__PURE__*/_jsxs(\"li\",{className:[1,2].includes(status)?\"check\":isActive?'active':status===3?'declined':'disabled',children:[/*#__PURE__*/_jsx(\"div\",{className:\"circle_stepper\",onClick:function onClick(){setMediaList(declinedReason===null||declinedReason===void 0?void 0:declinedReason.url);setMilestoneDeclineData(function(prevData){return _objectSpread(_objectSpread({},prevData),{},{currentMilestoneDeclineId:milestoneId});});},children:/*#__PURE__*/_jsx(\"span\",{})}),/*#__PURE__*/_jsxs(\"div\",{className:\"info\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\".concat(milestoneName,\" \").concat(status===3?'declined':'')}),isPhotoevidence&&/*#__PURE__*/_jsx(\"span\",{children:\"Photo evidence required\"}),/*#__PURE__*/_jsx(\"span\",{children:renderTime(fromDate,toDate)})]}),isDeclined&&milestoneDeclineData.currentMilestoneDeclineId===milestoneId&&/*#__PURE__*/_jsxs(_Fragment,{children:[((_Object$keys=Object.keys(declinedReason))===null||_Object$keys===void 0?void 0:_Object$keys.length)>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"decline_reason\",children:[/*#__PURE__*/_jsx(FsLightbox,{toggler:toggler,slide:selectedSlide,sources:sources,types:types}),/*#__PURE__*/_jsx(\"label\",{className:\"form_label\",children:\"Decline reason:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text_field\",children:/*#__PURE__*/_jsx(\"p\",{className:\"commn_para\",children:declinedReason===null||declinedReason===void 0?void 0:declinedReason.reason})}),(declinedReason===null||declinedReason===void 0?void 0:(_declinedReason$url=declinedReason.url)===null||_declinedReason$url===void 0?void 0:_declinedReason$url.length)>0&&/*#__PURE__*/_jsx(Carousel,{className:\"decline_media\",responsive:declinedImages,showDots:false,arrows:true,children:declinedReason===null||declinedReason===void 0?void 0:(_declinedReason$url2=declinedReason.url)===null||_declinedReason$url2===void 0?void 0:_declinedReason$url2.map(function(image,index){return/*#__PURE__*/_jsx(\"div\",{className:\"upload_img_video\",children:/*#__PURE__*/_jsx(\"figure\",{className:\"img_video\",children:/*#__PURE__*/_jsx(\"img\",{src:image,alt:\"image\",onClick:function onClick(){return setItemToggle(index);}})})});})})]}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){if(declinedCount>=5){setShowToast(true,'You have exceeded maximum number of chances to submit the milestone');return;}setMilestoneIndex(index);if(index===(milestones===null||milestones===void 0?void 0:milestones.length)-1){setIsLastMilestone(true);}if(isPhotoevidence){setStep(2);}else{setStep(3);}},className:\"fill_btn full_btn btn-effect \".concat(milestoneDeclineData.prevMilestoneDeclineId!==milestoneId?'disable_btn':''),children:\"Remark as Complete\"})]}),isActive&&/*#__PURE__*/_jsx(\"button\",{className:\"fill_btn full_btn btn-effect\",onClick:function onClick(){setMilestoneIndex(index);if(index===(milestones===null||milestones===void 0?void 0:milestones.length)-1){setIsLastMilestone(true);}if(isPhotoevidence){setStep(2);}else{setStep(3);}},children:\"Done\"})]},milestoneId);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex_col_sm_6 col_ruler\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"sub_title\",children:\"Posted by\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"tradie_card posted_by \",children:[/*#__PURE__*/_jsx(\"a\",{href:\"javascript:void(0)\",className:\"chat circle\",onClick:function onClick(e){var _storageService$getIt;e.preventDefault();history.push({pathname:\"/chat\",state:{tradieId:(_storageService$getIt=storageService.getItem('userInfo'))===null||_storageService$getIt===void 0?void 0:_storageService$getIt._id,builderId:builderId,jobId:jobId,jobName:jobName}});}}),/*#__PURE__*/_jsxs(\"div\",{className:\"user_wrap\",onClick:function onClick(){return history.push(\"/builder-info?builderId=\".concat(builderId));},children:[/*#__PURE__*/_jsx(\"figure\",{className:\"u_img\",children:/*#__PURE__*/_jsx(\"img\",{src:builderImage||dummy,alt:\"traide-img\",onError:function onError(e){var _e$target,_e$target2;if(e===null||e===void 0?void 0:(_e$target=e.target)===null||_e$target===void 0?void 0:_e$target.onerror){e.target.onerror=null;}if(e===null||e===void 0?void 0:(_e$target2=e.target)===null||_e$target2===void 0?void 0:_e$target2.src){e.target.src=dummy;}}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"details\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"name\",children:builderName}),/*#__PURE__*/_jsxs(\"span\",{className:\"rating\",children:[ratings,\" | \",reviews,\" reviews\"]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relate\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"sub_title\",children:\"Job details\"}),/*#__PURE__*/_jsx(\"span\",{className:\"edit_icon\",title:\"More\",onClick:function onClick(){return history.push(\"/job-details-page?jobId=\".concat(params.jobId,\"&redirect_from=jobs\"));},children:/*#__PURE__*/_jsx(\"img\",{src:more,alt:\"more\"})})]})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"custom_container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"vid_img_wrapper pt-20\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex_row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex_col_sm_8 relative\",children:/*#__PURE__*/_jsx(\"button\",{className:\"back\",onClick:function onClick(){history.goBack();}})})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"no_record  m-t-vh\",children:[/*#__PURE__*/_jsx(\"figure\",{className:\"no_img\",children:/*#__PURE__*/_jsx(\"img\",{src:noDataFound,alt:\"data not found\"})}),/*#__PURE__*/_jsx(\"span\",{children:'This builder is no longer available.'}),/*#__PURE__*/_jsx(\"span\",{children:'Please contact admin.'})]})]});case 2:return page=/*#__PURE__*/_jsx(UploadMedia,{jobName:jobName,title:\"Photo required\",para:\"Your job point of contact has indicated they want to be notified when you reach the following milestones. Tap the milestone and Submit when a milestone is completed\",stepCompleted:stepCompleted.includes(2),data:data,handleStepBack:function handleStepBack(){return setStep(1);},handleStepForward:function handleStepForward(){},handleStepComplete:function handleStepComplete(stepData){setData(function(prevData){return _objectSpread(_objectSpread({},prevData),stepData);});setStepCompleted(function(prevValue){return prevValue.concat([2]);});setStep(3);},hasDescription:true});case 3:return page=/*#__PURE__*/_jsx(\"div\",{className:\"flex_row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex_col_sm_8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relate\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back\",onClick:function onClick(){var _milestones$milestone;if((_milestones$milestone=milestones[milestoneIndex])===null||_milestones$milestone===void 0?void 0:_milestones$milestone.isPhotoevidence){setStep(2);}else{setStep(1);}}}),/*#__PURE__*/_jsx(\"span\",{className:\"xs_sub_title\",children:jobName})]}),/*#__PURE__*/_jsx(\"span\",{className:\"sub_title\",children:\"Worked hours in this milestone\"}),/*#__PURE__*/_jsx(\"p\",{className:\"commn_para\",children:\"The amount paid will be recalculated based on approval of the actual hours by the Builder\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form_field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form_label\",children:\"Time Spent\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text_field time_spent\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"hh:mm\",name:\"actualHours\",value:data.actualHours,onChange:handleChange,maxLength:5}),/*#__PURE__*/_jsx(\"span\",{className:\"detect_icon\",children:\"hours\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"error_msg\",children:errors.actualHours})]}),/*#__PURE__*/_jsx(\"button\",{className:\"fill_btn full_btn btn-effect\",onClick:function onClick(){setStepCompleted(function(prevValue){return prevValue.concat([3]);});var error=validateActualHours(data.actualHours);if(error){setErrors(function(prevErrors){return _objectSpread(_objectSpread({},prevErrors),{},{actualHours:error});});}else{setStep(4);}},children:\"Submit\"})]})});case 4:return page=/*#__PURE__*/_jsxs(\"div\",{className:\"flex_row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex_col_sm_7\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relate\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back\",onClick:function onClick(){return setStep(3);}}),/*#__PURE__*/_jsx(\"span\",{className:\"xs_sub_title\",children:jobName})]}),/*#__PURE__*/_jsx(\"span\",{className:\"sub_title\",children:isLastMilestone?'Job Complete':'Add payment details'}),/*#__PURE__*/_jsx(\"p\",{className:\"commn_para\",children:isLastMilestone?'Please enter your prefered payment method below so your point of contact can organise payment':'You need to add your bank account details for payment from the builder after approving this milestone'}),isLastMilestone&&/*#__PURE__*/_jsxs(\"div\",{className:\"f_spacebw total_payment\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total payment\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",totalAmount===null||totalAmount===void 0?void 0:totalAmount.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"fill_grey_btn bank_btn\",children:[data.userId&&/*#__PURE__*/_jsx(\"img\",{src:check,alt:\"check\"}),\" Bank account\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex_col_sm_9\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form_field\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"payment_note\",children:[\"Tickt does not store your payment information.\",' ']}),/*#__PURE__*/_jsxs(\"p\",{className:\"commn_para\",children:[' ',\"Tickt does not handle payment for jobs, we only facilitate communication between tradespeople and builders. If you have problems receiving your payment, please contact your builder.\"]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"fill_btn full_btn btn-effect\",onClick:function onClick(){return setStep(5);},children:data.userId?'Continue':'Add Details'})]})]});case 5:return page=/*#__PURE__*/_jsx(\"div\",{className:\"flex_row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex_col_sm_8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relate\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back\",onClick:function onClick(){return setStep(4);}}),/*#__PURE__*/_jsx(\"span\",{className:\"xs_sub_title\",children:jobName}),(data===null||data===void 0?void 0:data.userId)&&readOnly&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"edit_delete\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"edit\",title:\"Edit\",onClick:function onClick(){return setReadOnly(!readOnly);}}),/*#__PURE__*/_jsx(\"span\",{className:\"delete\",title:\"Remove\",onClick:function onClick(){return removeBankDetails();}})]})})]}),/*#__PURE__*/_jsx(\"span\",{className:\"sub_title\",children:\"Payment Details\"}),/*#__PURE__*/_jsx(\"p\",{className:\"commn_para\",children:\"Enter your bank account details\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form_field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form_label\",children:\"Account Name\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text_field\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter Account Name\",name:\"account_name\",value:data.account_name,onChange:handleChange,maxLength:50,readOnly:readOnly})}),/*#__PURE__*/_jsx(\"span\",{className:\"error_msg\",children:errors.account_name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form_field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form_label\",children:\"BSB Number\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text_field\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter BSB Number\",name:\"bsb_number\",value:data.bsb_number,onChange:handleChange,maxLength:7,readOnly:readOnly})}),/*#__PURE__*/_jsx(\"span\",{className:\"error_msg\",children:errors.bsb_number})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form_field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form_label\",children:\"Account Number\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text_field\",children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Enter Account Number\",name:\"account_number\",value:data.account_number,onChange:handleChange,maxLength:10,max:9999999999,readOnly:readOnly})}),/*#__PURE__*/_jsx(\"span\",{className:\"error_msg\",children:errors.account_number})]}),data.account_name&&data.account_number&&data.bsb_number&&data.stripeAccountId&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsxs(\"button\",{className:\"fill_grey_btn full_btn btn-effect id_verified\",onClick:function onClick(){if(data===null||data===void 0?void 0:data.accountVerified)return;setStep(6);},children:[(data===null||data===void 0?void 0:data.accountVerified)&&/*#__PURE__*/_jsx(\"img\",{src:verifiedIcon,alt:\"verified\"}),\"\".concat((data===null||data===void 0?void 0:data.accountVerified)?'ID Verified':'Add ID Verification')]})}),/*#__PURE__*/_jsx(\"span\",{className:\"show_label id_info\",onClick:function onClick(){return setDigitalIDInfo(true);},children:\"ID verification is required as part of Stripe ID verification process.\"})]}),/*#__PURE__*/_jsx(Modal,{className:\"custom_modal\",open:digitalIDInfo,onClose:function onClose(){return setDigitalIDInfo(false);},\"aria-labelledby\":\"simple-modal-title\",\"aria-describedby\":\"simple-modal-description\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"custom_wh profile_modal\",\"data-aos\":\"zoom-in\",\"data-aos-delay\":\"30\",\"data-aos-duration\":\"1000\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"heading\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"sub_title\",children:\"ID verification\"}),/*#__PURE__*/_jsx(\"button\",{className:\"close_btn\",onClick:function onClick(){return setDigitalIDInfo(false);},children:/*#__PURE__*/_jsx(\"img\",{src:cancel,alt:\"cancel\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"inner_wrap\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"show_label\",children:\"ID verification is required as part of Stripe ID verification process.\"}),/*#__PURE__*/_jsx(\"span\",{className:\"show_label\",children:\"Below is a spansting of documents that can accept as proof of identity, address, and entity.\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"verificationid_list\",children:digitalInfoPoints.map(function(info,index){return/*#__PURE__*/_jsx(\"li\",{className:\"show_label\",children:info},index);})}),/*#__PURE__*/_jsx(\"div\",{className:\"bottom_btn custom_btn center\",children:/*#__PURE__*/_jsx(\"button\",{className:\"fill_btn full_btn btn-effect\",onClick:function onClick(){return setDigitalIDInfo(false);},children:\"Ok\"})})]})]})}),/*#__PURE__*/_jsx(\"button\",{className:\"fill_btn full_btn btn-effect \".concat(readOnly?(data===null||data===void 0?void 0:data.accountVerified)?'':'disable_btn':''),onClick:readOnly?function(){var milestoneData={evidence:milestones[milestoneIndex].isPhotoevidence?data.urls:undefined,jobId:params.jobId,milestoneId:milestones[milestoneIndex].milestoneId,description:milestones[milestoneIndex].isPhotoevidence?data.description:undefined,actualHours:data.actualHours,totalAmount:\"\".concat(totalAmount===null||totalAmount===void 0?void 0:totalAmount.toFixed(2))};var callback=function callback(jobCompletedCount){var _milestoneList$catego,_milestoneList$catego2;var mData={timeStamp:moengage.getCurrentTimeStamp(),category:milestoneList===null||milestoneList===void 0?void 0:(_milestoneList$catego=milestoneList.categories)===null||_milestoneList$catego===void 0?void 0:(_milestoneList$catego2=_milestoneList$catego[0])===null||_milestoneList$catego2===void 0?void 0:_milestoneList$catego2.trade_name,'Milestone number':milestoneIndex+1};moengage.moE_SendEvent(MoEConstants.MILESTONE_COMPLETED,mData);mixPanel.mixP_SendEvent(MoEConstants.MILESTONE_COMPLETED,mData);if(isLastMilestone){showJobCompletePage(jobCompletedCount);}else{setStepCompleted([]);setData(defaultData);showMilestoneCompletePage();}};markMilestoneComplete(milestoneData,callback);}:function(){setStepCompleted(function(prevValue){return prevValue.concat([5]);});var hasErrors=['account_name','account_number','bsb_number'].reduce(function(prevValue,name){var error=validateBankDetails(name,data[name]);setErrors(function(prevErrors){return _objectSpread(_objectSpread({},prevErrors),{},_defineProperty({},name,error));});return prevValue||error;},'');var updatedBankDetails={account_name:data.account_name,account_number:data.account_number,bsb_number:data.bsb_number};if(!hasErrors){if(bankDetails.userId){updateBankDetails(_objectSpread({userId:data.userId},updatedBankDetails));}else{addBankDetails(updatedBankDetails);var mData={timeStamp:moengage.getCurrentTimeStamp()};moengage.moE_SendEvent(MoEConstants.ADDED_PAYMENT_DETAILS,mData);mixPanel.mixP_SendEvent(MoEConstants.ADDED_PAYMENT_DETAILS,mData);}}},children:readOnly?'Continue':'Save changes'})]})});case 6:return page=/*#__PURE__*/_jsx(DigitalIdVerification,{redirect_from:\"mark-milestone\",markMilestoneVerif:markMilestoneVerif,stripeAccountId:data.stripeAccountId});default:return null;}};return/*#__PURE__*/_jsx(\"div\",{className:\"detail_col\",children:renderSteps()});};export default MarkMilestone;","map":{"version":3,"sources":["/home/appinventiv/Documents/Project/tickt/web/src/pages/jobDashboard/components/markMilestone.tsx"],"names":["useEffect","useState","useHistory","setShowToast","UploadMedia","renderTime","LodgeDispute","CancelJobs","DigitalIdVerification","Modal","FsLightbox","storageService","Carousel","dummy","editIconBlue","more","check","pendingIcon","noDataFound","verifiedIcon","cancel","moengage","mixPanel","MoEConstants","digitalInfoPoints","declinedImages","desktop","breakpoint","max","min","items","slidesToSlide","tablet","mobile","MarkMilestone","props","getMilestoneList","milestoneList","showJobCompletePage","showMilestoneCompletePage","getBankDetails","addBankDetails","updateBankDetails","removeBankDetails","markMilestoneComplete","bankDetails","history","params","URLSearchParams","location","search","jobId","get","tradeId","specializationId","defaultData","urls","description","actualHours","totalAmount","account_name","account_number","bsb_number","accountVerified","stripeAccountId","data","setData","errors","setErrors","step","setStep","stepCompleted","setStepCompleted","isLastMilestone","setIsLastMilestone","milestoneIndex","setMilestoneIndex","readOnly","setReadOnly","edit","lodge","toggleItem","setToggleItem","isQuoteScreen","setQuoteScreen","multipleDeclineListCount","prevMilestoneDeclineId","currentMilestoneDeclineId","milestoneDeclineData","setMilestoneDeclineData","mediaList","setMediaList","toggler","setToggler","selectedSlide","setSelectSlide","digitalIDInfo","setDigitalIDInfo","jobActionType","prev","prevData","userId","validateActualHours","value","pattern","match","split","errorLabel","validateBankDetails","name","length","test","handleChange","target","newVal","trimLeft","tim","includes","prevErrors","jobName","milestones","postedBy","builderId","builderImage","builderName","reviews","ratings","hoursMinutes","map","key","parseInt","amount","pay_type","multipleList","filter","status","list","find","milestoneId","declinedReason","url","console","log","setItemToggle","index","renderFilteredItems","sources","types","forEach","item","mediaType","push","link","backTab","goBack","markMilestoneVerif","val","page","isMilestoneList","isShowError","renderSteps","sort","prevOrder","order","milestoneName","isPhotoevidence","fromDate","toDate","declinedCount","prevMilestoneStatus","isActive","undefined","isDeclined","Object","keys","reason","image","e","preventDefault","pathname","state","tradieId","getItem","_id","onerror","src","stepData","prevValue","concat","error","toFixed","info","milestoneData","evidence","callback","jobCompletedCount","mData","timeStamp","getCurrentTimeStamp","category","categories","trade_name","moE_SendEvent","MILESTONE_COMPLETED","mixP_SendEvent","hasErrors","reduce","updatedBankDetails","ADDED_PAYMENT_DETAILS"],"mappings":"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","sourcesContent":["import { useEffect, useState } from 'react';\nimport { useHistory } from 'react-router';\nimport { setShowToast } from '../../../redux/common/actions';\nimport UploadMedia from '../../postJob/components/uploadMedia';\nimport { renderTime } from '../../../utils/common';\nimport LodgeDispute from './lodgeDispute/lodgeDispute';\nimport CancelJobs from './cancelJobs/cancelJob'\nimport DigitalIdVerification from '../../tradieEditProfile/components/digitalIdVerification';\nimport Modal from '@material-ui/core/Modal';\n\n//@ts-ignore\nimport FsLightbox from 'fslightbox-react';\nimport storageService from '../../../utils/storageService';\nimport Carousel from 'react-multi-carousel';\nimport \"react-multi-carousel/lib/styles.css\";\n\nimport dummy from '../../../assets/images/u_placeholder.jpg';\nimport editIconBlue from '../../../assets/images/ic-edit-blue.png';\nimport more from '../../../assets/images/icon-direction-right.png';\nimport check from '../../../assets/images/checked-2.png';\nimport pendingIcon from '../../../assets/images/exclamation-icon.png'\nimport noDataFound from '../../../assets/images/no-search-data.png';\nimport verifiedIcon from '../../../assets/images/checked-2.png';\nimport cancel from \"../../../assets/images/ic-cancel.png\";\nimport { moengage, mixPanel } from '../../../services/analyticsTools';\nimport { MoEConstants } from '../../../utils/constants';\n\nconst digitalInfoPoints: Array<string> = [\n  'Passport',\n  'Driver Licence (Driver\\'s license) - scans of front and back are required',\n  'Photo Card - scans of front and back are required',\n  'New South Wales Driving Instructor Licence - scans of front and back are required',\n  'Tasmanian Government Personal Information Card - scans of front and back are required',\n  'ImmiCard - scans of front and back are required',\n  'Proof of Age card - scans of front and back are required',\n  'Australian Defence Force (ADF) identification card (Military ID) - scans of front and back are required'\n]\n\nconst declinedImages = {\n  desktop: {\n    breakpoint: { max: 3000, min: 1200 },\n    items: 2,\n    slidesToSlide: 1, // optional, default to 1.\n  },\n  tablet: {\n    breakpoint: { max: 1024, min: 768 },\n    items: 1\n  },\n  mobile: {\n    breakpoint: { max: 650, min: 0 },\n    items: 1\n  }\n};\n\ninterface BuilderDetails {\n  builderId: string;\n  builderImage: string;\n  builderName: string;\n  ratings: number;\n  reviews: number;\n}\n\ninterface JobDetails {\n  jobId: string;\n  jobName: string;\n  milestones: Array<any>;\n  postedBy: BuilderDetails;\n  categories: Array<any>\n}\n\ninterface BankDetails {\n  userId: string;\n  account_name: string;\n  account_number: string;\n  bsb_number: string;\n  accountVerified: boolean;\n  stripeAccountId: string;\n}\ninterface Proptypes {\n  getMilestoneList: (jobId: string) => void;\n  milestoneList: JobDetails;\n  showMilestoneCompletePage: () => void;\n  showJobCompletePage: (jobCompletedCount: number) => void;\n  addBankDetails: (data: any) => void;\n  updateBankDetails: (data: any) => void;\n  getBankDetails: () => void;\n  removeBankDetails: () => void;\n  markMilestoneComplete: (data: any, callback: (jobCompletedCount: number) => void) => void;\n  bankDetails: BankDetails;\n}\n\nconst MarkMilestone = (props: Proptypes) => {\n  const {\n    getMilestoneList,\n    milestoneList,\n    showJobCompletePage,\n    showMilestoneCompletePage,\n    getBankDetails,\n    addBankDetails,\n    updateBankDetails,\n    removeBankDetails,\n    markMilestoneComplete,\n    bankDetails,\n  } = props;\n  const history: any = useHistory();\n  let params: any = new URLSearchParams(history.location?.search);\n  params = {\n    jobId: params.get('jobId'),\n    tradeId: params.get('tradeId'),\n    specializationId: params.get('specializationId'),\n  };\n\n  const defaultData = {\n    urls: [],\n    description: '',\n    actualHours: '',\n    totalAmount: '0',\n    account_name: '',\n    account_number: '',\n    bsb_number: '',\n    accountVerified: false,\n    stripeAccountId: '',\n  };\n  const [data, setData] = useState<any>(defaultData);\n  const [errors, setErrors] = useState({\n    actualHours: '',\n    account_name: '',\n    account_number: '',\n    bsb_number: '',\n  });\n  const [step, setStep] = useState(1);\n  const [stepCompleted, setStepCompleted] = useState<Array<number>>([]);\n  const [isLastMilestone, setIsLastMilestone] = useState(false);\n  const [milestoneIndex, setMilestoneIndex] = useState(0);\n  const [readOnly, setReadOnly] = useState(false);\n  const [toggleItem, setToggleItem] = useState<{ [index: string]: boolean }>({ edit: false, cancel: false, lodge: false });\n  const [isQuoteScreen, setQuoteScreen] = useState(false);\n  const [milestoneDeclineData, setMilestoneDeclineData] = useState<any>({\n    multipleDeclineListCount: 0,\n    prevMilestoneDeclineId: '',\n    currentMilestoneDeclineId: '',\n  });\n  const [mediaList, setMediaList] = useState([]);\n  const [toggler, setToggler] = useState(false);\n  const [selectedSlide, setSelectSlide] = useState(1);\n  const [digitalIDInfo, setDigitalIDInfo] = useState<boolean>(false);\n\n  useEffect(() => {\n    const params = new URLSearchParams(history.location?.search);\n    const jobActionType: any = params.get('jobAction');\n    if (jobActionType === 'dispute') {\n      setToggleItem((prev: any) => ({ ...prev, lodge: true }));\n    } else if (jobActionType === 'cancel') {\n      setToggleItem((prev: any) => ({ ...prev, cancel: true }));\n    }\n  }, []);\n\n  useEffect(() => {\n    getMilestoneList(params.jobId);\n    getBankDetails();\n  }, [params.jobId, getMilestoneList, getBankDetails]);\n\n  useEffect(() => {\n    setData((prevData: any) => ({\n      ...prevData,\n      ...bankDetails,\n    }));\n\n    setReadOnly(!!bankDetails?.userId);\n  }, [bankDetails]);\n\n  const validateActualHours = (value: any) => {\n    if (!value) {\n      return 'Time Spent is required.';\n    }\n\n    let pattern = \"^([0-9]?[0-9]?[0-9]?[0-9]?[0-9]):[0-5][0-9]$\";\n    if (value.match(pattern) !== null) {\n      if (!((+value.split(':')[1]) % 5 === 0)) {\n        return 'Time should be in mutiples of 5 like 10:05, 10:10';\n      }\n      return '';\n    }\n    return 'Please enter a valid pattern like : 10:05';\n    // '([0-9]?[0-9]{1}|2[0-9]{1}|3[0-9]{1}|4[0-9]{1}|5[0-9]{1}|6[0-9]{1}):[0-5]{1}[0-9]{1}';\n    // return 'Hours should be in hh:mm format.';\n  };\n\n  const errorLabel = {\n    'account_number': 'Account Number',\n    'account_name': 'Account Name',\n    'bsb_number': 'BSB Number',\n  } as { [key: string]: string };\n\n  const validateBankDetails = (name: string, value: string) => {\n    if (!value) {\n      return `${errorLabel[name]} is required`;\n    }\n\n    switch (name) {\n      case 'account_number':\n        return value.length > 10 ? 'Maximum 10 digits are allowed' : value.length < 6 ? 'Minimum 6 digits are required' : '';\n      case 'bsb_number':\n        return !/^\\d{3}-\\d{3}$/.test(value) ? 'Please enter valid BSB Number like 123-444' : '';\n    }\n\n    return '';\n  };\n\n  const handleChange = ({ target: { name, value } }: any) => {\n    let newVal: '';\n    value = value.trimLeft();\n    if (name === 'actualHours') {\n      let tim = value?.split(':')[0];\n      if (value.includes(':') && tim?.length < 3) {\n        if (tim?.length === 2) {\n          newVal = value;\n        } else {\n          newVal = (value.split(':')[0] < 10 && value.split(':')[0] > 0) ? `0${value}` : value;\n        }\n      } else {\n        newVal = value;\n      }\n    }\n    setData((prevData: any) => ({\n      ...prevData,\n      [name]: name === 'actualHours' ? newVal : value,\n    }));\n\n    if (step === 3 && stepCompleted.includes(3)) {\n      setErrors((prevErrors) => ({\n        ...prevErrors,\n        [name]: validateActualHours(value),\n      }));\n    }\n\n    if (step === 5 && stepCompleted.includes(5)) {\n      setErrors((prevErrors) => ({\n        ...prevErrors,\n        [name]: validateBankDetails(name, value),\n      }));\n    }\n  };\n\n\n  const { jobId, jobName, milestones, postedBy } = milestoneList || {};\n  const { builderId, builderImage, builderName, reviews, ratings } = postedBy || {};\n\n  const hoursMinutes = data.actualHours?.split(':').map((key: string) => parseInt(key));\n  const totalAmount = milestones?.[milestoneIndex].amount * (milestones?.[milestoneIndex].pay_type === 'Fixed price' ? 1 : hoursMinutes?.[0] + (hoursMinutes?.[1] / 60));\n\n  useEffect(() => {\n    const multipleList: any = milestones?.filter(({ status }: { status: number }) => status === 3);\n    if (multipleList?.length > 1) {\n      const list: any = milestones?.find(({ status }: { status: number }) => status === 3);\n      setMilestoneDeclineData((prevData: any) => ({ ...prevData, multipleDeclineListCount: multipleList?.length, prevMilestoneDeclineId: list?.milestoneId, currentMilestoneDeclineId: list?.milestoneId }));\n      setMediaList(list?.declinedReason?.url);\n    } else if (multipleList?.length === 1) {\n      const list: any = milestones?.find(({ status }: { status: number }) => status === 3);\n      setMilestoneDeclineData((prevData: any) => ({ ...prevData, multipleDeclineListCount: multipleList?.length, prevMilestoneDeclineId: list?.milestoneId, currentMilestoneDeclineId: list?.milestoneId }));\n      setMediaList(list?.declinedReason?.url);\n    }\n  }, [milestones]);\n  console.log(milestoneDeclineData, \"milestoneDeclineData\");\n\n  const setItemToggle = (index: any) => {\n    setToggler((prev: boolean) => !prev);\n    setSelectSlide(index + 1);\n  }\n\n  const renderFilteredItems = () => {\n    let sources: any = [];\n    let types: any = [];\n\n    if (mediaList?.length) {\n      mediaList.forEach((item: any) => {\n        if (item?.mediaType === 2) {\n          sources.push(item.link);\n          types.push('video');\n        } else if (item?.mediaType === 1) {\n          sources.push(item.link);\n          types.push('image');\n        } else {\n          sources.push(item);\n          types.push('image');\n        }\n      })\n    }\n\n    return { sources, types };\n  }\n\n  const backTab = (name: string) => {\n    const params = new URLSearchParams(history.location?.search);\n    const jobActionType: any = params.get('jobAction');\n    if (jobActionType) {\n      history.goBack();\n      return;\n    }\n    setToggleItem((prev: any) => ({ ...prev, [name]: false }))\n  }\n\n  if (toggleItem?.lodge) {\n    return (\n      <LodgeDispute\n        item={{ jobId: jobId, jobName: jobName }}\n        backTab={backTab}\n        history={history}\n      />\n    )\n  }\n\n  if (toggleItem?.cancel) {\n    return (\n      <CancelJobs\n        item={{ jobId: jobId, jobName: jobName }}\n        backTab={backTab}\n        history={history}\n      />\n    )\n  }\n\n  const markMilestoneVerif = (val: any) => {\n    if (val === 'backStep') setStep(5)\n    if (val === 'verifSuccess') {\n      setData((prevData: any) => ({\n        ...prevData,\n        accountVerified: true,\n      }));\n      setStep(5);\n    }\n  }\n\n  const { sources, types } = renderFilteredItems();\n  let page = null;\n  let isMilestoneList: any = props?.milestoneList || false;\n  let isShowError = false;\n  if (isMilestoneList && isMilestoneList[0] && isMilestoneList[0]?.status === 404) {\n    isShowError = true;\n  }\n  const renderSteps = () => {\n    switch (step) {\n      case 1:\n        return page = (\n          !isShowError ? (\n            <div className=\"flex_row\">\n              <div className=\"flex_col_sm_6\">\n                <div className=\"relate\">\n                  <button\n                    className=\"back\"\n                    onClick={() => history.push('/active-jobs')}\n                  >\n                  </button>\n\n                  <span className=\"xs_sub_title\">{jobName}</span>\n                  <span className=\"dot_menu\">\n                    <img src={editIconBlue} alt=\"edit\" />\n                    <div className=\"edit_menu\">\n                      <ul>\n                        <li\n                          onClick={() => { setToggleItem((prev: any) => ({ ...prev, lodge: true })) }}\n                          className=\"icon lodge\">Lodge dispute</li>\n                        <li\n                          onClick={() => { setToggleItem((prev: any) => ({ ...prev, cancel: true })) }}\n                          className=\"icon delete\">Cancel job</li>\n                      </ul>\n                    </div>\n                  </span>\n                </div>\n\n                <p className=\"commn_para\">\n                  Your job point of contact has indicated they want to be notified\n                  when you reach the following milestones. Tap the milestone and\n                  Submit when a milestone is completed\n                </p>\n                {milestoneDeclineData.multipleDeclineListCount > 1 && <button className=\"fill_grey_btn full_btn pending_info\">\n                  <span><img src={pendingIcon} alt=\"icon\" />{`${milestoneDeclineData.multipleDeclineListCount} Milestones were declined`}</span>\n                </button>}\n\n                <ul className=\"milestones_check\">\n                  {milestones?.sort(({ order: prevOrder }, { order }) => prevOrder - order)?.map(\n                    (\n                      {\n                        milestoneId,\n                        milestoneName,\n                        isPhotoevidence,\n                        status,\n                        fromDate,\n                        toDate,\n                        declinedReason,\n                        declinedCount,\n                      },\n                      index\n                    ) => {\n                      // As discussed now we take this status 4 as status 0 bacause after the decline on the change-request the status becomes 4.\n                      const prevMilestoneStatus = milestones[index - 1]?.status;\n                      const isActive =\n                        (status === 0 || status === 4 || status === 5) && // here changes done for status 4 \n                        // completed or approved\n                        ([1, 2].includes(prevMilestoneStatus) ||\n                          prevMilestoneStatus === undefined);\n                      const isDeclined = status === 3;\n\n                      return (\n                        <li\n                          key={milestoneId}\n                          className={\n                            [1, 2,].includes(status)\n                              ? `check`\n                              : isActive\n                                ? 'active'\n                                : status === 3\n                                  ? 'declined'\n                                  : 'disabled'\n                          }\n                        >\n                          <div className=\"circle_stepper\" onClick={() => {\n                            setMediaList(declinedReason?.url);\n                            setMilestoneDeclineData((prevData: any) => ({ ...prevData, currentMilestoneDeclineId: milestoneId }))\n                          }}>\n                            <span></span>\n                          </div>\n                          <div className=\"info\">\n                            <label>{`${milestoneName} ${status === 3 ? 'declined' : ''}`}</label>\n                            {isPhotoevidence && (\n                              <span>Photo evidence required</span>\n                            )}\n                            <span>\n                              {renderTime(fromDate, toDate)}\n                            </span>\n                          </div>\n\n\n                          {isDeclined && milestoneDeclineData.currentMilestoneDeclineId === milestoneId && (\n                            <>\n                              {Object.keys(declinedReason)?.length > 0 && <div className=\"decline_reason\">\n                                <FsLightbox\n                                  toggler={toggler}\n                                  slide={selectedSlide}\n                                  sources={sources}\n                                  types={types}\n                                />\n                                <label className=\"form_label\">Decline reason:</label>\n                                <div className=\"text_field\">\n                                  <p className=\"commn_para\">{declinedReason?.reason}</p>\n                                </div>\n\n                                {declinedReason?.url?.length > 0 &&\n                                  <Carousel\n                                    className=\"decline_media\"\n                                    responsive={declinedImages}\n                                    showDots={false}\n                                    arrows={true}\n                                  >\n                                    {declinedReason?.url?.map((image: string, index: number) => {\n                                      return (\n                                        <div className=\"upload_img_video\">\n                                          <figure className=\"img_video\">\n                                            <img src={image} alt=\"image\" onClick={() => setItemToggle(index)} />\n                                          </figure>\n                                        </div>)\n                                    })}\n                                  </Carousel>\n                                }\n                              </div>}\n                              <button\n                                onClick={() => {\n                                  if (declinedCount >= 5) {\n                                    setShowToast(true, 'You have exceeded maximum number of chances to submit the milestone');\n                                    return;\n                                  }\n                                  setMilestoneIndex(index);\n\n                                  if (index === milestones?.length - 1) {\n                                    setIsLastMilestone(true);\n                                  }\n\n                                  if (isPhotoevidence) {\n                                    setStep(2);\n                                  } else {\n                                    setStep(3);\n                                  }\n                                }}\n                                className={`fill_btn full_btn btn-effect ${milestoneDeclineData.prevMilestoneDeclineId !== milestoneId ? 'disable_btn' : ''}`} >Remark as Complete</button>\n                            </>\n                          )}\n                          {isActive && (\n                            <button\n                              className=\"fill_btn full_btn btn-effect\"\n                              onClick={() => {\n                                setMilestoneIndex(index);\n\n                                if (index === milestones?.length - 1) {\n                                  setIsLastMilestone(true);\n                                }\n\n                                if (isPhotoevidence) {\n                                  setStep(2);\n                                } else {\n                                  setStep(3);\n                                }\n                              }}\n                            >\n                              Done\n                            </button>\n                          )}\n\n                        </li>\n                      );\n                    }\n                  )}\n                </ul>\n\n              </div>\n              {/* )} */}\n              <div className=\"flex_col_sm_6 col_ruler\">\n                <span className=\"sub_title\">Posted by</span>\n                <div className=\"tradie_card posted_by \">\n                  <a href=\"javascript:void(0)\" className=\"chat circle\"\n                    onClick={(e) => {\n                      e.preventDefault();\n                      history.push({\n                        pathname: `/chat`,\n                        state: {\n                          tradieId: storageService.getItem('userInfo')?._id,\n                          builderId: builderId,\n                          jobId: jobId,\n                          jobName: jobName\n                        }\n                      })\n                    }\n                    } />\n                  <div className=\"user_wrap\" onClick={() => history.push(`/builder-info?builderId=${builderId}`)}>\n                    <figure className=\"u_img\">\n                      <img\n                        src={builderImage || dummy}\n                        alt=\"traide-img\"\n                        onError={(e: any) => {\n                          if (e?.target?.onerror) {\n                            e.target.onerror = null;\n                          }\n                          if (e?.target?.src) {\n                            e.target.src = dummy;\n                          }\n                        }}\n                      />\n                    </figure>\n                    <div className=\"details\">\n                      <span className=\"name\">{builderName}</span>\n                      {/* <span className=\"prof\">Project Manager</span> */}\n                      <span className=\"rating\">{ratings} | {reviews} reviews</span>\n                    </div>\n                  </div>\n                </div>\n                <div className=\"relate\">\n                  <span className=\"sub_title\">Job details</span>\n                  <span\n                    className=\"edit_icon\"\n                    title=\"More\"\n                    onClick={() =>\n                      history.push(\n                        `/job-details-page?jobId=${params.jobId}&redirect_from=jobs`\n                      )\n                    }\n                  >\n                    <img src={more} alt=\"more\" />\n                  </span>\n                </div>\n              </div>\n            </div>\n          ) : (\n            <div className=\"custom_container\">\n              <div className=\"vid_img_wrapper pt-20\">\n                <div className=\"flex_row\">\n                  <div className=\"flex_col_sm_8 relative\">\n                    <button className=\"back\" onClick={() => {\n                      history.goBack();\n                    }}></button>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"no_record  m-t-vh\">\n                <figure className=\"no_img\">\n                  <img src={noDataFound} alt=\"data not found\" />\n                </figure>\n                <span>{'This builder is no longer available.'}</span>\n                <span>{'Please contact admin.'}</span>\n              </div>\n            </div>\n          ));\n      case 2:\n        return page = (\n          <UploadMedia\n            jobName={jobName}\n            title=\"Photo required\"\n            para=\"Your job point of contact has indicated they want to be notified when you reach the following milestones. Tap the milestone and Submit when a milestone is completed\"\n            stepCompleted={stepCompleted.includes(2)}\n            data={data}\n            handleStepBack={() => setStep(1)}\n            handleStepForward={() => { }}\n            handleStepComplete={(stepData: any) => {\n              setData((prevData: any) => ({\n                ...prevData,\n                ...stepData,\n              }));\n\n              setStepCompleted((prevValue) => prevValue.concat([2]));\n              setStep(3);\n            }}\n            hasDescription\n          />\n        );\n      case 3:\n        return page = (\n          <div className=\"flex_row\">\n            <div className=\"flex_col_sm_8\">\n              <div className=\"relate\">\n                <button\n                  className=\"back\"\n                  onClick={() => {\n                    if (milestones[milestoneIndex]?.isPhotoevidence) {\n                      setStep(2);\n                    } else {\n                      setStep(1);\n                    }\n                  }}\n                ></button>\n                <span className=\"xs_sub_title\">{jobName}</span>\n              </div>\n              <span className=\"sub_title\">Worked hours in this milestone</span>\n\n              <p className=\"commn_para\">\n                The amount paid will be recalculated based on approval of the\n                actual hours by the Builder\n              </p>\n\n              <div className=\"form_field\">\n                <label className=\"form_label\">Time Spent</label>\n                <div className=\"text_field time_spent\">\n                  <input\n                    type=\"text\"\n                    placeholder=\"hh:mm\"\n                    name=\"actualHours\"\n                    value={data.actualHours}\n                    onChange={handleChange}\n                    maxLength={5}\n                  />\n                  <span className=\"detect_icon\">hours</span>\n                </div>\n                <span className=\"error_msg\">{errors.actualHours}</span>\n              </div>\n              <button\n                className=\"fill_btn full_btn btn-effect\"\n                onClick={() => {\n                  setStepCompleted((prevValue) => prevValue.concat([3]));\n\n                  const error = validateActualHours(data.actualHours);\n                  if (error) {\n                    setErrors((prevErrors) => ({\n                      ...prevErrors,\n                      actualHours: error,\n                    }));\n                  } else {\n                    setStep(4);\n                  }\n                }}\n              >\n                Submit\n              </button>\n            </div>\n          </div>\n        );\n      case 4:\n        return page = (\n          <div className=\"flex_row\">\n            <div className=\"flex_col_sm_7\">\n              <div className=\"relate\">\n                <button className=\"back\" onClick={() => setStep(3)}></button>\n                <span className=\"xs_sub_title\">{jobName}</span>\n              </div>\n              <span className=\"sub_title\">\n                {isLastMilestone ? 'Job Complete' : 'Add payment details'}\n              </span>\n              <p className=\"commn_para\">\n                {isLastMilestone\n                  ? 'Please enter your prefered payment method below so your point of contact can organise payment'\n                  : 'You need to add your bank account details for payment from the builder after approving this milestone'}\n              </p>\n              {isLastMilestone && (\n                <div className=\"f_spacebw total_payment\">\n                  <span>Total payment</span>\n                  <span>${totalAmount?.toFixed(2)}</span>\n                </div>\n              )}\n              <button className=\"fill_grey_btn bank_btn\">\n                {data.userId && <img src={check} alt=\"check\" />} Bank account\n              </button>\n\n            </div>\n            <div className=\"flex_col_sm_9\">\n              <div className=\"form_field\">\n                <span className=\"payment_note\">\n                  Tickt does not store your payment information.{' '}\n                </span>\n                <p className=\"commn_para\">\n                  {' '}\n                  Tickt does not handle payment for jobs, we only facilitate\n                  communication between tradespeople and builders. If you have problems\n                  receiving your payment, please contact your builder.\n                </p>\n              </div>\n              <button className=\"fill_btn full_btn btn-effect\" onClick={() => setStep(5)}>\n                {data.userId ? 'Continue' : 'Add Details'}\n              </button>\n            </div>\n          </div>\n        );\n      case 5:\n        return page = (\n          <div className=\"flex_row\">\n            <div className=\"flex_col_sm_8\">\n              <div className=\"relate\">\n                <button className=\"back\" onClick={() => setStep(4)}></button>\n                <span className=\"xs_sub_title\">{jobName}</span>\n                {data?.userId && readOnly && (\n                  <>\n                    <div className=\"edit_delete\">\n                      <span className=\"edit\" title=\"Edit\" onClick={() => setReadOnly(!readOnly)}></span>\n                      <span className=\"delete\" title=\"Remove\" onClick={() => removeBankDetails()}></span>\n                    </div>\n                  </>\n                )}\n              </div>\n              <span className=\"sub_title\">Payment Details</span>\n              <p className=\"commn_para\">Enter your bank account details</p>\n\n              <div className=\"form_field\">\n                <label className=\"form_label\">Account Name</label>\n                <div className=\"text_field\">\n                  <input\n                    type=\"text\"\n                    placeholder=\"Enter Account Name\"\n                    name=\"account_name\"\n                    value={data.account_name}\n                    onChange={handleChange}\n                    maxLength={50}\n                    readOnly={readOnly}\n                  />\n                </div>\n                <span className=\"error_msg\">{errors.account_name}</span>\n              </div>\n              <div className=\"form_field\">\n                <label className=\"form_label\">BSB Number</label>\n                <div className=\"text_field\">\n                  <input\n                    type=\"text\"\n                    placeholder=\"Enter BSB Number\"\n                    name=\"bsb_number\"\n                    value={data.bsb_number}\n                    onChange={handleChange}\n                    maxLength={7}\n                    readOnly={readOnly}\n                  />\n                </div>\n                <span className=\"error_msg\">{errors.bsb_number}</span>\n              </div>\n              <div className=\"form_field\">\n                <label className=\"form_label\">Account Number</label>\n                <div className=\"text_field\">\n                  <input\n                    type=\"number\"\n                    placeholder=\"Enter Account Number\"\n                    name=\"account_number\"\n                    value={data.account_number}\n                    onChange={handleChange}\n                    maxLength={10}\n                    max={9999999999}\n                    readOnly={readOnly}\n                  />\n                </div>\n                <span className=\"error_msg\">{errors.account_number}</span>\n              </div>\n              {data.account_name && data.account_number && data.bsb_number && data.stripeAccountId &&\n                <>\n                  <div className=\"form_field\">\n                    <button className=\"fill_grey_btn full_btn btn-effect id_verified\"\n                      onClick={() => {\n                        if (data?.accountVerified) return;\n                        setStep(6);\n                      }}\n                    >\n                      {data?.accountVerified && <img src={verifiedIcon} alt=\"verified\" />}\n                      {`${data?.accountVerified ? 'ID Verified' : 'Add ID Verification'}`}\n                    </button>\n                  </div>\n                  <span className=\"show_label id_info\" onClick={() => setDigitalIDInfo(true)}>ID verification is required as part of Stripe ID verification process.</span>\n                </>\n              }\n\n              <Modal\n                className=\"custom_modal\"\n                open={digitalIDInfo}\n                onClose={() => setDigitalIDInfo(false)}\n                aria-labelledby=\"simple-modal-title\"\n                aria-describedby=\"simple-modal-description\"\n              >\n                <div className=\"custom_wh profile_modal\" data-aos=\"zoom-in\" data-aos-delay=\"30\" data-aos-duration=\"1000\">\n                  <div className=\"heading\">\n                    <span className=\"sub_title\">ID verification</span>\n                    <button className=\"close_btn\" onClick={() => setDigitalIDInfo(false)}>\n                      <img src={cancel} alt=\"cancel\" />\n                    </button>\n                  </div>\n                  <div className=\"inner_wrap\">\n                    <span className=\"show_label\">ID verification is required as part of Stripe ID verification process.</span>\n                    <span className=\"show_label\">Below is a spansting of documents that can accept as proof of identity, address, and entity.</span>\n                    <ul className=\"verificationid_list\">\n                      {digitalInfoPoints.map((info, index) => <li className=\"show_label\" key={index}>{info}</li>)}\n                    </ul>\n                    <div className=\"bottom_btn custom_btn center\">\n                      <button\n                        className={`fill_btn full_btn btn-effect`}\n                        onClick={() => setDigitalIDInfo(false)}\n                      >Ok</button>\n                    </div>\n                  </div>\n                </div>\n              </Modal>\n\n              <button\n                className={`fill_btn full_btn btn-effect ${readOnly ? data?.accountVerified ? '' : 'disable_btn' : ''}`}\n                onClick={readOnly ? () => {\n                  const milestoneData = {\n                    evidence: milestones[milestoneIndex].isPhotoevidence ? data.urls : undefined,\n                    jobId: params.jobId,\n                    milestoneId: milestones[milestoneIndex].milestoneId,\n                    description: milestones[milestoneIndex].isPhotoevidence ? data.description : undefined,\n                    actualHours: data.actualHours,\n                    totalAmount: `${totalAmount?.toFixed(2)}`,\n                  };\n\n                  const callback = (jobCompletedCount: number) => {\n                    const mData = {\n                      timeStamp: moengage.getCurrentTimeStamp(),\n                      category: milestoneList?.categories?.[0]?.trade_name,\n                      'Milestone number': milestoneIndex + 1\n                    }\n                    moengage.moE_SendEvent(MoEConstants.MILESTONE_COMPLETED, mData);\n                    mixPanel.mixP_SendEvent(MoEConstants.MILESTONE_COMPLETED, mData);\n                    if (isLastMilestone) {\n                      showJobCompletePage(jobCompletedCount);\n                    } else {\n                      setStepCompleted([]);\n                      setData(defaultData);\n                      showMilestoneCompletePage();\n                    }\n                  };\n\n\n                  markMilestoneComplete(milestoneData, callback);\n                } : () => {\n                  setStepCompleted((prevValue) => prevValue.concat([5]));\n\n                  const hasErrors = [\n                    'account_name',\n                    'account_number',\n                    'bsb_number',\n                  ].reduce((prevValue, name) => {\n                    const error = validateBankDetails(name, data[name]);\n                    setErrors((prevErrors) => ({\n                      ...prevErrors,\n                      [name]: error,\n                    }));\n\n                    return prevValue || error;\n                  }, '');\n\n                  const updatedBankDetails = {\n                    account_name: data.account_name,\n                    account_number: data.account_number,\n                    bsb_number: data.bsb_number,\n                  };\n                  if (!hasErrors) {\n                    if (bankDetails.userId) {\n                      updateBankDetails(\n                        {\n                          userId: data.userId,\n                          ...updatedBankDetails,\n                        },\n                      );\n                    } else {\n                      addBankDetails(updatedBankDetails);\n                      const mData = {\n                        timeStamp: moengage.getCurrentTimeStamp(),\n                      }\n                      moengage.moE_SendEvent(MoEConstants.ADDED_PAYMENT_DETAILS, mData);\n                      mixPanel.mixP_SendEvent(MoEConstants.ADDED_PAYMENT_DETAILS, mData);\n                    }\n                  }\n                }}\n              >\n                {readOnly ? 'Continue' : 'Save changes'}\n              </button>\n            </div>\n          </div>\n        );\n      case 6:\n        return page = (\n          <DigitalIdVerification\n            redirect_from={\"mark-milestone\"}\n            markMilestoneVerif={markMilestoneVerif}\n            stripeAccountId={data.stripeAccountId}\n          />\n        )\n\n      default:\n        return null;\n    }\n  }\n\n  return (\n    <div className=\"detail_col\">\n      {renderSteps()}\n    </div>\n  )\n};\n\nexport default MarkMilestone;\n"]},"metadata":{},"sourceType":"module"}