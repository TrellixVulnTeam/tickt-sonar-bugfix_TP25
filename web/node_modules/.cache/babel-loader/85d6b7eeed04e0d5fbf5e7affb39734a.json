{"ast":null,"code":"import _objectSpread from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from'react';// @ts-ignore\nimport{DateRangePicker}from'react-date-range';import'react-date-range/dist/styles.css';// main style file\nimport'react-date-range/dist/theme/default.css';// theme css file\nimport moment from'moment';import{setShowToast}from'../../../redux/common/actions';import{useLocation}from\"react-router-dom\";import _ from'lodash';import Button from'@material-ui/core/Button';import Dialog from'@material-ui/core/Dialog';import DialogActions from'@material-ui/core/DialogActions';import DialogTitle from'@material-ui/core/DialogTitle';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var default_format='YYYY-MM-DD';var ChooseTiming=function ChooseTiming(_ref){var data=_ref.data,milestones=_ref.milestones,stepCompleted=_ref.stepCompleted,handleStepComplete=_ref.handleStepComplete,handleStepBack=_ref.handleStepBack;var location=useLocation();var jobId=null;if(location.search){var urlParams=new URLSearchParams(location.search);jobId=urlParams.get('jobId');}var setCurrentDateWithoutTime=function setCurrentDateWithoutTime(){var date=new Date();date.setHours(0,0,0,0);return date;};var _useState=useState({//startDate: '', //new Date(), // ''\nstartDate:setCurrentDateWithoutTime(),// ''\nendDate:setCurrentDateWithoutTime(),key:'selection'}),_useState2=_slicedToArray(_useState,2),range=_useState2[0],setRange=_useState2[1];var _useState3=useState(data.isSingleDayJob?2:1),_useState4=_slicedToArray(_useState3,2),singleDayRange=_useState4[0],setSingleDayRange=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),singleDayModal=_useState6[0],setSingleDayModal=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),formattedDates=_useState8[0],setFormattedDates=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),error=_useState10[0],setError=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),localChanges=_useState12[0],setLocalChanges=_useState12[1];useEffect(function(){if(stepCompleted){if(jobId){var startDt=moment(data.from_date,'YYYY-MM-DD').isSameOrAfter(moment().format('YYYY-MM-DD'))?moment(data.from_date).toDate():'';var endDt=moment(data.to_date,'YYYY-MM-DD').isSameOrAfter(moment().format('YYYY-MM-DD'))?moment(data.to_date).toDate():'';if(data.isJobRepublish){if(!startDt){startDt=new Date();}if(!endDt){endDt=new Date();}}setRange({startDate:startDt,endDate:endDt,key:'selection'});handleCheck({startDate:startDt,endDate:endDt});}else{setRange({startDate:data.from_date?moment(data.from_date).toDate():new Date(),endDate:data.to_date?moment(data.to_date).toDate():'',key:'selection'});}setLocalChanges(true);}},[data,stepCompleted]);useEffect(function(){if(singleDayRange===2){if(!data.isSingleDayJob){setSingleDayModal(true);}}else if(singleDayRange===1){handleCheck(range);}},[singleDayRange,range]);var handleChange=function handleChange(item){var mile=milestones;// console.log({ mile, item });\nif(mile===null||mile===void 0?void 0:mile.length){var start_selection=moment(item.selection.startDate).format('MM-DD-YYYY');var end_selection=moment(item.selection.endDate).isValid()?moment(item.selection.endDate).format('MM-DD-YYYY'):null;var item_find=false;mile.forEach(function(item_date){var start=item_date.from_date;var end=moment(item_date.to_date).isValid()?item_date.to_date:null;if(start&&end){if(moment(start_selection).isAfter(start)||moment(end_selection).isBefore(end)){item_find=true;}}if(start&&!end){if(moment(start_selection).isAfter(start)){item_find=true;// true;\n}}if(start_selection&&end_selection&&!end){if(moment(start).isSameOrAfter(start_selection)&&moment(start).isSameOrBefore(end_selection)){item_find=false;}else{item_find=true;}}});if(item_find&&!jobId){setShowToast(true,'Please check the milestone dates');return;}}setRange(item.selection);handleCheck(item.selection);console.log(_.isEqual(item.selection.startDate,item.selection.endDate),'val',_.isEqual(item.selection,range),singleDayRange);if(_.isEqual(item.selection.startDate,item.selection.endDate)&&singleDayRange===null||!_.isEqual(item.selection,range)){setSingleDayRange(1);return;}if(_.isEqual(item.selection.startDate,item.selection.endDate)&&_.isEqual(item.selection,range)&&singleDayRange===1){setSingleDayRange(2);return;}if(_.isEqual(item.selection.startDate,item.selection.endDate)&&_.isEqual(item.selection,range)&&singleDayRange===2)return;if(singleDayRange===1||singleDayRange===2)setSingleDayRange(null);};var handleCheck=function handleCheck(item){var from_date=moment(item.startDate).format(default_format);var to_date=moment(item.endDate).format(default_format);setFormattedDates({from_date:from_date,to_date:to_date});if(moment(from_date,default_format).isAfter(moment(to_date,default_format))){// isAfter\nsetError('finish date is greater then the start date.');}else{setError('');}};var handleContinue=function handleContinue(){handleStepComplete(_objectSpread(_objectSpread({},formattedDates),singleDayRange===2?{isSingleDayJob:true}:{isSingleDayJob:false}));};var checkDisable=function checkDisable(){if((range===null||range===void 0?void 0:range.startDate)&&(range===null||range===void 0?void 0:range.startDate)!=='Invalid date'){return false;}return true;};return/*#__PURE__*/_jsx(\"div\",{className:\"app_wrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"section_wrapper\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"custom_container\",children:[/*#__PURE__*/_jsxs(Dialog,{open:singleDayModal// onClose={handleClose}\n,\"aria-labelledby\":\"alert-dialog-title\",\"aria-describedby\":\"alert-dialog-description\",children:[/*#__PURE__*/_jsx(DialogTitle,{id:\"alert-dialog-title\",children:'Are you sure you want to create single day job?'}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:function onClick(){setSingleDayModal(false);},color:\"primary\",children:'Yes'}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){setSingleDayModal(false);setSingleDayRange(1);},color:\"primary\",autoFocus:true,children:'No'})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex_row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex_col_sm_5\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relate\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back\",onClick:handleStepBack}),/*#__PURE__*/_jsx(\"span\",{className:\"title\",children:\"Timing\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"commn_para\",children:'Choose the start and finish day of your job'})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex_row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex_col_sm_8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(DateRangePicker,{ranges:[range],onChange:handleChange,months:2,direction:\"horizontal\",moveRangeOnFirstSelection:false,rangeColors:[\"#fee600\",\"#b5b5b5\"],showDateDisplay:false,showSelectionPreview:true,showPreview:true,minDate:new Date(),maxDate:moment().add(2,'years').toDate(),fixedHeight:true})}),/*#__PURE__*/_jsx(\"span\",{className:\"error_msg mtb-15\",children:error}),/*#__PURE__*/_jsx(\"div\",{className:\"form_field\",children:/*#__PURE__*/_jsx(\"button\",{className:\"fill_btn full_btn btn-effect \".concat(checkDisable()?'disable_btn':''),onClick:handleContinue,children:'Continue'})})]})})]})})});};export default ChooseTiming;","map":{"version":3,"sources":["/home/appinventiv/Documents/Project/tickt/web/src/pages/postJob/components/chooseTiming.tsx"],"names":["useState","useEffect","DateRangePicker","moment","setShowToast","useLocation","_","Button","Dialog","DialogActions","DialogTitle","default_format","ChooseTiming","data","milestones","stepCompleted","handleStepComplete","handleStepBack","location","jobId","search","urlParams","URLSearchParams","get","setCurrentDateWithoutTime","date","Date","setHours","startDate","endDate","key","range","setRange","isSingleDayJob","singleDayRange","setSingleDayRange","singleDayModal","setSingleDayModal","formattedDates","setFormattedDates","error","setError","localChanges","setLocalChanges","startDt","from_date","isSameOrAfter","format","toDate","endDt","to_date","isJobRepublish","handleCheck","handleChange","item","mile","length","start_selection","selection","end_selection","isValid","item_find","forEach","item_date","start","end","isAfter","isBefore","isSameOrBefore","console","log","isEqual","handleContinue","checkDisable","add"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react';\n// @ts-ignore\nimport { DateRangePicker } from 'react-date-range';\nimport 'react-date-range/dist/styles.css'; // main style file\nimport 'react-date-range/dist/theme/default.css'; // theme css file\nimport moment from 'moment';\nimport { setShowToast } from '../../../redux/common/actions';\nimport { useLocation } from \"react-router-dom\";\nimport _ from 'lodash';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogTitle from '@material-ui/core/DialogTitle';\n\ninterface Proptypes {\n    data: any;\n    milestones: any,\n    stepCompleted: Boolean;\n    handleStepComplete: (data: any) => void;\n    handleStepBack: () => void;\n}\n\nconst default_format = 'YYYY-MM-DD';\nconst ChooseTiming = ({ data, milestones, stepCompleted, handleStepComplete, handleStepBack }: Proptypes) => {\n    let location = useLocation();\n    let jobId: any = null;\n\n    if (location.search) {\n        let urlParams = new URLSearchParams(location.search);\n        jobId = urlParams.get('jobId');\n    }\n\n    const setCurrentDateWithoutTime = () => {\n        const date = new Date();\n        date.setHours(0, 0, 0, 0);\n        return date;\n    }\n    const [range, setRange] = useState<{ [index: string]: any }>({\n        //startDate: '', //new Date(), // ''\n        startDate: setCurrentDateWithoutTime(), // ''\n        endDate: setCurrentDateWithoutTime(),\n        key: 'selection',\n    });\n    const [singleDayRange, setSingleDayRange] = useState<number | null>(data.isSingleDayJob ? 2 : 1);\n    const [singleDayModal, setSingleDayModal] = useState<boolean>(false);\n    const [formattedDates, setFormattedDates] = useState({});\n    const [error, setError] = useState('');\n    const [localChanges, setLocalChanges] = useState(false);\n\n\n    useEffect(() => {\n        if (stepCompleted) {\n            if (jobId) {\n                let startDt = moment(data.from_date, 'YYYY-MM-DD').isSameOrAfter(moment().format('YYYY-MM-DD')) ? moment(data.from_date).toDate() : '';\n                let endDt = moment(data.to_date, 'YYYY-MM-DD').isSameOrAfter(moment().format('YYYY-MM-DD')) ? moment(data.to_date).toDate() : '';\n                if (data.isJobRepublish) {\n                    if (!startDt) {\n                        startDt = new Date();\n                    }\n                    if (!endDt) {\n                        endDt = new Date();\n                    }\n                }\n                setRange({\n                    startDate: startDt,\n                    endDate: endDt,\n                    key: 'selection',\n                });\n                handleCheck({ startDate: startDt, endDate: endDt });\n            } else {\n                setRange({\n                    startDate: data.from_date ? moment(data.from_date).toDate() : new Date(),\n                    endDate: data.to_date ? moment(data.to_date).toDate() : '',\n                    key: 'selection',\n                });\n            }\n            setLocalChanges(true);\n        }\n    }, [data, stepCompleted])\n\n    useEffect(() => {\n        if (singleDayRange === 2) {\n            if (!data.isSingleDayJob) {\n                setSingleDayModal(true);\n            }\n        } else if ((singleDayRange === 1)) {\n            handleCheck(range);\n        }\n    }, [singleDayRange, range]);\n\n\n    const handleChange = (item: any) => {\n        let mile: any = milestones;\n        // console.log({ mile, item });\n        if (mile?.length) {\n            let start_selection: any = moment(item.selection.startDate).format('MM-DD-YYYY');\n            let end_selection: any = moment(item.selection.endDate).isValid() ? moment(item.selection.endDate).format('MM-DD-YYYY') : null;\n            let item_find: any = false;\n\n            mile.forEach((item_date: any) => {\n                let start: any = item_date.from_date;\n                let end: any = moment(item_date.to_date).isValid() ? item_date.to_date : null;\n\n                if (start && end) {\n                    if (moment(start_selection).isAfter(start) || moment(end_selection).isBefore(end)) {\n                        item_find = true\n                    }\n                }\n\n                if (start && !end) {\n                    if (moment(start_selection).isAfter(start)) {\n                        item_find = true; // true;\n                    }\n                }\n\n                if (start_selection && end_selection && !end) {\n                    if (moment(start).isSameOrAfter(start_selection) && moment(start).isSameOrBefore(end_selection)) {\n                        item_find = false;\n                    } else {\n                        item_find = true\n                    }\n                }\n\n            });\n\n            if (item_find && !jobId) {\n                setShowToast(true, 'Please check the milestone dates');\n                return;\n            }\n        }\n        setRange(item.selection);\n        handleCheck(item.selection);\n        console.log(_.isEqual(item.selection.startDate, item.selection.endDate), 'val', _.isEqual(item.selection, range), singleDayRange)\n        if ((_.isEqual(item.selection.startDate, item.selection.endDate) && singleDayRange === null) || !_.isEqual(item.selection, range)) {\n            setSingleDayRange(1)\n            return;\n        }\n        if (_.isEqual(item.selection.startDate, item.selection.endDate) && _.isEqual(item.selection, range) && singleDayRange === 1) {\n            setSingleDayRange(2)\n            return;\n        }\n        if (_.isEqual(item.selection.startDate, item.selection.endDate) && _.isEqual(item.selection, range) && singleDayRange === 2) return;\n        if (singleDayRange === 1 || singleDayRange === 2) setSingleDayRange(null);\n    };\n\n    const handleCheck = (item: any) => {\n        let from_date = moment(item.startDate).format(default_format);\n        let to_date = moment(item.endDate).format(default_format);\n        setFormattedDates({ from_date, to_date });\n        if (moment(from_date, default_format).isAfter(moment(to_date, default_format))) { // isAfter\n            setError('finish date is greater then the start date.');\n        } else {\n            setError('');\n        }\n    }\n\n    const handleContinue = () => {\n        handleStepComplete({\n            ...formattedDates,\n            ...((singleDayRange === 2) ? { isSingleDayJob: true } : { isSingleDayJob: false })\n        });\n    }\n\n    const checkDisable = () => {\n        if (range?.startDate && range?.startDate !== 'Invalid date') {\n            return false;\n        }\n        return true;\n    }\n\n    return (\n        <div className=\"app_wrapper\">\n            <div className=\"section_wrapper\">\n                <div className=\"custom_container\">\n                    <Dialog\n                        open={singleDayModal}\n                        // onClose={handleClose}\n                        aria-labelledby=\"alert-dialog-title\"\n                        aria-describedby=\"alert-dialog-description\"\n                    >\n                        <DialogTitle id=\"alert-dialog-title\">\n                            {'Are you sure you want to create single day job?'}\n                        </DialogTitle>\n                        <DialogActions>\n                            <Button\n                                onClick={() => { setSingleDayModal(false) }}\n                                color=\"primary\">\n                                {'Yes'}\n                            </Button>\n                            <Button\n                                onClick={() => {\n                                    setSingleDayModal(false);\n                                    setSingleDayRange(1);\n                                }}\n                                color=\"primary\" autoFocus>\n                                {'No'}\n                            </Button>\n                        </DialogActions>\n                    </Dialog>\n\n                    <div className=\"form_field\">\n                        <div className=\"flex_row\">\n                            <div className=\"flex_col_sm_5\">\n                                <div className=\"relate\">\n                                    <button className=\"back\" onClick={handleStepBack}></button>\n                                    <span className=\"title\">Timing</span>\n                                </div>\n                                <p className=\"commn_para\">\n                                    {'Choose the start and finish day of your job'}\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                    <div className=\"flex_row\">\n                        <div className=\"flex_col_sm_8\">\n                            <div className=\"form_field\">\n                                <DateRangePicker\n                                    ranges={[range]}\n                                    onChange={handleChange}\n                                    months={2}\n                                    direction=\"horizontal\"\n                                    moveRangeOnFirstSelection={false}\n                                    rangeColors={[\"#fee600\", \"#b5b5b5\"]}\n                                    showDateDisplay={false}\n                                    showSelectionPreview={true}\n                                    showPreview={true}\n                                    minDate={new Date()}\n                                    maxDate={moment().add(2, 'years').toDate()}\n                                    fixedHeight={true}\n                                />\n                            </div>\n                            <span className=\"error_msg mtb-15\">{error}</span>\n                            <div className=\"form_field\">\n                                <button\n                                    className={`fill_btn full_btn btn-effect ${checkDisable() ? 'disable_btn' : ''}`}\n                                    onClick={handleContinue}>\n                                    {'Continue'}\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n    )\n}\n\nexport default ChooseTiming\n"]},"metadata":{},"sourceType":"module"}