{"ast":null,"code":"import _objectSpread from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/appinventiv/Documents/Project/tickt/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import Banner from'./components/banner';import Constants from'../../../utils/constants';import Geocode from\"react-geocode\";import{withRouter}from'react-router';import{setShowToast}from'../../../redux/common/actions';import TradieHome from'../../shared/tradieHome';import JobTypes from'./components/jobTypes';import axios from'axios';import dummy from'../../../assets/images/u_placeholder.jpg';import*as moment from'moment';import'moment-timezone';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";Geocode.setApiKey(Constants.SocialAuth.GOOGLE_GEOCODE_KEY);var setKey=function setKey(){localStorage.setItem('toastLocation','true');};var getKey=function getKey(){return localStorage.getItem('toastLocation');};var responseElement={};var BuilderHome=function BuilderHome(props){var _home_data$popular_tr,_home_data$popular_tr2;var callTradeList=props.callTradeList,getRecentSearchList=props.getRecentSearchList,setHomeBuilder=props.setHomeBuilder,builderHome=props.builderHome,tradeListData=props.tradeListData,tradieHomeData=props.tradieHomeData,getClearJobs=props.getClearJobs;var _useState=useState(),_useState2=_slicedToArray(_useState,2),addressItem=_useState2[0],setAddressItem=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),position=_useState4[0],setPosition=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),stateData=_useState6[0],setStateData=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),force=_useState8[0],forceUpdate=_useState8[1];var fetchItems=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(latitude,longitude){var response,address;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return Geocode.fromLatLng(latitude.toString(),longitude.toString());case 3:response=_context.sent;if(response){address=response.results[0].formatted_address;setAddressItem(address);}_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log({err:_context.t0});case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function fetchItems(_x,_x2){return _ref.apply(this,arguments);};}();var checkPermission=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var _navigator,_navigator$permission;var showPosition,postionError,permission;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:showPosition=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(position){var _position$coords,latitude,longitude;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_position$coords=position.coords,latitude=_position$coords.latitude,longitude=_position$coords.longitude;// const jobType = { lat: latitude, long: longitude, jobType: '', tradie: true };\nlocalStorage.setItem('position',\"[\".concat(longitude,\",\").concat(latitude,\"]\"));setPosition({lat:latitude,long:longitude});// console.log({ jobType }, '--------------!!!');\nconsole.log('fetch In If condition');_context2.next=6;return fetchByLatLong({lat:latitude,long:longitude});case 6:_context2.next=8;return fetchItems(latitude.toString(),longitude.toString());case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function showPosition(_x3){return _ref3.apply(this,arguments);};}();postionError=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(error){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:// const jobType = { lat: '-37.8136', long: '144.9631', jobType: '', tradie: true };\nconsole.log('fetch In Else condition');_context3.next=3;return fetchByLatLong({lat:'-37.8136',long:'144.9631'});case 3:// setHomeBuilder(jobType);\nsetPosition({lat:'-37.8136',long:'144.9631'});localStorage.setItem('position','[-37.8136, 144.9631]');// await fetchItems('-37.8136', '144.9631');\ncase 5:case\"end\":return _context3.stop();}}},_callee3);}));return function postionError(_x4){return _ref4.apply(this,arguments);};}();_context4.next=4;return(_navigator=navigator)===null||_navigator===void 0?void 0:(_navigator$permission=_navigator.permissions)===null||_navigator$permission===void 0?void 0:_navigator$permission.query({name:'geolocation'});case 4:permission=_context4.sent;if((permission===null||permission===void 0?void 0:permission.state)==='denied'){if(getKey()!==\"true\"){setShowToast(true,'Please enable the location permission from the browser settings so that Tickt App can access your location');setKey();}}navigator.geolocation.getCurrentPosition(showPosition,postionError);case 7:case\"end\":return _context4.stop();}}},_callee4);}));return function checkPermission(){return _ref2.apply(this,arguments);};}();useEffect(function(){getRecentSearchList();callTradeList();checkPermission();getClearJobs();},[]);var fetchByLatLong=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(data){var url,item,response,_data;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:url=\"\".concat(process.env.REACT_APP_BASE_URL,\"/v1/home?lat=\").concat(data.lat,\"&long=\").concat(data.long);item=localStorage.getItem('jwtToken');_context5.prev=2;_context5.next=5;return axios({url:url,method:'get',headers:{Authorization:JSON.parse(item),timezone:moment.tz.guess()}});case 5:response=_context5.sent;if((response===null||response===void 0?void 0:response.status)===200){_data=response===null||response===void 0?void 0:response.data;responseElement=_data===null||_data===void 0?void 0:_data.result;}_context5.next=12;break;case 9:_context5.prev=9;_context5.t0=_context5[\"catch\"](2);console.log({err:_context5.t0});case 12:case\"end\":return _context5.stop();}}},_callee5,null,[[2,9]]);}));return function fetchByLatLong(_x5){return _ref5.apply(this,arguments);};}();var home_data=responseElement;return/*#__PURE__*/_jsxs(\"div\",{className:\"app_wrapper\",children:[/*#__PURE__*/_jsx(Banner,_objectSpread(_objectSpread({},props),{},{current_address:addressItem,position:position})),/*#__PURE__*/_jsx(JobTypes,_objectSpread({},props)),/*#__PURE__*/_jsx(TradieHome,{data:home_data===null||home_data===void 0?void 0:home_data.saved_tradespeople,title:\"Saved tradespeople\",length:3,redirectPath:\"/saved-tradespeople\",history:props===null||props===void 0?void 0:props.history}),(home_data===null||home_data===void 0?void 0:(_home_data$popular_tr=home_data.popular_tradespeople)===null||_home_data$popular_tr===void 0?void 0:_home_data$popular_tr.length)>0&&/*#__PURE__*/_jsx(\"div\",{className:\"section_wrapper bg_gray\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"custom_container\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"title\",children:'Popular tradespeople'}),/*#__PURE__*/_jsx(\"ul\",{className:\"popular_tradies\",children:home_data===null||home_data===void 0?void 0:(_home_data$popular_tr2=home_data.popular_tradespeople)===null||_home_data$popular_tr2===void 0?void 0:_home_data$popular_tr2.map(function(item,index){var _item$trade$,_item$trade$2;return/*#__PURE__*/_jsxs(\"li\",{\"data-aos\":\"flip-right\",\"data-aos-delay\":\"200\",onClick:function onClick(){// setShowToast(true,'Under development');\nif((props===null||props===void 0?void 0:props.history)&&(item===null||item===void 0?void 0:item._id)){var _props$history;props===null||props===void 0?void 0:(_props$history=props.history)===null||_props$history===void 0?void 0:_props$history.push(\"tradie-info?tradeId=\".concat(item===null||item===void 0?void 0:item._id,\"&hideInvite=\",false));}},\"data-aos-duration\":\"1000\",children:[/*#__PURE__*/_jsx(\"figure\",{className:\"tradies_img\",children:/*#__PURE__*/_jsx(\"img\",{src:item.user_image||dummy,alt:\"tradies-img\",onError:function onError(e){var e_=e;e_.target.src=dummy;}})}),/*#__PURE__*/_jsx(\"span\",{className:\"name\",children:item===null||item===void 0?void 0:item.firstName}),/*#__PURE__*/_jsx(\"span\",{className:\"post\",children:(item===null||item===void 0?void 0:item.trade)&&Array.isArray(item===null||item===void 0?void 0:item.trade)&&(item===null||item===void 0?void 0:item.trade[0])&&(item===null||item===void 0?void 0:(_item$trade$=item.trade[0])===null||_item$trade$===void 0?void 0:_item$trade$.trade_name)?item===null||item===void 0?void 0:(_item$trade$2=item.trade[0])===null||_item$trade$2===void 0?void 0:_item$trade$2.trade_name:''})]},\"\".concat(item.firstName,\"item\").concat(index));})}),/*#__PURE__*/_jsx(\"button\",{className:\"fill_grey_btn full_btn m-tb40 view_more\",onClick:function onClick(){var _props$history2;// setShowToast(true, 'Under development');\nif((props===null||props===void 0?void 0:props.history)&&(props===null||props===void 0?void 0:(_props$history2=props.history)===null||_props$history2===void 0?void 0:_props$history2.push)){props===null||props===void 0?void 0:props.history.push({pathname:'/popular-tradespeople',state:{data:home_data===null||home_data===void 0?void 0:home_data.popular_tradespeople,title:'Popular tradespeople',popular:true,history:null//props?.history\n}});}},children:'View all'})]})}),/*#__PURE__*/_jsx(TradieHome,{data:home_data===null||home_data===void 0?void 0:home_data.recomended_tradespeople,title:\"Recommended tradespeople\",redirectPath:'/recommended-tradespeople',length:9,history:props===null||props===void 0?void 0:props.history}),/*#__PURE__*/_jsx(TradieHome,{data:home_data===null||home_data===void 0?void 0:home_data.mostViewed_tradespeople,title:\"Most Viewed tradespeople\",redirectPath:'/most-viewed-tradespeople',length:9,history:props===null||props===void 0?void 0:props.history})]});};export default withRouter(BuilderHome);","map":{"version":3,"sources":["/home/appinventiv/Documents/Project/tickt/web/src/pages/home/builderHome/builderHome.tsx"],"names":["React","useState","useEffect","Banner","Constants","Geocode","withRouter","setShowToast","TradieHome","JobTypes","axios","dummy","moment","setApiKey","SocialAuth","GOOGLE_GEOCODE_KEY","setKey","localStorage","setItem","getKey","getItem","responseElement","BuilderHome","props","callTradeList","getRecentSearchList","setHomeBuilder","builderHome","tradeListData","tradieHomeData","getClearJobs","addressItem","setAddressItem","position","setPosition","stateData","setStateData","force","forceUpdate","fetchItems","latitude","longitude","fromLatLng","toString","response","address","results","formatted_address","console","log","err","checkPermission","showPosition","coords","lat","long","fetchByLatLong","postionError","error","navigator","permissions","query","name","permission","state","geolocation","getCurrentPosition","data","url","process","env","REACT_APP_BASE_URL","item","method","headers","Authorization","JSON","parse","timezone","tz","guess","status","result","home_data","saved_tradespeople","history","popular_tradespeople","length","map","index","_id","push","user_image","e","e_","target","src","firstName","trade","Array","isArray","trade_name","pathname","title","popular","recomended_tradespeople","mostViewed_tradespeople"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Banner from './components/banner';\nimport Constants from '../../../utils/constants';\nimport Geocode from \"react-geocode\";\nimport { withRouter } from 'react-router'\nimport { setShowToast } from '../../../redux/common/actions';\nimport TradieHome from '../../shared/tradieHome';\nimport JobTypes from './components/jobTypes';\nimport axios from 'axios';\nimport dummy from '../../../assets/images/u_placeholder.jpg';\nimport * as moment from 'moment';\nimport 'moment-timezone';\n\nGeocode.setApiKey(Constants.SocialAuth.GOOGLE_GEOCODE_KEY);\n\nconst setKey = () => {\n    localStorage.setItem('toastLocation', 'true');\n}\n\nconst getKey = () => {\n    return localStorage.getItem('toastLocation');\n}\nvar responseElement: any = {};\nconst BuilderHome = (props: any) => {\n    let { callTradeList, getRecentSearchList, setHomeBuilder, builderHome, tradeListData, tradieHomeData, getClearJobs } = props;\n    const [addressItem, setAddressItem] = useState();\n    const [position, setPosition] = useState<any>({});\n    const [stateData, setStateData] = useState({});\n\n    const [force, forceUpdate] = useState({});\n\n\n    const fetchItems = async (latitude: any, longitude: any) => {\n        // Get address from latitude & longitude.\n        try {\n            let response = await Geocode.fromLatLng(latitude.toString(), longitude.toString())\n            if (response) {\n                const address = response.results[0].formatted_address;\n                setAddressItem(address)\n            }\n        } catch (err) {\n            console.log({ err });\n        }\n    }\n\n    const checkPermission = async () => {\n        const showPosition = async (position: any) => {\n            let { latitude, longitude } = position.coords;\n            // const jobType = { lat: latitude, long: longitude, jobType: '', tradie: true };\n            localStorage.setItem('position', `[${longitude},${latitude}]`);\n            setPosition({ lat: latitude, long: longitude });\n            // console.log({ jobType }, '--------------!!!');\n            console.log('fetch In If condition')\n            await fetchByLatLong({ lat: latitude, long: longitude });\n\n            // Get address from latitude & longitude.\n            await fetchItems(latitude.toString(), longitude.toString());\n        }\n\n        const postionError = async (error: any) => {\n            // const jobType = { lat: '-37.8136', long: '144.9631', jobType: '', tradie: true };\n            console.log('fetch In Else condition')\n            await fetchByLatLong({ lat: '-37.8136', long: '144.9631' });\n            // setHomeBuilder(jobType);\n            setPosition({ lat: '-37.8136', long: '144.9631' });\n            localStorage.setItem('position', '[-37.8136, 144.9631]');\n            // await fetchItems('-37.8136', '144.9631');\n        }\n\n        let permission: any = await navigator?.permissions?.query({ name: 'geolocation' });\n        if (permission?.state === 'denied') {\n            if (getKey() !== \"true\") {\n                setShowToast(true, 'Please enable the location permission from the browser settings so that Tickt App can access your location');\n                setKey();\n            }\n        }\n        navigator.geolocation.getCurrentPosition(showPosition, postionError)\n    }\n\n    useEffect(() => {\n        getRecentSearchList();\n        callTradeList();\n        checkPermission();\n        getClearJobs();\n    }, []);\n    const fetchByLatLong = async (data: any) => {\n\n        let url: string = `${process.env.REACT_APP_BASE_URL}/v1/home?lat=${data.lat}&long=${data.long}`\n        let item: any = localStorage.getItem('jwtToken')\n        try {\n            let response = await axios({\n                url,\n                method: 'get',\n                headers: {\n                    Authorization: JSON.parse(item),\n                    timezone: moment.tz.guess(),\n                }\n            });\n\n            if (response?.status === 200) {\n                let data: any = response?.data;\n                responseElement = data?.result;\n            }\n        } catch (err) {\n            console.log({ err });\n        }\n    }\n\n    let home_data: any = responseElement;\n\n    return (\n        <div className=\"app_wrapper\" >\n\n            <Banner\n                {...props}\n                current_address={addressItem}\n                position={position}\n            />\n\n            <JobTypes\n                {...props}\n            />\n\n            <TradieHome\n                data={home_data?.saved_tradespeople}\n                title={\"Saved tradespeople\"}\n                length={3}\n                redirectPath={\"/saved-tradespeople\"}\n                history={props?.history}\n            />\n\n            {home_data?.popular_tradespeople?.length > 0 &&\n                <div className=\"section_wrapper bg_gray\">\n                    <div className=\"custom_container\">\n                        <span className=\"title\">\n                            {'Popular tradespeople'}\n                        </span>\n                        <ul className=\"popular_tradies\">\n                            {home_data?.popular_tradespeople?.map((item: any, index: number) => {\n                                return (\n                                    <li\n                                        key={`${item.firstName}item${index}`}\n                                        data-aos=\"flip-right\"\n                                        data-aos-delay=\"200\"\n                                        onClick={() => {\n                                            // setShowToast(true,'Under development');\n                                            if (props?.history && item?._id) {\n                                                props?.history?.push(`tradie-info?tradeId=${item?._id}&hideInvite=${false}`);\n                                            }\n                                        }}\n                                        data-aos-duration=\"1000\">\n                                        <figure className=\"tradies_img\">\n                                            <img\n                                                src={item.user_image || dummy}\n                                                alt=\"tradies-img\"\n                                                onError={(e: any) => {\n                                                    let e_: any = e;\n                                                    e_.target.src = dummy;\n                                                }}\n                                            />\n                                        </figure>\n                                        <span className=\"name\">{item?.firstName}</span>\n                                        <span className=\"post\">\n                                            {item?.trade && Array.isArray(item?.trade) && item?.trade[0] && item?.trade[0]?.trade_name ? item?.trade[0]?.trade_name : ''}\n                                        </span>\n                                    </li>)\n                            })}\n                        </ul>\n                        <button\n                            className=\"fill_grey_btn full_btn m-tb40 view_more\"\n                            onClick={() => {\n                                // setShowToast(true, 'Under development');\n                                if (props?.history && props?.history?.push) {\n                                    props?.history.push({\n                                        pathname: '/popular-tradespeople',\n                                        state: {\n                                            data: home_data?.popular_tradespeople,\n                                            title: 'Popular tradespeople',\n                                            popular: true,\n                                            history: null, //props?.history\n                                        }\n                                    })\n                                }\n                            }}>\n                            {'View all'}\n                        </button>\n                    </div>\n                </div>\n            }\n\n            <TradieHome\n                data={home_data?.recomended_tradespeople}\n                title={\"Recommended tradespeople\"}\n                redirectPath={'/recommended-tradespeople'}\n                length={9}\n                history={props?.history}\n            />\n\n            <TradieHome\n                data={home_data?.mostViewed_tradespeople}\n                title={\"Most Viewed tradespeople\"}\n                redirectPath={'/most-viewed-tradespeople'}\n                length={9}\n                history={props?.history}\n            />\n        </div>\n    )\n}\n\nexport default withRouter(BuilderHome);\n"]},"metadata":{},"sourceType":"module"}